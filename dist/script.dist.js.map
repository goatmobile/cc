{
  "version": 3,
  "sources": ["../../node_modules/canvas/lib/parse-font.js", "../../node_modules/canvas/browser.js", "../../node_modules/resemblejs/resemble.js", "../../node_modules/resemblejs/compareImages.js", "../../node_modules/performance-now/lib/src/performance-now.coffee", "../../node_modules/raf/index.js", "../../node_modules/rgbcolor/index.js", "../../node_modules/preact/src/util.js", "../../node_modules/preact/src/options.js", "../../node_modules/preact/src/create-element.js", "../../node_modules/preact/src/component.js", "../../node_modules/preact/src/create-context.js", "../../node_modules/preact/src/constants.js", "../../node_modules/preact/src/diff/children.js", "../../node_modules/preact/src/diff/props.js", "../../node_modules/preact/src/diff/index.js", "../../node_modules/preact/src/render.js", "../../node_modules/preact/src/clone-element.js", "../../node_modules/preact/src/diff/catch-error.js", "../../js/script.jsx", "../../node_modules/svg-pathdata/node_modules/tslib/tslib.es6.js", "../../node_modules/svg-pathdata/src/SVGPathDataEncoder.ts", "../../node_modules/svg-pathdata/src/mathUtils.ts", "../../node_modules/svg-pathdata/src/SVGPathDataTransformer.ts", "../../node_modules/svg-pathdata/src/TransformableSVG.ts", "../../node_modules/svg-pathdata/src/SVGPathDataParser.ts", "../../node_modules/svg-pathdata/src/SVGPathData.ts", "../../node_modules/stackblur-canvas/dist/stackblur-es.js", "../../node_modules/canvg/src/presets/offscreen.ts", "../../node_modules/canvg/src/presets/node.ts", "../../node_modules/canvg/src/util/string.ts", "../../node_modules/canvg/src/util/styles.ts", "../../node_modules/canvg/src/util/math.ts", "../../node_modules/canvg/src/Property.ts", "../../node_modules/canvg/src/ViewPort.ts", "../../node_modules/canvg/src/Point.ts", "../../node_modules/canvg/src/Mouse.ts", "../../node_modules/canvg/src/Screen.ts", "../../node_modules/canvg/src/Parser.ts", "../../node_modules/canvg/src/Transform/Translate.ts", "../../node_modules/canvg/src/Transform/Rotate.ts", "../../node_modules/canvg/src/Transform/Scale.ts", "../../node_modules/canvg/src/Transform/Matrix.ts", "../../node_modules/canvg/src/Transform/Skew.ts", "../../node_modules/canvg/src/Transform/SkewX.ts", "../../node_modules/canvg/src/Transform/SkewY.ts", "../../node_modules/canvg/src/Transform/Transform.ts", "../../node_modules/canvg/src/Document/Element.ts", "../../node_modules/canvg/src/Document/UnknownElement.ts", "../../node_modules/canvg/src/Font.ts", "../../node_modules/canvg/src/BoundingBox.ts", "../../node_modules/canvg/src/Document/RenderedElement.ts", "../../node_modules/canvg/src/Document/TextElement.ts", "../../node_modules/canvg/src/Document/TSpanElement.ts", "../../node_modules/canvg/src/Document/TextNode.ts", "../../node_modules/canvg/src/PathParser.ts", "../../node_modules/canvg/src/Document/PathElement.ts", "../../node_modules/canvg/src/Document/SVGElement.ts", "../../node_modules/canvg/src/Document/RectElement.ts", "../../node_modules/canvg/src/Document/CircleElement.ts", "../../node_modules/canvg/src/Document/EllipseElement.ts", "../../node_modules/canvg/src/Document/LineElement.ts", "../../node_modules/canvg/src/Document/PolylineElement.ts", "../../node_modules/canvg/src/Document/PolygonElement.ts", "../../node_modules/canvg/src/Document/PatternElement.ts", "../../node_modules/canvg/src/Document/MarkerElement.ts", "../../node_modules/canvg/src/Document/DefsElement.ts", "../../node_modules/canvg/src/Document/GElement.ts", "../../node_modules/canvg/src/Document/GradientElement.ts", "../../node_modules/canvg/src/Document/LinearGradientElement.ts", "../../node_modules/canvg/src/Document/RadialGradientElement.ts", "../../node_modules/canvg/src/Document/StopElement.ts", "../../node_modules/canvg/src/Document/AnimateElement.ts", "../../node_modules/canvg/src/Document/AnimateColorElement.ts", "../../node_modules/canvg/src/Document/AnimateTransformElement.ts", "../../node_modules/canvg/src/Document/FontFaceElement.ts", "../../node_modules/canvg/src/Document/GlyphElement.ts", "../../node_modules/canvg/src/Document/MissingGlyphElement.ts", "../../node_modules/canvg/src/Document/FontElement.ts", "../../node_modules/canvg/src/Document/TRefElement.ts", "../../node_modules/canvg/src/Document/AElement.ts", "../../node_modules/canvg/src/Document/TextPathElement.ts", "../../node_modules/canvg/src/Document/ImageElement.ts", "../../node_modules/canvg/src/Document/SymbolElement.ts", "../../node_modules/canvg/src/SVGFontLoader.ts", "../../node_modules/canvg/src/Document/StyleElement.ts", "../../node_modules/canvg/src/Document/UseElement.ts", "../../node_modules/canvg/src/Document/FeColorMatrixElement.ts", "../../node_modules/canvg/src/Document/MaskElement.ts", "../../node_modules/canvg/src/Document/ClipPathElement.ts", "../../node_modules/canvg/src/Document/FilterElement.ts", "../../node_modules/canvg/src/Document/FeDropShadowElement.ts", "../../node_modules/canvg/src/Document/FeMorphologyElement.ts", "../../node_modules/canvg/src/Document/FeCompositeElement.ts", "../../node_modules/canvg/src/Document/FeGaussianBlurElement.ts", "../../node_modules/canvg/src/Document/TitleElement.ts", "../../node_modules/canvg/src/Document/DescElement.ts", "../../node_modules/canvg/src/Document/elements.ts", "../../node_modules/canvg/src/Document/Document.ts", "../../node_modules/canvg/src/Canvg.ts"],
  "sourcesContent": ["'use strict'\n\n/**\n * Font RegExp helpers.\n */\n\nconst weights = 'bold|bolder|lighter|[1-9]00'\nconst styles = 'italic|oblique'\nconst variants = 'small-caps'\nconst stretches = 'ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded'\nconst units = 'px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q'\nconst string = '\\'([^\\']+)\\'|\"([^\"]+)\"|[\\\\w\\\\s-]+'\n\n// [ [ <\u2018font-style\u2019> || <font-variant-css21> || <\u2018font-weight\u2019> || <\u2018font-stretch\u2019> ]?\n//    <\u2018font-size\u2019> [ / <\u2018line-height\u2019> ]? <\u2018font-family\u2019> ]\n// https://drafts.csswg.org/css-fonts-3/#font-prop\nconst weightRe = new RegExp(`(${weights}) +`, 'i')\nconst styleRe = new RegExp(`(${styles}) +`, 'i')\nconst variantRe = new RegExp(`(${variants}) +`, 'i')\nconst stretchRe = new RegExp(`(${stretches}) +`, 'i')\nconst sizeFamilyRe = new RegExp(\n  `([\\\\d\\\\.]+)(${units}) *((?:${string})( *, *(?:${string}))*)`)\n\n/**\n * Cache font parsing.\n */\n\nconst cache = {}\n\nconst defaultHeight = 16 // pt, common browser default\n\n/**\n * Parse font `str`.\n *\n * @param {String} str\n * @return {Object} Parsed font. `size` is in device units. `unit` is the unit\n *   appearing in the input string.\n * @api private\n */\n\nmodule.exports = str => {\n  // Cached\n  if (cache[str]) return cache[str]\n\n  // Try for required properties first.\n  const sizeFamily = sizeFamilyRe.exec(str)\n  if (!sizeFamily) return // invalid\n\n  // Default values and required properties\n  const font = {\n    weight: 'normal',\n    style: 'normal',\n    stretch: 'normal',\n    variant: 'normal',\n    size: parseFloat(sizeFamily[1]),\n    unit: sizeFamily[2],\n    family: sizeFamily[3].replace(/[\"']/g, '').replace(/ *, */g, ',')\n  }\n\n  // Optional, unordered properties.\n  let weight, style, variant, stretch\n  // Stop search at `sizeFamily.index`\n  const substr = str.substring(0, sizeFamily.index)\n  if ((weight = weightRe.exec(substr))) font.weight = weight[1]\n  if ((style = styleRe.exec(substr))) font.style = style[1]\n  if ((variant = variantRe.exec(substr))) font.variant = variant[1]\n  if ((stretch = stretchRe.exec(substr))) font.stretch = stretch[1]\n\n  // Convert to device units. (`font.unit` is the original unit)\n  // TODO: ch, ex\n  switch (font.unit) {\n    case 'pt':\n      font.size /= 0.75\n      break\n    case 'pc':\n      font.size *= 16\n      break\n    case 'in':\n      font.size *= 96\n      break\n    case 'cm':\n      font.size *= 96.0 / 2.54\n      break\n    case 'mm':\n      font.size *= 96.0 / 25.4\n      break\n    case '%':\n      // TODO disabled because existing unit tests assume 100\n      // font.size *= defaultHeight / 100 / 0.75\n      break\n    case 'em':\n    case 'rem':\n      font.size *= defaultHeight / 0.75\n      break\n    case 'q':\n      font.size *= 96 / 25.4 / 4\n      break\n  }\n\n  return (cache[str] = font)\n}\n", "/* globals document, ImageData */\n\nconst parseFont = require('./lib/parse-font')\n\nexports.parseFont = parseFont\n\nexports.createCanvas = function (width, height) {\n  return Object.assign(document.createElement('canvas'), { width: width, height: height })\n}\n\nexports.createImageData = function (array, width, height) {\n  // Browser implementation of ImageData looks at the number of arguments passed\n  switch (arguments.length) {\n    case 0: return new ImageData()\n    case 1: return new ImageData(array)\n    case 2: return new ImageData(array, width)\n    default: return new ImageData(array, width, height)\n  }\n}\n\nexports.loadImage = function (src, options) {\n  return new Promise(function (resolve, reject) {\n    const image = Object.assign(document.createElement('img'), options)\n\n    function cleanup () {\n      image.onload = null\n      image.onerror = null\n    }\n\n    image.onload = function () { cleanup(); resolve(image) }\n    image.onerror = function () { cleanup(); reject(new Error('Failed to load the image \"' + src + '\"')) }\n\n    image.src = src\n  })\n}\n", "/*\nJames Cryer / Huddle\nURL: https://github.com/Huddle/Resemble.js\n*/\n\nvar naiveFallback = function () {\n    // ISC (c) 2011-2019 https://github.com/medikoo/es5-ext/blob/master/global.js\n    if (typeof self === \"object\" && self) {\n        return self;\n    }\n    if (typeof window === \"object\" && window) {\n        return window;\n    }\n    throw new Error(\"Unable to resolve global `this`\");\n};\n\nvar getGlobalThis = function () {\n    // ISC (c) 2011-2019 https://github.com/medikoo/es5-ext/blob/master/global.js\n    // Fallback to standard globalThis if available\n    if (typeof globalThis === \"object\" && globalThis) {\n        return globalThis;\n    }\n\n    try {\n        Object.defineProperty(Object.prototype, \"__global__\", {\n            get: function () {\n                return this;\n            },\n            configurable: true\n        });\n    } catch (error) {\n        return naiveFallback();\n    }\n    try {\n        // eslint-disable-next-line no-undef\n        if (!__global__) {\n            return naiveFallback();\n        }\n        return __global__; // eslint-disable-line no-undef\n    } finally {\n        delete Object.prototype.__global__;\n    }\n};\n\nvar isNode = function () {\n    const globalPolyfill = getGlobalThis();\n    return typeof globalPolyfill.process !== \"undefined\" && globalPolyfill.process.versions && globalPolyfill.process.versions.node;\n};\n\n(function (root, factory) {\n    \"use strict\";\n    if (typeof define === \"function\" && define.amd) {\n        define([], factory);\n    } else if (typeof module === \"object\" && module.exports) {\n        module.exports = factory();\n    } else {\n        root.resemble = factory();\n    }\n})(this /* eslint-disable-line no-invalid-this*/, function () {\n    \"use strict\";\n\n    var Img;\n    var Canvas;\n    var loadNodeCanvasImage;\n\n    if (isNode()) {\n        Canvas = require(\"canvas\"); // eslint-disable-line global-require\n        Img = Canvas.Image;\n        loadNodeCanvasImage = Canvas.loadImage;\n    } else {\n        Img = Image;\n    }\n\n    function createCanvas(width, height) {\n        if (isNode()) {\n            return Canvas.createCanvas(width, height);\n        }\n\n        var cnvs = document.createElement(\"canvas\");\n        cnvs.width = width;\n        cnvs.height = height;\n        return cnvs;\n    }\n\n    var oldGlobalSettings = {};\n    var globalOutputSettings = oldGlobalSettings;\n\n    var resemble = function (fileData) {\n        var pixelTransparency = 1;\n\n        var errorPixelColor = {\n            // Color for Error Pixels. Between 0 and 255.\n            red: 255,\n            green: 0,\n            blue: 255,\n            alpha: 255\n        };\n\n        var targetPix = { r: 0, g: 0, b: 0, a: 0 }; // isAntialiased\n\n        var errorPixelTransform = {\n            flat: function (px, offset) {\n                px[offset] = errorPixelColor.red;\n                px[offset + 1] = errorPixelColor.green;\n                px[offset + 2] = errorPixelColor.blue;\n                px[offset + 3] = errorPixelColor.alpha;\n            },\n            movement: function (px, offset, d1, d2) {\n                px[offset] = (d2.r * (errorPixelColor.red / 255) + errorPixelColor.red) / 2;\n                px[offset + 1] = (d2.g * (errorPixelColor.green / 255) + errorPixelColor.green) / 2;\n                px[offset + 2] = (d2.b * (errorPixelColor.blue / 255) + errorPixelColor.blue) / 2;\n                px[offset + 3] = d2.a;\n            },\n            flatDifferenceIntensity: function (px, offset, d1, d2) {\n                px[offset] = errorPixelColor.red;\n                px[offset + 1] = errorPixelColor.green;\n                px[offset + 2] = errorPixelColor.blue;\n                px[offset + 3] = colorsDistance(d1, d2);\n            },\n            movementDifferenceIntensity: function (px, offset, d1, d2) {\n                var ratio = (colorsDistance(d1, d2) / 255) * 0.8;\n\n                px[offset] = (1 - ratio) * (d2.r * (errorPixelColor.red / 255)) + ratio * errorPixelColor.red;\n                px[offset + 1] = (1 - ratio) * (d2.g * (errorPixelColor.green / 255)) + ratio * errorPixelColor.green;\n                px[offset + 2] = (1 - ratio) * (d2.b * (errorPixelColor.blue / 255)) + ratio * errorPixelColor.blue;\n                px[offset + 3] = d2.a;\n            },\n            diffOnly: function (px, offset, d1, d2) {\n                px[offset] = d2.r;\n                px[offset + 1] = d2.g;\n                px[offset + 2] = d2.b;\n                px[offset + 3] = d2.a;\n            }\n        };\n\n        var errorPixel = errorPixelTransform.flat;\n        var errorType;\n        var boundingBoxes;\n        var ignoredBoxes;\n        var ignoreAreasColoredWith;\n        var largeImageThreshold = 1200;\n        var useCrossOrigin = true;\n        var data = {};\n        var images = [];\n        var updateCallbackArray = [];\n\n        var tolerance = {\n            // between 0 and 255\n            red: 16,\n            green: 16,\n            blue: 16,\n            alpha: 16,\n            minBrightness: 16,\n            maxBrightness: 240\n        };\n\n        var ignoreAntialiasing = false;\n        var ignoreColors = false;\n        var scaleToSameSize = false;\n        var compareOnly = false;\n        var returnEarlyThreshold;\n\n        function colorsDistance(c1, c2) {\n            return (Math.abs(c1.r - c2.r) + Math.abs(c1.g - c2.g) + Math.abs(c1.b - c2.b)) / 3;\n        }\n\n        function withinBoundingBox(x, y, width, height, box) {\n            return x > (box.left || 0) && x < (box.right || width) && y > (box.top || 0) && y < (box.bottom || height);\n        }\n\n        function withinComparedArea(x, y, width, height, pixel2) {\n            var isIncluded = true;\n            var i;\n            var boundingBox;\n            var ignoredBox;\n            var selected;\n            var ignored;\n\n            if (boundingBoxes instanceof Array) {\n                selected = false;\n                for (i = 0; i < boundingBoxes.length; i++) {\n                    boundingBox = boundingBoxes[i];\n                    if (withinBoundingBox(x, y, width, height, boundingBox)) {\n                        selected = true;\n                        break;\n                    }\n                }\n            }\n            if (ignoredBoxes instanceof Array) {\n                ignored = true;\n                for (i = 0; i < ignoredBoxes.length; i++) {\n                    ignoredBox = ignoredBoxes[i];\n                    if (withinBoundingBox(x, y, width, height, ignoredBox)) {\n                        ignored = false;\n                        break;\n                    }\n                }\n            }\n\n            if (ignoreAreasColoredWith) {\n                return colorsDistance(pixel2, ignoreAreasColoredWith) !== 0;\n            }\n\n            if (selected === undefined && ignored === undefined) {\n                return true;\n            }\n            if (selected === false && ignored === true) {\n                return false;\n            }\n            if (selected === true || ignored === true) {\n                isIncluded = true;\n            }\n            if (selected === false || ignored === false) {\n                isIncluded = false;\n            }\n            return isIncluded;\n        }\n\n        function triggerDataUpdate() {\n            var len = updateCallbackArray.length;\n            var i;\n            for (i = 0; i < len; i++) {\n                if (typeof updateCallbackArray[i] === \"function\") {\n                    updateCallbackArray[i](data);\n                }\n            }\n        }\n\n        function loop(w, h, callback) {\n            var x;\n            var y;\n\n            for (x = 0; x < w; x++) {\n                for (y = 0; y < h; y++) {\n                    callback(x, y);\n                }\n            }\n        }\n\n        function parseImage(sourceImageData, width, height) {\n            var pixelCount = 0;\n            var redTotal = 0;\n            var greenTotal = 0;\n            var blueTotal = 0;\n            var alphaTotal = 0;\n            var brightnessTotal = 0;\n            var whiteTotal = 0;\n            var blackTotal = 0;\n\n            loop(width, height, function (horizontalPos, verticalPos) {\n                var offset = (verticalPos * width + horizontalPos) * 4;\n                var red = sourceImageData[offset];\n                var green = sourceImageData[offset + 1];\n                var blue = sourceImageData[offset + 2];\n                var alpha = sourceImageData[offset + 3];\n                var brightness = getBrightness(red, green, blue);\n\n                if (red === green && red === blue && alpha) {\n                    if (red === 0) {\n                        blackTotal++;\n                    } else if (red === 255) {\n                        whiteTotal++;\n                    }\n                }\n\n                pixelCount++;\n\n                redTotal += (red / 255) * 100;\n                greenTotal += (green / 255) * 100;\n                blueTotal += (blue / 255) * 100;\n                alphaTotal += ((255 - alpha) / 255) * 100;\n                brightnessTotal += (brightness / 255) * 100;\n            });\n\n            data.red = Math.floor(redTotal / pixelCount);\n            data.green = Math.floor(greenTotal / pixelCount);\n            data.blue = Math.floor(blueTotal / pixelCount);\n            data.alpha = Math.floor(alphaTotal / pixelCount);\n            data.brightness = Math.floor(brightnessTotal / pixelCount);\n            data.white = Math.floor((whiteTotal / pixelCount) * 100);\n            data.black = Math.floor((blackTotal / pixelCount) * 100);\n\n            triggerDataUpdate();\n        }\n\n        function onLoadImage(hiddenImage, callback) {\n            // don't assign to hiddenImage, see https://github.com/Huddle/Resemble.js/pull/87/commits/300d43352a2845aad289b254bfbdc7cd6a37e2d7\n            var width = hiddenImage.width;\n            var height = hiddenImage.height;\n\n            if (scaleToSameSize && images.length === 1) {\n                width = images[0].width;\n                height = images[0].height;\n            }\n\n            var hiddenCanvas = createCanvas(width, height);\n            var imageData;\n\n            hiddenCanvas.getContext(\"2d\").drawImage(hiddenImage, 0, 0, width, height);\n            imageData = hiddenCanvas.getContext(\"2d\").getImageData(0, 0, width, height);\n\n            images.push(imageData);\n\n            callback(imageData, width, height);\n        }\n\n        function loadImageData(fileDataForImage, callback) {\n            var fileReader;\n            var hiddenImage = new Img();\n\n            if (!hiddenImage.setAttribute) {\n                hiddenImage.setAttribute = function setAttribute() {};\n            }\n\n            if (useCrossOrigin) {\n                hiddenImage.setAttribute(\"crossorigin\", \"anonymous\");\n            }\n\n            hiddenImage.onerror = function (event) {\n                hiddenImage.onload = null;\n                hiddenImage.onerror = null; // fixes pollution between calls\n                const error = event ? event + \"\" : \"Unknown error\";\n                images.push({ error: `Failed to load image '${fileDataForImage}'. ${error}` });\n                callback();\n            };\n\n            hiddenImage.onload = function () {\n                hiddenImage.onload = null; // fixes pollution between calls\n                hiddenImage.onerror = null;\n                onLoadImage(hiddenImage, callback);\n            };\n\n            if (typeof fileDataForImage === \"string\") {\n                hiddenImage.src = fileDataForImage;\n                if (!isNode() && hiddenImage.complete && hiddenImage.naturalWidth > 0) {\n                    hiddenImage.onload();\n                }\n            } else if (\n                typeof fileDataForImage.data !== \"undefined\" &&\n                typeof fileDataForImage.width === \"number\" &&\n                typeof fileDataForImage.height === \"number\"\n            ) {\n                images.push(fileDataForImage);\n\n                callback(fileDataForImage, fileDataForImage.width, fileDataForImage.height);\n            } else if (typeof Buffer !== \"undefined\" && fileDataForImage instanceof Buffer) {\n                // If we have Buffer, assume we're on Node+Canvas and its supported\n                // hiddenImage.src = fileDataForImage;\n\n                loadNodeCanvasImage(fileDataForImage)\n                    .then(function (image) {\n                        hiddenImage.onload = null; // fixes pollution between calls\n                        hiddenImage.onerror = null;\n                        onLoadImage(image, callback);\n                    })\n                    .catch(function (err) {\n                        images.push({\n                            error: err ? err + \"\" : \"Image load error.\"\n                        });\n                        callback();\n                    });\n            } else {\n                fileReader = new FileReader();\n                fileReader.onload = function (event) {\n                    hiddenImage.src = event.target.result;\n                };\n                fileReader.readAsDataURL(fileDataForImage);\n            }\n        }\n\n        function isColorSimilar(a, b, color) {\n            var absDiff = Math.abs(a - b);\n\n            if (typeof a === \"undefined\") {\n                return false;\n            }\n            if (typeof b === \"undefined\") {\n                return false;\n            }\n\n            if (a === b) {\n                return true;\n            } else if (absDiff < tolerance[color]) {\n                return true;\n            }\n            return false;\n        }\n\n        function isPixelBrightnessSimilar(d1, d2) {\n            var alpha = isColorSimilar(d1.a, d2.a, \"alpha\");\n            var brightness = isColorSimilar(d1.brightness, d2.brightness, \"minBrightness\");\n            return brightness && alpha;\n        }\n\n        function getBrightness(r, g, b) {\n            return 0.3 * r + 0.59 * g + 0.11 * b;\n        }\n\n        function isRGBSame(d1, d2) {\n            var red = d1.r === d2.r;\n            var green = d1.g === d2.g;\n            var blue = d1.b === d2.b;\n            return red && green && blue;\n        }\n\n        function isRGBSimilar(d1, d2) {\n            var red = isColorSimilar(d1.r, d2.r, \"red\");\n            var green = isColorSimilar(d1.g, d2.g, \"green\");\n            var blue = isColorSimilar(d1.b, d2.b, \"blue\");\n            var alpha = isColorSimilar(d1.a, d2.a, \"alpha\");\n\n            return red && green && blue && alpha;\n        }\n\n        function isContrasting(d1, d2) {\n            return Math.abs(d1.brightness - d2.brightness) > tolerance.maxBrightness;\n        }\n\n        function getHue(red, green, blue) {\n            var r = red / 255;\n            var g = green / 255;\n            var b = blue / 255;\n            var max = Math.max(r, g, b);\n            var min = Math.min(r, g, b);\n            var h;\n            var d;\n\n            if (max === min) {\n                h = 0; // achromatic\n            } else {\n                d = max - min;\n                switch (max) {\n                    case r:\n                        h = (g - b) / d + (g < b ? 6 : 0);\n                        break;\n                    case g:\n                        h = (b - r) / d + 2;\n                        break;\n                    case b:\n                        h = (r - g) / d + 4;\n                        break;\n                    default:\n                        h /= 6;\n                }\n            }\n\n            return h;\n        }\n\n        function isAntialiased(sourcePix, pix, cacheSet, verticalPos, horizontalPos, width) {\n            var offset;\n            var distance = 1;\n            var i;\n            var j;\n            var hasHighContrastSibling = 0;\n            var hasSiblingWithDifferentHue = 0;\n            var hasEquivalentSibling = 0;\n\n            addHueInfo(sourcePix);\n\n            for (i = distance * -1; i <= distance; i++) {\n                for (j = distance * -1; j <= distance; j++) {\n                    if (i === 0 && j === 0) {\n                        // ignore source pixel\n                    } else {\n                        offset = ((verticalPos + j) * width + (horizontalPos + i)) * 4;\n\n                        if (!getPixelInfo(targetPix, pix, offset, cacheSet)) {\n                            continue;\n                        }\n\n                        addBrightnessInfo(targetPix);\n                        addHueInfo(targetPix);\n\n                        if (isContrasting(sourcePix, targetPix)) {\n                            hasHighContrastSibling++;\n                        }\n\n                        if (isRGBSame(sourcePix, targetPix)) {\n                            hasEquivalentSibling++;\n                        }\n\n                        if (Math.abs(targetPix.h - sourcePix.h) > 0.3) {\n                            hasSiblingWithDifferentHue++;\n                        }\n\n                        if (hasSiblingWithDifferentHue > 1 || hasHighContrastSibling > 1) {\n                            return true;\n                        }\n                    }\n                }\n            }\n\n            if (hasEquivalentSibling < 2) {\n                return true;\n            }\n\n            return false;\n        }\n\n        function copyPixel(px, offset, pix) {\n            if (errorType === \"diffOnly\") {\n                return;\n            }\n\n            px[offset] = pix.r; // r\n            px[offset + 1] = pix.g; // g\n            px[offset + 2] = pix.b; // b\n            px[offset + 3] = pix.a * pixelTransparency; // a\n        }\n\n        function copyGrayScalePixel(px, offset, pix) {\n            if (errorType === \"diffOnly\") {\n                return;\n            }\n\n            px[offset] = pix.brightness; // r\n            px[offset + 1] = pix.brightness; // g\n            px[offset + 2] = pix.brightness; // b\n            px[offset + 3] = pix.a * pixelTransparency; // a\n        }\n\n        function getPixelInfo(dst, pix, offset) {\n            if (pix.length > offset) {\n                dst.r = pix[offset];\n                dst.g = pix[offset + 1];\n                dst.b = pix[offset + 2];\n                dst.a = pix[offset + 3];\n\n                return true;\n            }\n\n            return false;\n        }\n\n        function addBrightnessInfo(pix) {\n            pix.brightness = getBrightness(pix.r, pix.g, pix.b); // 'corrected' lightness\n        }\n\n        function addHueInfo(pix) {\n            pix.h = getHue(pix.r, pix.g, pix.b);\n        }\n\n        function analyseImages(img1, img2, width, height) {\n            var data1 = img1.data;\n            var data2 = img2.data;\n            var hiddenCanvas;\n            var context;\n            var imgd;\n            var pix;\n\n            if (!compareOnly) {\n                hiddenCanvas = createCanvas(width, height);\n\n                context = hiddenCanvas.getContext(\"2d\");\n                imgd = context.createImageData(width, height);\n                pix = imgd.data;\n            }\n\n            var mismatchCount = 0;\n            var diffBounds = {\n                top: height,\n                left: width,\n                bottom: 0,\n                right: 0\n            };\n            var updateBounds = function (x, y) {\n                diffBounds.left = Math.min(x, diffBounds.left);\n                diffBounds.right = Math.max(x, diffBounds.right);\n                diffBounds.top = Math.min(y, diffBounds.top);\n                diffBounds.bottom = Math.max(y, diffBounds.bottom);\n            };\n\n            var time = Date.now();\n\n            var skip;\n\n            if (!!largeImageThreshold && ignoreAntialiasing && (width > largeImageThreshold || height > largeImageThreshold)) {\n                skip = 6;\n            }\n\n            var pixel1 = { r: 0, g: 0, b: 0, a: 0 };\n            var pixel2 = { r: 0, g: 0, b: 0, a: 0 };\n\n            var skipTheRest = false;\n\n            loop(width, height, function (horizontalPos, verticalPos) {\n                if (skipTheRest) {\n                    return;\n                }\n\n                if (skip) {\n                    // only skip if the image isn't small\n                    if (verticalPos % skip === 0 || horizontalPos % skip === 0) {\n                        return;\n                    }\n                }\n\n                var offset = (verticalPos * width + horizontalPos) * 4;\n                if (!getPixelInfo(pixel1, data1, offset, 1) || !getPixelInfo(pixel2, data2, offset, 2)) {\n                    return;\n                }\n\n                var isWithinComparedArea = withinComparedArea(horizontalPos, verticalPos, width, height, pixel2);\n\n                if (ignoreColors) {\n                    addBrightnessInfo(pixel1);\n                    addBrightnessInfo(pixel2);\n\n                    if (isPixelBrightnessSimilar(pixel1, pixel2) || !isWithinComparedArea) {\n                        if (!compareOnly) {\n                            copyGrayScalePixel(pix, offset, pixel2);\n                        }\n                    } else {\n                        if (!compareOnly) {\n                            errorPixel(pix, offset, pixel1, pixel2);\n                        }\n\n                        mismatchCount++;\n                        updateBounds(horizontalPos, verticalPos);\n                    }\n                    return;\n                }\n\n                if (isRGBSimilar(pixel1, pixel2) || !isWithinComparedArea) {\n                    if (!compareOnly) {\n                        copyPixel(pix, offset, pixel1);\n                    }\n                } else if (\n                    ignoreAntialiasing &&\n                    (addBrightnessInfo(pixel1), // jit pixel info augmentation looks a little weird, sorry.\n                    addBrightnessInfo(pixel2),\n                    isAntialiased(pixel1, data1, 1, verticalPos, horizontalPos, width) || isAntialiased(pixel2, data2, 2, verticalPos, horizontalPos, width))\n                ) {\n                    if (isPixelBrightnessSimilar(pixel1, pixel2) || !isWithinComparedArea) {\n                        if (!compareOnly) {\n                            copyGrayScalePixel(pix, offset, pixel2);\n                        }\n                    } else {\n                        if (!compareOnly) {\n                            errorPixel(pix, offset, pixel1, pixel2);\n                        }\n\n                        mismatchCount++;\n                        updateBounds(horizontalPos, verticalPos);\n                    }\n                } else {\n                    if (!compareOnly) {\n                        errorPixel(pix, offset, pixel1, pixel2);\n                    }\n\n                    mismatchCount++;\n                    updateBounds(horizontalPos, verticalPos);\n                }\n\n                if (compareOnly) {\n                    var currentMisMatchPercent = (mismatchCount / (height * width)) * 100;\n\n                    if (currentMisMatchPercent > returnEarlyThreshold) {\n                        skipTheRest = true;\n                    }\n                }\n            });\n\n            data.rawMisMatchPercentage = (mismatchCount / (height * width)) * 100;\n            data.misMatchPercentage = data.rawMisMatchPercentage.toFixed(2);\n            data.diffBounds = diffBounds;\n            data.analysisTime = Date.now() - time;\n\n            data.getImageDataUrl = function (text) {\n                if (compareOnly) {\n                    throw Error(\"No diff image available - ran in compareOnly mode\");\n                }\n\n                var barHeight = 0;\n\n                if (text) {\n                    barHeight = addLabel(text, context, hiddenCanvas);\n                }\n\n                context.putImageData(imgd, 0, barHeight);\n\n                return hiddenCanvas.toDataURL(\"image/png\");\n            };\n\n            if (!compareOnly && hiddenCanvas.toBuffer) {\n                data.getBuffer = function (includeOriginal) {\n                    if (includeOriginal) {\n                        var imageWidth = hiddenCanvas.width + 2;\n                        hiddenCanvas.width = imageWidth * 3;\n                        context.putImageData(img1, 0, 0);\n                        context.putImageData(img2, imageWidth, 0);\n                        context.putImageData(imgd, imageWidth * 2, 0);\n                    } else {\n                        context.putImageData(imgd, 0, 0);\n                    }\n                    return hiddenCanvas.toBuffer();\n                };\n            }\n        }\n\n        function addLabel(text, context, hiddenCanvas) {\n            var textPadding = 2;\n\n            context.font = \"12px sans-serif\";\n\n            var textWidth = context.measureText(text).width + textPadding * 2;\n            var barHeight = 22;\n\n            if (textWidth > hiddenCanvas.width) {\n                hiddenCanvas.width = textWidth;\n            }\n\n            hiddenCanvas.height += barHeight;\n\n            context.fillStyle = \"#666\";\n            context.fillRect(0, 0, hiddenCanvas.width, barHeight - 4);\n            context.fillStyle = \"#fff\";\n            context.fillRect(0, barHeight - 4, hiddenCanvas.width, 4);\n\n            context.fillStyle = \"#fff\";\n            context.textBaseline = \"top\";\n            context.font = \"12px sans-serif\";\n            context.fillText(text, textPadding, 1);\n\n            return barHeight;\n        }\n\n        function normalise(img, w, h) {\n            var c;\n            var context;\n\n            if (img.height < h || img.width < w) {\n                c = createCanvas(w, h);\n                context = c.getContext(\"2d\");\n                context.putImageData(img, 0, 0);\n                return context.getImageData(0, 0, w, h);\n            }\n\n            return img;\n        }\n\n        function outputSettings(options) {\n            var key;\n\n            if (options.errorColor) {\n                for (key in options.errorColor) {\n                    if (options.errorColor.hasOwnProperty(key)) {\n                        errorPixelColor[key] = options.errorColor[key] === void 0 ? errorPixelColor[key] : options.errorColor[key];\n                    }\n                }\n            }\n\n            if (options.errorType && errorPixelTransform[options.errorType]) {\n                errorPixel = errorPixelTransform[options.errorType];\n                errorType = options.errorType;\n            }\n\n            if (options.errorPixel && typeof options.errorPixel === \"function\") {\n                errorPixel = options.errorPixel;\n            }\n\n            pixelTransparency = isNaN(Number(options.transparency)) ? pixelTransparency : options.transparency;\n\n            if (options.largeImageThreshold !== undefined) {\n                largeImageThreshold = options.largeImageThreshold;\n            }\n\n            if (options.useCrossOrigin !== undefined) {\n                useCrossOrigin = options.useCrossOrigin;\n            }\n\n            if (options.boundingBox !== undefined) {\n                boundingBoxes = [options.boundingBox];\n            }\n\n            if (options.ignoredBox !== undefined) {\n                ignoredBoxes = [options.ignoredBox];\n            }\n\n            if (options.boundingBoxes !== undefined) {\n                boundingBoxes = options.boundingBoxes;\n            }\n\n            if (options.ignoredBoxes !== undefined) {\n                ignoredBoxes = options.ignoredBoxes;\n            }\n\n            if (options.ignoreAreasColoredWith !== undefined) {\n                ignoreAreasColoredWith = options.ignoreAreasColoredWith;\n            }\n        }\n\n        function compare(one, two) {\n            if (globalOutputSettings !== oldGlobalSettings) {\n                outputSettings(globalOutputSettings);\n            }\n\n            function onceWeHaveBoth() {\n                var width;\n                var height;\n                if (images.length === 2) {\n                    if (images[0].error || images[1].error) {\n                        data = {};\n                        data.error = images[0].error ? images[0].error : images[1].error;\n                        triggerDataUpdate();\n                        return;\n                    }\n                    width = images[0].width > images[1].width ? images[0].width : images[1].width;\n                    height = images[0].height > images[1].height ? images[0].height : images[1].height;\n\n                    if (images[0].width === images[1].width && images[0].height === images[1].height) {\n                        data.isSameDimensions = true;\n                    } else {\n                        data.isSameDimensions = false;\n                    }\n\n                    data.dimensionDifference = {\n                        width: images[0].width - images[1].width,\n                        height: images[0].height - images[1].height\n                    };\n\n                    analyseImages(normalise(images[0], width, height), normalise(images[1], width, height), width, height);\n\n                    triggerDataUpdate();\n                }\n            }\n\n            images = [];\n            loadImageData(one, onceWeHaveBoth);\n            loadImageData(two, onceWeHaveBoth);\n        }\n\n        function getCompareApi(param) {\n            var secondFileData;\n            var hasMethod = typeof param === \"function\";\n\n            if (!hasMethod) {\n                // assume it's file data\n                secondFileData = param;\n            }\n\n            var self = {\n                setReturnEarlyThreshold: function (threshold) {\n                    if (threshold) {\n                        compareOnly = true;\n                        returnEarlyThreshold = threshold;\n                    }\n                    return self;\n                },\n                scaleToSameSize: function () {\n                    scaleToSameSize = true;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                useOriginalSize: function () {\n                    scaleToSameSize = false;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                ignoreNothing: function () {\n                    tolerance.red = 0;\n                    tolerance.green = 0;\n                    tolerance.blue = 0;\n                    tolerance.alpha = 0;\n                    tolerance.minBrightness = 0;\n                    tolerance.maxBrightness = 255;\n\n                    ignoreAntialiasing = false;\n                    ignoreColors = false;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                ignoreLess: function () {\n                    tolerance.red = 16;\n                    tolerance.green = 16;\n                    tolerance.blue = 16;\n                    tolerance.alpha = 16;\n                    tolerance.minBrightness = 16;\n                    tolerance.maxBrightness = 240;\n\n                    ignoreAntialiasing = false;\n                    ignoreColors = false;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                ignoreAntialiasing: function () {\n                    tolerance.red = 32;\n                    tolerance.green = 32;\n                    tolerance.blue = 32;\n                    tolerance.alpha = 32;\n                    tolerance.minBrightness = 64;\n                    tolerance.maxBrightness = 96;\n\n                    ignoreAntialiasing = true;\n                    ignoreColors = false;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                ignoreColors: function () {\n                    tolerance.alpha = 16;\n                    tolerance.minBrightness = 16;\n                    tolerance.maxBrightness = 240;\n\n                    ignoreAntialiasing = false;\n                    ignoreColors = true;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                ignoreAlpha: function () {\n                    tolerance.red = 16;\n                    tolerance.green = 16;\n                    tolerance.blue = 16;\n                    tolerance.alpha = 255;\n                    tolerance.minBrightness = 16;\n                    tolerance.maxBrightness = 240;\n\n                    ignoreAntialiasing = false;\n                    ignoreColors = false;\n\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                repaint: function () {\n                    if (hasMethod) {\n                        param();\n                    }\n                    return self;\n                },\n                outputSettings: function (options) {\n                    outputSettings(options);\n                    return self;\n                },\n                onComplete: function (callback) {\n                    updateCallbackArray.push(callback);\n\n                    var wrapper = function () {\n                        compare(fileData, secondFileData);\n                    };\n\n                    wrapper();\n\n                    return getCompareApi(wrapper);\n                },\n                setupCustomTolerance: function (customSettings) {\n                    for (var property in tolerance) {\n                        if (!customSettings.hasOwnProperty(property)) {\n                            continue;\n                        }\n\n                        tolerance[property] = customSettings[property];\n                    }\n                }\n            };\n\n            return self;\n        }\n\n        var rootSelf = {\n            onComplete: function (callback) {\n                updateCallbackArray.push(callback);\n                loadImageData(fileData, function (imageData, width, height) {\n                    parseImage(imageData.data, width, height);\n                });\n            },\n            compareTo: function (secondFileData) {\n                return getCompareApi(secondFileData);\n            },\n            outputSettings: function (options) {\n                outputSettings(options);\n                return rootSelf;\n            }\n        };\n\n        return rootSelf;\n    };\n\n    function setGlobalOutputSettings(settings) {\n        globalOutputSettings = settings;\n        return resemble;\n    }\n\n    function applyIgnore(api, ignore, customTolerance) {\n        switch (ignore) {\n            case \"nothing\":\n                api.ignoreNothing();\n                break;\n            case \"less\":\n                api.ignoreLess();\n                break;\n            case \"antialiasing\":\n                api.ignoreAntialiasing();\n                break;\n            case \"colors\":\n                api.ignoreColors();\n                break;\n            case \"alpha\":\n                api.ignoreAlpha();\n                break;\n            default:\n                throw new Error(\"Invalid ignore: \" + ignore);\n        }\n\n        api.setupCustomTolerance(customTolerance);\n    }\n\n    resemble.compare = function (image1, image2, options, cb) {\n        var callback;\n        var opt;\n\n        if (typeof options === \"function\") {\n            callback = options;\n            opt = {};\n        } else {\n            callback = cb;\n            opt = options || {};\n        }\n\n        var res = resemble(image1);\n        var compare;\n\n        if (opt.output) {\n            res.outputSettings(opt.output);\n        }\n\n        compare = res.compareTo(image2);\n\n        if (opt.returnEarlyThreshold) {\n            compare.setReturnEarlyThreshold(opt.returnEarlyThreshold);\n        }\n\n        if (opt.scaleToSameSize) {\n            compare.scaleToSameSize();\n        }\n\n        var toleranceSettings = opt.tolerance || {};\n        if (typeof opt.ignore === \"string\") {\n            applyIgnore(compare, opt.ignore, toleranceSettings);\n        } else if (opt.ignore && opt.ignore.forEach) {\n            opt.ignore.forEach(function (v) {\n                applyIgnore(compare, v, toleranceSettings);\n            });\n        }\n\n        compare.onComplete(function (data) {\n            if (data.error) {\n                callback(data.error);\n            } else {\n                callback(null, data);\n            }\n        });\n    };\n\n    resemble.outputSettings = setGlobalOutputSettings;\n    return resemble;\n});\n", "const resemble = require(\"./resemble\");\n\nmodule.exports = function compareImages(image1, image2, options) {\n    return new Promise((resolve, reject) => {\n        resemble.compare(image1, image2, options, (err, data) => {\n            if (err) {\n                reject(err);\n            } else {\n                resolve(data);\n            }\n        });\n    });\n};\n", null, "var now = require('performance-now')\n  , root = typeof window === 'undefined' ? global : window\n  , vendors = ['moz', 'webkit']\n  , suffix = 'AnimationFrame'\n  , raf = root['request' + suffix]\n  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix]\n\nfor(var i = 0; !raf && i < vendors.length; i++) {\n  raf = root[vendors[i] + 'Request' + suffix]\n  caf = root[vendors[i] + 'Cancel' + suffix]\n      || root[vendors[i] + 'CancelRequest' + suffix]\n}\n\n// Some versions of FF have rAF but not cAF\nif(!raf || !caf) {\n  var last = 0\n    , id = 0\n    , queue = []\n    , frameDuration = 1000 / 60\n\n  raf = function(callback) {\n    if(queue.length === 0) {\n      var _now = now()\n        , next = Math.max(0, frameDuration - (_now - last))\n      last = next + _now\n      setTimeout(function() {\n        var cp = queue.slice(0)\n        // Clear queue here to prevent\n        // callbacks from appending listeners\n        // to the current frame's queue\n        queue.length = 0\n        for(var i = 0; i < cp.length; i++) {\n          if(!cp[i].cancelled) {\n            try{\n              cp[i].callback(last)\n            } catch(e) {\n              setTimeout(function() { throw e }, 0)\n            }\n          }\n        }\n      }, Math.round(next))\n    }\n    queue.push({\n      handle: ++id,\n      callback: callback,\n      cancelled: false\n    })\n    return id\n  }\n\n  caf = function(handle) {\n    for(var i = 0; i < queue.length; i++) {\n      if(queue[i].handle === handle) {\n        queue[i].cancelled = true\n      }\n    }\n  }\n}\n\nmodule.exports = function(fn) {\n  // Wrap in a new function to prevent\n  // `cancel` potentially being assigned\n  // to the native rAF function\n  return raf.call(root, fn)\n}\nmodule.exports.cancel = function() {\n  caf.apply(root, arguments)\n}\nmodule.exports.polyfill = function(object) {\n  if (!object) {\n    object = root;\n  }\n  object.requestAnimationFrame = raf\n  object.cancelAnimationFrame = caf\n}\n", "/*\n\tBased on rgbcolor.js by Stoyan Stefanov <sstoo@gmail.com>\n\thttp://www.phpied.com/rgb-color-parser-in-javascript/\n*/\n\nmodule.exports = function(color_string) {\n    this.ok = false;\n    this.alpha = 1.0;\n\n    // strip any leading #\n    if (color_string.charAt(0) == '#') { // remove # if any\n        color_string = color_string.substr(1,6);\n    }\n\n    color_string = color_string.replace(/ /g,'');\n    color_string = color_string.toLowerCase();\n\n    // before getting into regexps, try simple matches\n    // and overwrite the input\n    var simple_colors = {\n        aliceblue: 'f0f8ff',\n        antiquewhite: 'faebd7',\n        aqua: '00ffff',\n        aquamarine: '7fffd4',\n        azure: 'f0ffff',\n        beige: 'f5f5dc',\n        bisque: 'ffe4c4',\n        black: '000000',\n        blanchedalmond: 'ffebcd',\n        blue: '0000ff',\n        blueviolet: '8a2be2',\n        brown: 'a52a2a',\n        burlywood: 'deb887',\n        cadetblue: '5f9ea0',\n        chartreuse: '7fff00',\n        chocolate: 'd2691e',\n        coral: 'ff7f50',\n        cornflowerblue: '6495ed',\n        cornsilk: 'fff8dc',\n        crimson: 'dc143c',\n        cyan: '00ffff',\n        darkblue: '00008b',\n        darkcyan: '008b8b',\n        darkgoldenrod: 'b8860b',\n        darkgray: 'a9a9a9',\n        darkgreen: '006400',\n        darkkhaki: 'bdb76b',\n        darkmagenta: '8b008b',\n        darkolivegreen: '556b2f',\n        darkorange: 'ff8c00',\n        darkorchid: '9932cc',\n        darkred: '8b0000',\n        darksalmon: 'e9967a',\n        darkseagreen: '8fbc8f',\n        darkslateblue: '483d8b',\n        darkslategray: '2f4f4f',\n        darkturquoise: '00ced1',\n        darkviolet: '9400d3',\n        deeppink: 'ff1493',\n        deepskyblue: '00bfff',\n        dimgray: '696969',\n        dodgerblue: '1e90ff',\n        feldspar: 'd19275',\n        firebrick: 'b22222',\n        floralwhite: 'fffaf0',\n        forestgreen: '228b22',\n        fuchsia: 'ff00ff',\n        gainsboro: 'dcdcdc',\n        ghostwhite: 'f8f8ff',\n        gold: 'ffd700',\n        goldenrod: 'daa520',\n        gray: '808080',\n        green: '008000',\n        greenyellow: 'adff2f',\n        honeydew: 'f0fff0',\n        hotpink: 'ff69b4',\n        indianred : 'cd5c5c',\n        indigo : '4b0082',\n        ivory: 'fffff0',\n        khaki: 'f0e68c',\n        lavender: 'e6e6fa',\n        lavenderblush: 'fff0f5',\n        lawngreen: '7cfc00',\n        lemonchiffon: 'fffacd',\n        lightblue: 'add8e6',\n        lightcoral: 'f08080',\n        lightcyan: 'e0ffff',\n        lightgoldenrodyellow: 'fafad2',\n        lightgrey: 'd3d3d3',\n        lightgreen: '90ee90',\n        lightpink: 'ffb6c1',\n        lightsalmon: 'ffa07a',\n        lightseagreen: '20b2aa',\n        lightskyblue: '87cefa',\n        lightslateblue: '8470ff',\n        lightslategray: '778899',\n        lightsteelblue: 'b0c4de',\n        lightyellow: 'ffffe0',\n        lime: '00ff00',\n        limegreen: '32cd32',\n        linen: 'faf0e6',\n        magenta: 'ff00ff',\n        maroon: '800000',\n        mediumaquamarine: '66cdaa',\n        mediumblue: '0000cd',\n        mediumorchid: 'ba55d3',\n        mediumpurple: '9370d8',\n        mediumseagreen: '3cb371',\n        mediumslateblue: '7b68ee',\n        mediumspringgreen: '00fa9a',\n        mediumturquoise: '48d1cc',\n        mediumvioletred: 'c71585',\n        midnightblue: '191970',\n        mintcream: 'f5fffa',\n        mistyrose: 'ffe4e1',\n        moccasin: 'ffe4b5',\n        navajowhite: 'ffdead',\n        navy: '000080',\n        oldlace: 'fdf5e6',\n        olive: '808000',\n        olivedrab: '6b8e23',\n        orange: 'ffa500',\n        orangered: 'ff4500',\n        orchid: 'da70d6',\n        palegoldenrod: 'eee8aa',\n        palegreen: '98fb98',\n        paleturquoise: 'afeeee',\n        palevioletred: 'd87093',\n        papayawhip: 'ffefd5',\n        peachpuff: 'ffdab9',\n        peru: 'cd853f',\n        pink: 'ffc0cb',\n        plum: 'dda0dd',\n        powderblue: 'b0e0e6',\n        purple: '800080',\n        rebeccapurple: '663399',\n        red: 'ff0000',\n        rosybrown: 'bc8f8f',\n        royalblue: '4169e1',\n        saddlebrown: '8b4513',\n        salmon: 'fa8072',\n        sandybrown: 'f4a460',\n        seagreen: '2e8b57',\n        seashell: 'fff5ee',\n        sienna: 'a0522d',\n        silver: 'c0c0c0',\n        skyblue: '87ceeb',\n        slateblue: '6a5acd',\n        slategray: '708090',\n        snow: 'fffafa',\n        springgreen: '00ff7f',\n        steelblue: '4682b4',\n        tan: 'd2b48c',\n        teal: '008080',\n        thistle: 'd8bfd8',\n        tomato: 'ff6347',\n        turquoise: '40e0d0',\n        violet: 'ee82ee',\n        violetred: 'd02090',\n        wheat: 'f5deb3',\n        white: 'ffffff',\n        whitesmoke: 'f5f5f5',\n        yellow: 'ffff00',\n        yellowgreen: '9acd32'\n    };\n    color_string = simple_colors[color_string] || color_string;\n    // emd of simple type-in colors\n\n    // array of color definition objects\n    var color_defs = [\n        {\n            re: /^rgba\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3}),\\s*((?:\\d?\\.)?\\d)\\)$/,\n            example: ['rgba(123, 234, 45, 0.8)', 'rgba(255,234,245,1.0)'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1]),\n                    parseInt(bits[2]),\n                    parseInt(bits[3]),\n                    parseFloat(bits[4])\n                ];\n            }\n        },\n        {\n            re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\n            example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1]),\n                    parseInt(bits[2]),\n                    parseInt(bits[3])\n                ];\n            }\n        },\n        {\n            re: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n            example: ['#00ff00', '336699'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1], 16),\n                    parseInt(bits[2], 16),\n                    parseInt(bits[3], 16)\n                ];\n            }\n        },\n        {\n            re: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n            example: ['#fb0', 'f0f'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1] + bits[1], 16),\n                    parseInt(bits[2] + bits[2], 16),\n                    parseInt(bits[3] + bits[3], 16)\n                ];\n            }\n        }\n    ];\n\n    // search through the definitions to find a match\n    for (var i = 0; i < color_defs.length; i++) {\n        var re = color_defs[i].re;\n        var processor = color_defs[i].process;\n        var bits = re.exec(color_string);\n        if (bits) {\n            var channels = processor(bits);\n            this.r = channels[0];\n            this.g = channels[1];\n            this.b = channels[2];\n            if (channels.length > 3) {\n                this.alpha = channels[3];\n            }\n            this.ok = true;\n        }\n\n    }\n\n    // validate/cleanup values\n    this.r = (this.r < 0 || isNaN(this.r)) ? 0 : ((this.r > 255) ? 255 : this.r);\n    this.g = (this.g < 0 || isNaN(this.g)) ? 0 : ((this.g > 255) ? 255 : this.g);\n    this.b = (this.b < 0 || isNaN(this.b)) ? 0 : ((this.b > 255) ? 255 : this.b);\n    this.alpha = (this.alpha < 0) ? 0 : ((this.alpha > 1.0 || isNaN(this.alpha)) ? 1.0 : this.alpha);\n\n    // some getters\n    this.toRGB = function () {\n        return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';\n    }\n    this.toRGBA = function () {\n        return 'rgba(' + this.r + ', ' + this.g + ', ' + this.b + ', ' + this.alpha + ')';\n    }\n    this.toHex = function () {\n        var r = this.r.toString(16);\n        var g = this.g.toString(16);\n        var b = this.b.toString(16);\n        if (r.length == 1) r = '0' + r;\n        if (g.length == 1) g = '0' + g;\n        if (b.length == 1) b = '0' + b;\n        return '#' + r + g + b;\n    }\n\n    // help\n    this.getHelpXML = function () {\n\n        var examples = new Array();\n        // add regexps\n        for (var i = 0; i < color_defs.length; i++) {\n            var example = color_defs[i].example;\n            for (var j = 0; j < example.length; j++) {\n                examples[examples.length] = example[j];\n            }\n        }\n        // add type-in colors\n        for (var sc in simple_colors) {\n            examples[examples.length] = sc;\n        }\n\n        var xml = document.createElement('ul');\n        xml.setAttribute('id', 'rgbcolor-examples');\n        for (var i = 0; i < examples.length; i++) {\n            try {\n                var list_item = document.createElement('li');\n                var list_color = new RGBColor(examples[i]);\n                var example_div = document.createElement('div');\n                example_div.style.cssText =\n                        'margin: 3px; '\n                        + 'border: 1px solid black; '\n                        + 'background:' + list_color.toHex() + '; '\n                        + 'color:' + list_color.toHex()\n                ;\n                example_div.appendChild(document.createTextNode('test'));\n                var list_item_value = document.createTextNode(\n                    ' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex()\n                );\n                list_item.appendChild(example_div);\n                list_item.appendChild(list_item_value);\n                xml.appendChild(list_item);\n\n            } catch(e){}\n        }\n        return xml;\n\n    }\n\n}\n", "import { EMPTY_ARR } from \"./constants\";\n\n/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\t// @ts-ignore We change the type of `obj` to be `O & P`\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\nexport const slice = EMPTY_ARR.slice;\n", "import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n", "import { slice } from './util';\nimport options from './options';\n\nlet vnodeId = 0;\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 2) {\n\t\tnormalizedProps.children =\n\t\t\targuments.length > 3 ? slice.call(arguments, 2) : children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(type, normalizedProps, key, ref, null);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\t_hydrating: null,\n\t\tconstructor: undefined,\n\t\t_original: original == null ? ++vnodeId : original\n\t};\n\n\t// Only invoke the vnode hook if this was *not* a direct copy:\n\tif (original == null && options.vnode != null) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn { current: null };\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n", "import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @this {import('./internal').Component}\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState != null && this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\t// Some libraries like `immer` mark the current state as readonly,\n\t\t// preventing us from mutating it, so we need to clone it. See #2716\n\t\tupdate = update(assign({}, s), this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) {\n\t\t\tthis._stateCallbacks.push(callback);\n\t\t}\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @this {import('./internal').Component}\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = vnode._original + 1;\n\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tvnode._hydrating != null ? [oldDom] : null,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom,\n\t\t\tvnode._hydrating\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (vnode._dom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!process._rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || setTimeout)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((process._rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\n\nprocess._rerenderCount = 0;\n", "import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue, contextId) {\n\tcontextId = '__cC' + i++;\n\n\tconst context = {\n\t\t_id: contextId,\n\t\t_defaultValue: defaultValue,\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tConsumer(props, contextValue) {\n\t\t\t// return props.children(\n\t\t\t// \tcontext[contextId] ? context[contextId].props.value : defaultValue\n\t\t\t// );\n\t\t\treturn props.children(contextValue);\n\t\t},\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tlet subs = [];\n\t\t\t\tlet ctx = {};\n\t\t\t\tctx[contextId] = this;\n\n\t\t\t\tthis.getChildContext = () => ctx;\n\n\t\t\t\tthis.shouldComponentUpdate = function(_props) {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\t// I think the forced value propagation here was only needed when `options.debounceRendering` was being bypassed:\n\t\t\t\t\t\t// https://github.com/preactjs/preact/commit/4d339fb803bea09e9f198abf38ca1bf8ea4b7771#diff-54682ce380935a717e41b8bfc54737f6R358\n\t\t\t\t\t\t// In those cases though, even with the value corrected, we're double-rendering all nodes.\n\t\t\t\t\t\t// It might be better to just tell folks not to use force-sync mode.\n\t\t\t\t\t\t// Currently, using `useContext()` in a class component will overwrite its `this.context` value.\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context[contextId] = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\t\t\t\t\t\tsubs.some(enqueueRender);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\tif (old) old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\n\treturn (context.Provider._contextRef = context.Consumer.contextType = context);\n}\n", "export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\n", "import { diff, unmount, applyRef } from './index';\nimport { createVNode, Fragment } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').ComponentChildren[]} renderResult\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\trenderResult,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, childVNode, newDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\tnewParentVNode._children = [];\n\tfor (i = 0; i < renderResult.length; i++) {\n\t\tchildVNode = renderResult[i];\n\n\t\tif (childVNode == null || typeof childVNode == 'boolean') {\n\t\t\tchildVNode = newParentVNode._children[i] = null;\n\t\t}\n\t\t// If this newVNode is being reused (e.g. <div>{reuse}{reuse}</div>) in the same diff,\n\t\t// or we are rendering a component (e.g. setState) copy the oldVNodes so it can have\n\t\t// it's own DOM & etc. pointers\n\t\telse if (\n\t\t\ttypeof childVNode == 'string' ||\n\t\t\ttypeof childVNode == 'number' ||\n\t\t\t// eslint-disable-next-line valid-typeof\n\t\t\ttypeof childVNode == 'bigint'\n\t\t) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tnull,\n\t\t\t\tchildVNode,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tchildVNode\n\t\t\t);\n\t\t} else if (Array.isArray(childVNode)) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tFragment,\n\t\t\t\t{ children: childVNode },\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull\n\t\t\t);\n\t\t} else if (childVNode._depth > 0) {\n\t\t\t// VNode is already in use, clone it. This can happen in the following\n\t\t\t// scenario:\n\t\t\t//   const reuse = <div />\n\t\t\t//   <div>{reuse}<span />{reuse}</div>\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tchildVNode.type,\n\t\t\t\tchildVNode.props,\n\t\t\t\tchildVNode.key,\n\t\t\t\tchildVNode.ref ? childVNode.ref : null,\n\t\t\t\tchildVNode._original\n\t\t\t);\n\t\t} else {\n\t\t\tchildVNode = newParentVNode._children[i] = childVNode;\n\t\t}\n\n\t\t// Terser removes the `continue` here and wraps the loop body\n\t\t// in a `if (childVNode) { ... } condition\n\t\tif (childVNode == null) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tchildVNode._parent = newParentVNode;\n\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t// Check if we find a corresponding element in oldChildren.\n\t\t// If found, delete the array item by setting to `undefined`.\n\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t// (holes).\n\t\toldVNode = oldChildren[i];\n\n\t\tif (\n\t\t\toldVNode === null ||\n\t\t\t(oldVNode &&\n\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t) {\n\t\t\toldChildren[i] = undefined;\n\t\t} else {\n\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t// We always match by type (in either case).\n\t\t\t\tif (\n\t\t\t\t\toldVNode &&\n\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t) {\n\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\toldVNode = null;\n\t\t\t}\n\t\t}\n\n\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tchildVNode,\n\t\t\toldVNode,\n\t\t\tglobalContext,\n\t\t\tisSvg,\n\t\t\texcessDomChildren,\n\t\t\tcommitQueue,\n\t\t\toldDom,\n\t\t\tisHydrating\n\t\t);\n\n\t\tnewDom = childVNode._dom;\n\n\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\tif (!refs) refs = [];\n\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t}\n\n\t\tif (newDom != null) {\n\t\t\tif (firstChildDom == null) {\n\t\t\t\tfirstChildDom = newDom;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof childVNode.type == 'function' &&\n\t\t\t\tchildVNode._children === oldVNode._children\n\t\t\t) {\n\t\t\t\tchildVNode._nextDom = oldDom = reorderChildren(\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldDom,\n\t\t\t\t\tparentDom\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\toldChildren,\n\t\t\t\t\tnewDom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t//\n\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t// node's nextSibling.\n\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t}\n\t\t} else if (\n\t\t\toldDom &&\n\t\t\toldVNode._dom == oldDom &&\n\t\t\toldDom.parentNode != parentDom\n\t\t) {\n\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\toldDom = getDomSibling(oldVNode);\n\t\t}\n\t}\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) {\n\t\t\tunmount(oldChildren[i], oldChildren[i]);\n\t\t}\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\nfunction reorderChildren(childVNode, oldDom, parentDom) {\n\t// Note: VNodes in nested suspended trees may be missing _children.\n\tlet c = childVNode._children;\n\tlet tmp = 0;\n\tfor (; c && tmp < c.length; tmp++) {\n\t\tlet vnode = c[tmp];\n\t\tif (vnode) {\n\t\t\t// We typically enter this code path on sCU bailout, where we copy\n\t\t\t// oldVNode._children to newVNode._children. If that is the case, we need\n\t\t\t// to update the old children's _parent pointer to point to the newVNode\n\t\t\t// (childVNode here).\n\t\t\tvnode._parent = childVNode;\n\n\t\t\tif (typeof vnode.type == 'function') {\n\t\t\t\toldDom = reorderChildren(vnode, oldDom, parentDom);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(parentDom, vnode, vnode, c, vnode._dom, oldDom);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oldDom;\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, out) {\n\tout = out || [];\n\tif (children == null || typeof children == 'boolean') {\n\t} else if (Array.isArray(children)) {\n\t\tchildren.some(child => {\n\t\t\ttoChildArray(child, out);\n\t\t});\n\t} else {\n\t\tout.push(children);\n\t}\n\treturn out;\n}\n\nfunction placeChild(\n\tparentDom,\n\tchildVNode,\n\toldVNode,\n\toldChildren,\n\tnewDom,\n\toldDom\n) {\n\tlet nextDom;\n\tif (childVNode._nextDom !== undefined) {\n\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t// of last DOM child of this child VNode\n\t\tnextDom = childVNode._nextDom;\n\n\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t// can clean up the property\n\t\tchildVNode._nextDom = undefined;\n\t} else if (\n\t\toldVNode == null ||\n\t\tnewDom != oldDom ||\n\t\tnewDom.parentNode == null\n\t) {\n\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\tparentDom.appendChild(newDom);\n\t\t\tnextDom = null;\n\t\t} else {\n\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\tfor (\n\t\t\t\tlet sibDom = oldDom, j = 0;\n\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildren.length;\n\t\t\t\tj += 1\n\t\t\t) {\n\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\tnextDom = oldDom;\n\t\t}\n\t}\n\n\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t// See more detail in create-element.js:createVNode\n\tif (nextDom !== undefined) {\n\t\toldDom = nextDom;\n\t} else {\n\t\toldDom = newDom.nextSibling;\n\t}\n\n\treturn oldDom;\n}\n", "import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else if (typeof value != 'number' || IS_NON_DIMENSIONAL.test(key)) {\n\t\tstyle[key] = value;\n\t} else {\n\t\tstyle[key] = value + 'px';\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet useCapture;\n\n\to: if (name === 'style') {\n\t\tif (typeof value == 'string') {\n\t\t\tdom.style.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\tdom.style.cssText = oldValue = '';\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (name in oldValue) {\n\t\t\t\t\tif (!(value && name in value)) {\n\t\t\t\t\t\tsetStyle(dom.style, name, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (name in value) {\n\t\t\t\t\tif (!oldValue || value[name] !== oldValue[name]) {\n\t\t\t\t\t\tsetStyle(dom.style, name, value[name]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\n\t\t// Infer correct casing for DOM built-in events:\n\t\tif (name.toLowerCase() in dom) name = name.toLowerCase().slice(2);\n\t\telse name = name.slice(2);\n\n\t\tif (!dom._listeners) dom._listeners = {};\n\t\tdom._listeners[name + useCapture] = value;\n\n\t\tif (value) {\n\t\t\tif (!oldValue) {\n\t\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\t\tdom.addEventListener(name, handler, useCapture);\n\t\t\t}\n\t\t} else {\n\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\tdom.removeEventListener(name, handler, useCapture);\n\t\t}\n\t} else if (name !== 'dangerouslySetInnerHTML') {\n\t\tif (isSvg) {\n\t\t\t// Normalize incorrect prop usage for SVG:\n\t\t\t// - xlink:href / xlinkHref --> href (xlink:href was removed from SVG and isn't needed)\n\t\t\t// - className --> class\n\t\t\tname = name.replace(/xlink(H|:h)/, 'h').replace(/sName$/, 's');\n\t\t} else if (\n\t\t\tname !== 'href' &&\n\t\t\tname !== 'list' &&\n\t\t\tname !== 'form' &&\n\t\t\t// Default value in browsers is `-1` and an empty string is\n\t\t\t// cast to `0` instead\n\t\t\tname !== 'tabIndex' &&\n\t\t\tname !== 'download' &&\n\t\t\tname in dom\n\t\t) {\n\t\t\ttry {\n\t\t\t\tdom[name] = value == null ? '' : value;\n\t\t\t\t// labelled break is 1b smaller here than a return statement (sorry)\n\t\t\t\tbreak o;\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t// The value `false` is different from the attribute not\n\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t// that other VDOM frameworks also always stringify `false`.\n\n\t\tif (typeof value === 'function') {\n\t\t\t// never serialize functions as attribute values\n\t\t} else if (value != null && (value !== false || name.indexOf('-') != -1)) {\n\t\t\tdom.setAttribute(name, value);\n\t\t} else {\n\t\t\tdom.removeAttribute(name);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type + false](options.event ? options.event(e) : e);\n}\n\nfunction eventProxyCapture(e) {\n\tthis._listeners[e.type + true](options.event ? options.event(e) : e);\n}\n", "import { EMPTY_OBJ } from '../constants';\nimport { Component, getDomSibling } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode, slice } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\t// If the previous diff bailed out, resume creating/hydrating.\n\tif (oldVNode._hydrating != null) {\n\t\tisHydrating = oldVNode._hydrating;\n\t\toldDom = newVNode._dom = oldVNode._dom;\n\t\t// if we resume, we want the tree to be \"unlocked\"\n\t\tnewVNode._hydrating = null;\n\t\texcessDomChildren = [oldDom];\n\t}\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\t// @ts-ignore The check above verifies that newType is suppose to be constructed\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore Trust me, Component implements the interface we want\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t\tc._stateCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\tnewVNode._original === oldVNode._original\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tnewVNode._children.forEach(vnode => {\n\t\t\t\t\t\tif (vnode) vnode._parent = newVNode;\n\t\t\t\t\t});\n\n\t\t\t\t\tfor (let i = 0; i < c._stateCallbacks.length; i++) {\n\t\t\t\t\t\tc._renderCallbacks.push(c._stateCallbacks[i]);\n\t\t\t\t\t}\n\t\t\t\t\tc._stateCallbacks = [];\n\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\tlet renderHook = options._render,\n\t\t\t\tcount = 0;\n\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\tc.state = c._nextState;\n\t\t\t\tc._dirty = false;\n\n\t\t\t\tif (renderHook) renderHook(newVNode);\n\n\t\t\t\ttmp = c.render(c.props, c.state, c.context);\n\n\t\t\t\tfor (let i = 0; i < c._stateCallbacks.length; i++) {\n\t\t\t\t\tc._renderCallbacks.push(c._stateCallbacks[i]);\n\t\t\t\t}\n\t\t\t\tc._stateCallbacks = [];\n\t\t\t} else {\n\t\t\t\tdo {\n\t\t\t\t\tc._dirty = false;\n\t\t\t\t\tif (renderHook) renderHook(newVNode);\n\n\t\t\t\t\ttmp = c.render(c.props, c.state, c.context);\n\n\t\t\t\t\t// Handle setState called in render, see #2553\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t} while (c._dirty && ++count < 25);\n\t\t\t}\n\n\t\t\t// Handle setState called in render, see #2553\n\t\t\tc.state = c._nextState;\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type === Fragment && tmp.key == null;\n\t\t\tlet renderResult = isTopLevelFragment ? tmp.props.children : tmp;\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tArray.isArray(renderResult) ? renderResult : [renderResult],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\t// We successfully rendered this VNode, unset any stored hydration/bailout state:\n\t\t\tnewVNode._hydrating = null;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\t// if hydrating or creating initial tree, bailout preserves DOM:\n\t\tif (isHydrating || excessDomChildren != null) {\n\t\t\tnewVNode._dom = oldDom;\n\t\t\tnewVNode._hydrating = !!isHydrating;\n\t\t\texcessDomChildren[excessDomChildren.indexOf(oldDom)] = null;\n\t\t\t// ^ could possibly be simplified to:\n\t\t\t// excessDomChildren.length = 0;\n\t\t}\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\t// @ts-ignore Reuse the commitQueue variable here so the type changes\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\t// @ts-ignore See above ts-ignore on commitQueue\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\tlet nodeType = newVNode.type;\n\tlet i = 0;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tif (nodeType === 'svg') isSvg = true;\n\n\tif (excessDomChildren != null) {\n\t\tfor (; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild &&\n\t\t\t\t'setAttribute' in child === !!nodeType &&\n\t\t\t\t(nodeType ? child.localName === nodeType : child.nodeType === 3)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (nodeType === null) {\n\t\t\t// @ts-ignore createTextNode returns Text, we expect PreactElement\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tif (isSvg) {\n\t\t\tdom = document.createElementNS(\n\t\t\t\t'http://www.w3.org/2000/svg',\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType\n\t\t\t);\n\t\t} else {\n\t\t\tdom = document.createElement(\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType,\n\t\t\t\tnewProps.is && newProps\n\t\t\t);\n\t\t}\n\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (nodeType === null) {\n\t\t// During hydration, we still have to split merged text from SSR'd HTML.\n\t\tif (oldProps !== newProps && (!isHydrating || dom.data !== newProps)) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\t// If excessDomChildren was not null, repopulate it with the current element's children:\n\t\texcessDomChildren = excessDomChildren && slice.call(dom.childNodes);\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\t// But, if we are in a situation where we are using existing DOM (e.g. replaceNode)\n\t\t\t// we should read the existing DOM attributes to diff them\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (\n\t\t\t\t\t!newHtml ||\n\t\t\t\t\t((!oldHtml || newHtml.__html != oldHtml.__html) &&\n\t\t\t\t\t\tnewHtml.__html !== dom.innerHTML)\n\t\t\t\t) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\ti = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tArray.isArray(i) ? i : [i],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg && nodeType !== 'foreignObject',\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\texcessDomChildren\n\t\t\t\t\t? excessDomChildren[0]\n\t\t\t\t\t: oldVNode._children && getDomSibling(oldVNode, 0),\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\t// Remove children that are not part of any vnode.\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\t// #2756 For the <progress>-element the initial value is 0,\n\t\t\t\t// despite the attribute not being present. When the attribute\n\t\t\t\t// is missing the progress bar is treated as indeterminate.\n\t\t\t\t// To fix that we'll always update it when it is 0 for progress elements\n\t\t\t\t(i !== dom.value ||\n\t\t\t\t\t(nodeType === 'progress' && !i) ||\n\t\t\t\t\t// This is only for IE 11 to fix <select> value not being updated.\n\t\t\t\t\t// To avoid a stale select value we need to set the option.value\n\t\t\t\t\t// again, which triggers IE11 to re-evaluate the select value\n\t\t\t\t\t(nodeType === 'option' && i !== oldProps.value))\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) {\n\t\t\tapplyRef(r, null, parentVNode);\n\t\t}\n\t}\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t\tvnode._component = undefined;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) {\n\t\t\t\tunmount(\n\t\t\t\t\tr[i],\n\t\t\t\t\tparentVNode,\n\t\t\t\t\tskipRemove || typeof vnode.type !== 'function'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!skipRemove && vnode._dom != null) {\n\t\tremoveNode(vnode._dom);\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._parent = vnode._dom = vnode._nextDom = undefined;\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n", "import { EMPTY_OBJ } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\nimport { slice } from './util';\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {import('./internal').PreactElement | object} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we are in\n\t// hydration mode or not by passing the `hydrate` function instead of a DOM\n\t// element..\n\tlet isHydrating = typeof replaceNode === 'function';\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\n\tvnode = (\n\t\t(!isHydrating && replaceNode) ||\n\t\tparentDom\n\t)._children = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\tvnode,\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\t!isHydrating && replaceNode\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: parentDom.firstChild\n\t\t\t? slice.call(parentDom.childNodes)\n\t\t\t: null,\n\t\tcommitQueue,\n\t\t!isHydrating && replaceNode\n\t\t\t? replaceNode\n\t\t\t: oldVNode\n\t\t\t? oldVNode._dom\n\t\t\t: parentDom.firstChild,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, hydrate);\n}\n", "import { assign, slice } from './util';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./internal').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props, children) {\n\tlet normalizedProps = assign({}, vnode.props),\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 2) {\n\t\tnormalizedProps.children =\n\t\t\targuments.length > 3 ? slice.call(arguments, 2) : children;\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tkey || vnode.key,\n\t\tref || vnode.ref,\n\t\tnull\n\t);\n}\n", "/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n * @param {import('../internal').VNode} [oldVNode]\n * @param {import('../internal').ErrorInfo} [errorInfo]\n */\nexport function _catchError(error, vnode, oldVNode, errorInfo) {\n\t/** @type {import('../internal').Component} */\n\tlet component, ctor, handled;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tctor = component.constructor;\n\n\t\t\t\tif (ctor && ctor.getDerivedStateFromError != null) {\n\t\t\t\t\tcomponent.setState(ctor.getDerivedStateFromError(error));\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\tcomponent.componentDidCatch(error, errorInfo || {});\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\t// This is an error boundary. Mark it as having bailed out, and whether it was mid-hydration.\n\t\t\t\tif (handled) {\n\t\t\t\t\treturn (component._pendingError = component);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n", "import { h, Fragment, render, Component } from \"preact\";\nimport compareImages from \"resemblejs/compareImages\";\nimport { Canvg } from \"canvg\";\n\nconst container = document.querySelector(\"#container\");\n\nclass Chooser extends Component {\n  constructor(props) {\n    super(props);\n    this.setState({\n      color: props.colors[0],\n      radius: props.radii[0],\n    });\n  }\n  componentDidUpdate() {\n    this.props.updater(this.state.color, this.state.radius);\n  }\n  render() {\n    let colorRows = [];\n    for (const color of this.props.colors) {\n      colorRows.push(\n        <td class=\"pr-1\">\n          <div\n            onClick={() => {\n              this.setState({\n                color: color,\n              });\n            }}\n            style={{\n              width: \"60px\",\n              height: \"60px\",\n              backgroundColor: color,\n              border:\n                this.state.color == color ? \"4px solid red\" : \"4px solid black\",\n              cursor: \"pointer\",\n            }}\n          ></div>\n          <div\n            onClick={() => {\n              const canvas = document.querySelector(\"#canvas\");\n              const ctx = canvas.getContext(\"2d\");\n              ctx.rect(\n                0,\n                0,\n                canvas.getAttribute(\"width\"),\n                canvas.getAttribute(\"height\")\n              );\n              ctx.fillStyle = color;\n              ctx.fill();\n            }}\n            class=\"mt-1 cursor-pointer rounded-md flex items-center justify-center p-2 bg-slate-700 text-white\"\n          >\n            <span>fill</span>\n          </div>\n        </td>\n      );\n    }\n    for (const size of this.props.radii) {\n      colorRows.push(\n        <td>\n          <div\n            class=\"flex items-center cursor-pointer justify-center bg-green-200\"\n            style={{\n              minWidth: \"60px\",\n              minHeight: \"60px\",\n            }}\n            onClick={() => {\n              this.setState({\n                radius: size,\n              });\n            }}\n          >\n            <div\n              style={{\n                width: `${size * 2}px`,\n                height: `${size * 2}px`,\n                backgroundColor: this.state.radius == size ? \"red\" : \"white\",\n                border: \"4px solid black\",\n                borderRadius: \"100000px\",\n              }}\n            ></div>\n          </div>\n        </td>\n      );\n    }\n\n    let colorSelector = (\n      <table class=\"mt-1\">\n        <tbody>\n          <tr>{colorRows}</tr>\n        </tbody>\n      </table>\n    );\n    return (\n      <div>\n        <div>{colorSelector}</div>\n      </div>\n    );\n  }\n}\n\nfunction flagDrawer(options) {\n  let colors = options.colors;\n  let isDrawing = false;\n  let rect = null;\n  colors = colors.map((x) => `#${x}`);\n  let currColor = colors[0];\n  let radiuses = [5, 10, 25];\n  let currRadius = radiuses[0];\n  const canvasWidth = options.width;\n  const canvasHeight = options.height;\n  let lastCoords = null;\n\n  const drawCircle = (ctx, options) => {\n    ctx.beginPath();\n    ctx.arc(options.x, options.y, options.radius, 0, 2 * Math.PI, false);\n    ctx.fillStyle = options.color;\n    ctx.fill();\n  };\n\n  document.body.addEventListener(\"mouseup\", () => {\n    isDrawing = false;\n  });\n\n  let canvasEl = (\n    <canvas\n      width={canvasWidth}\n      height={canvasHeight}\n      id=\"canvas\"\n      style=\"border: 1px solid black; margin: 0 auto;\"\n      onMouseDown={(e) => {\n        const canvas = e.target;\n        const ctx = canvas.getContext(\"2d\");\n        rect = canvas.getBoundingClientRect();\n        let x = e.x - rect.x;\n        let y = e.y - rect.y;\n\n        drawCircle(ctx, {\n          x: x,\n          y: y,\n          radius: currRadius,\n          color: currColor,\n        });\n        lastCoords = [x, y];\n        isDrawing = true;\n      }}\n      // onMouseUp={() => {\n      //   isDrawing = false;\n      // }}\n      onMouseMove={(e) => {\n        if (!isDrawing) {\n          return;\n        }\n        let x = e.x - rect.x;\n        let y = e.y - rect.y;\n        const canvas = e.target;\n        const ctx = canvas.getContext(\"2d\");\n        if (lastCoords !== null) {\n          ctx.beginPath();\n          ctx.moveTo(lastCoords[0], lastCoords[1]);\n          ctx.lineTo(x, y);\n          ctx.lineWidth = currRadius * 2;\n          ctx.strokeStyle = currColor;\n\n          // Draw the Path\n          ctx.stroke();\n        }\n\n        drawCircle(ctx, {\n          x: x,\n          y: y,\n          radius: currRadius,\n          color: currColor,\n        });\n        lastCoords = [x, y];\n      }}\n    ></canvas>\n  );\n\n  return (\n    <div class=\"mt-2\">\n      {canvasEl}\n      <Chooser\n        colors={colors}\n        radii={radiuses}\n        updater={(color, radius) => {\n          currColor = color;\n          currRadius = radius;\n        }}\n      />\n    </div>\n  );\n}\n\nfunction canvasToImg(desc, canvas) {\n  const image = document.createElement(\"img\");\n  image.src = canvas.toDataURL(\"image/png\");\n  image.style.width = \"570px\";\n  let p = document.createElement(\"p\");\n  p.innerText = desc;\n\n  document.body.appendChild(p);\n  document.body.appendChild(image);\n}\n\nasync function renderSvgToCanvas(url) {\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  let vr = await Canvg.from(ctx, url);\n  vr.start();\n  return canvas;\n}\n\nasync function compareFlags(name, drawnFlagCanvas, svgUrl) {\n  // render the svg to a canvas\n  const expectedCanvas = await renderSvgToCanvas(svgUrl);\n\n  // let canvasDrawn = document.querySelector(\"#canvas\");\n  // canvasDrawn = await getBlurredCanvas({\n  //   canvas: canvasDrawn,\n  //   blurRadius: 20,\n  // });\n  // canvasToImg(\"drawn\", canvasDrawn);\n  // const canvasExpected = document.querySelector(\"#orig-canvas\");\n  // canvasToImg(\"expected\", canvasExpected);\n  // console.log(canvasExpected.toDataURL())\n  let result = await compareImages(\n    expectedCanvas.toDataURL(),\n    drawnFlagCanvas.toDataURL(),\n    {\n      scaleToSameSize: true,\n      tolerance: {\n        alpha: 100,\n      },\n    }\n  );\n\n  return { name, similarityPercent: 100.0 - result.misMatchPercentage };\n}\n\n// async function showComparison() {\n//   await sleep(100);\n//   let canvasDrawn = document.querySelector(\"#canvas\");\n//   canvasDrawn = await getBlurredCanvas({\n//     canvas: canvasDrawn,\n//     blurRadius: 20,\n//   });\n//   canvasToImg(\"drawn\", canvasDrawn);\n//   const canvasExpected = document.querySelector(\"#orig-canvas\");\n//   canvasToImg(\"expected\", canvasExpected);\n//   // console.log(canvasExpected.toDataURL())\n//   let r2 = await compareImages(\n//     canvasExpected.toDataURL(),\n//     canvasDrawn.toDataURL(),\n//     {\n//       scaleToSameSize: true,\n//       tolerance: {\n//         alpha: 100,\n//       },\n//     }\n//   );\n//   console.log(\"SIMILARITY\", r2);\n// }\n\nfunction sleep(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nfunction cloneCanvas(oldCanvas) {\n  //create a new canvas\n  var newCanvas = document.createElement(\"canvas\");\n  var context = newCanvas.getContext(\"2d\");\n\n  //set dimensions\n  newCanvas.width = oldCanvas.width;\n  newCanvas.height = oldCanvas.height;\n\n  //apply the old canvas to the new one\n  context.drawImage(oldCanvas, 0, 0);\n\n  //return the new canvas\n  return newCanvas;\n}\n\nasync function getBlurredCanvas(options) {\n  let unblurredCanvas = null;\n  if (options.svg) {\n    // Draw the SVG\n    unblurredCanvas = document.createElement(\"canvas\");\n    const ctxr = unblurredCanvas.getContext(\"2d\");\n    let vr = await Canvg.from(ctxr, options.svg);\n    vr.start();\n  } else {\n    unblurredCanvas = options.canvas;\n  }\n\n  // Convert the canvas back to a PNG to satisfy glfx.js\n  const image = document.createElement(\"img\");\n  image.src = unblurredCanvas.toDataURL(\"image/png\");\n\n  // Sometimes the image isn't loaded already so interrupt the event loop\n  await sleep(5);\n\n  // Initialize glfx.js and run the triangleBlur filter\n  const fxcanvas = fx.canvas();\n  const texture = fxcanvas.texture(image);\n  fxcanvas\n    .draw(texture)\n    .hexagonalPixelate(320, 239.5, 20)\n    .triangleBlur(options.blurRadius)\n    .update();\n  // fxcanvas.draw(texture).triangleBlur(options.blurRadius).update();\n  console.log(fxcanvas);\n\n  let clone = cloneCanvas(fxcanvas);\n  return clone;\n}\n\nfunction rng(seed) {\n  function random() {\n    let x = Math.sin(seed++) * 10000;\n    return x - Math.floor(x);\n  }\n\n  return random;\n}\n\nfunction hashString(str) {\n  var hash = 0,\n    i,\n    chr;\n  if (str.length === 0) return hash;\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i);\n    hash = (hash << 5) - hash + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n}\n\nfunction pickCountry(data) {\n  let countries = Object.keys(data);\n  // let today = new Date('8/9/23');\n  let today = new Date();\n  let todayHash = hashString(today.toDateString());\n\n  // Check the distribution\n  // let samples = {};\n  // for (const c of countries) {\n  //   samples[c] = 0;\n  // }\n  // for (let i = 0; i < 10000;i++) {\n  //   let random = rng(Math.random());\n  //   let idx = Math.floor(random() * countries.length);\n  //   samples[countries[idx]] += 1;\n  // }\n\n  let random = rng(todayHash);\n  let idx = Math.floor(random() * countries.length);\n  return countries[idx];\n}\n\nasync function rankFlags(countries) {\n  let svgs = countries.map((x) => [x, `/data/${x}/flag.svg`]);\n  const drawnFlag = document.querySelector(\"#canvas\");\n  console.log(drawnFlag);\n\n  let coros = [];\n  for (const [name, svgUrl] of svgs) {\n    coros.push(compareFlags(name, drawnFlag, svgUrl));\n  }\n  let data = await Promise.all(coros);\n  data = data.sort((a, b) => b.similarityPercent - a.similarityPercent);\n  return data;\n}\n\nclass Checker extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: \"none\",\n    };\n  }\n  render() {\n    let button = null;\n    if (this.state.status === \"checking\") {\n      button = <p>Checking...</p>;\n    } else {\n      button = (\n        <button\n          class=\"btn btn-outline btn-secondary\"\n          onClick={async () => {\n            console.log(\"Checking\");\n            this.setState({\n              status: \"checking\",\n            });\n            await checkSubmission(\n              this.props.data,\n              this.props.country,\n              this.props.countryData\n            );\n            this.setState({\n              status: \"none\",\n            });\n          }}\n        >\n          Submit\n        </button>\n      );\n    }\n    return <div>{button}</div>;\n  }\n}\n\nasync function checkSubmission(data, country, countryData) {\n  let countries = Object.keys(data);\n  const name = document.querySelector(\"#country-name\").value;\n  const capital = document.querySelector(\"#country-capital\").value;\n  if (countryData.name !== name) {\n    alert(\"wrong name\");\n  } else if (capital != countryData.capital) {\n    alert(\"wrong capital\");\n  } else {\n    let flagMatches = await rankFlags(countries);\n    console.log(flagMatches);\n    console.log(flagMatches.slice(0, 10).map((x) => x.name));\n    console.log(flagMatches.slice(0, 10).map((x) => x.name));\n    let isInTopN = flagMatches\n      .slice(0, 4)\n      .map((x) => x.name)\n      .includes(country);\n\n    let countryFlagToShow = isInTopN ? country : flagMatches[0].name;\n    if (\n      flagMatches\n        .slice(0, 4)\n        .map((x) => x.name)\n        .includes(country)\n    ) {\n      alert(\"great job!\");\n    } else {\n      alert(\"wrong flag\");\n    }\n    render(\n      <img src={`/data/${countryFlagToShow}/flag.svg`} />,\n      document.querySelector(\"#flag-target\")\n    );\n  }\n}\n\nasync function main() {\n  // // draw the svg onto a canvas\n  // let blurredOriginal = await getBlurredCanvas({\n  //   svg: `/data/Australia/flag.svg`,\n  //   blurRadius: 50,\n  // });\n  // blurredOriginal.id = \"orig-canvas\";\n  // document.body.append(blurredOriginal);\n\n  let cr = await fetch(\"/data/countries.json\");\n  let countries = await cr.json();\n  console.log(countries);\n  let r = await fetch(\"/colors.json\");\n  let content = await r.json();\n  let country = pickCountry(content);\n  // let country = \"Australia\";\n  let colors = content[country];\n\n  let img = new Image();\n  img.src = `/data/${country}/flag.svg`;\n  let height = img.height;\n  let width = img.width;\n  let scale = 300 / height;\n  console.log(scale)\n\n  render(\n    <div class=\"flex justify-center flex-col items-center\">\n      <img\n        style=\"width: 400px\"\n        class=\"noselect\"\n        src={`/data/${country}/outline.svg`}\n      />\n      <div>\n        <span class=\"mr-2\">Country Name</span>\n        <input\n          class=\"mt-2 input input-bordered input-primary w-full max-w-xs\"\n          type=\"text\"\n          id=\"country-name\"\n        />\n      </div>\n      <div>\n        <span class=\"mr-2\">Country Capital</span>\n        <input\n          class=\"mt-2 input input-bordered input-primary w-full max-w-xs\"\n          type=\"text\"\n          id=\"country-capital\"\n        />\n      </div>\n      <p>Draw the flag</p>\n      {flagDrawer({\n        width: height * scale,\n        height: width * scale,\n        colors: colors,\n      })}\n      <Checker\n        data={content}\n        country={country}\n        countryData={countries[country]}\n      />\n      <img src={`/data/${country}/flag.svg`} />\n    </div>,\n    container\n  );\n}\n\nmain();\n", "/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n", null, null, null, null, null, null, "function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\n/* eslint-disable no-bitwise -- used for calculations */\n\n/* eslint-disable unicorn/prefer-query-selector -- aiming at\n  backward-compatibility */\n\n/**\n* StackBlur - a fast almost Gaussian Blur For Canvas\n*\n* In case you find this class useful - especially in commercial projects -\n* I am not totally unhappy for a small donation to my PayPal account\n* mario@quasimondo.de\n*\n* Or support me on flattr:\n* {@link https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript}.\n*\n* @module StackBlur\n* @author Mario Klingemann\n* Contact: mario@quasimondo.com\n* Website: {@link http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html}\n* Twitter: @quasimondo\n*\n* @copyright (c) 2010 Mario Klingemann\n*\n* Permission is hereby granted, free of charge, to any person\n* obtaining a copy of this software and associated documentation\n* files (the \"Software\"), to deal in the Software without\n* restriction, including without limitation the rights to use,\n* copy, modify, merge, publish, distribute, sublicense, and/or sell\n* copies of the Software, and to permit persons to whom the\n* Software is furnished to do so, subject to the following\n* conditions:\n*\n* The above copyright notice and this permission notice shall be\n* included in all copies or substantial portions of the Software.\n*\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n* OTHER DEALINGS IN THE SOFTWARE.\n*/\nvar mulTable = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\nvar shgTable = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n/**\n * @param {string|HTMLImageElement} img\n * @param {string|HTMLCanvasElement} canvas\n * @param {Float} radius\n * @param {boolean} blurAlphaChannel\n * @param {boolean} useOffset\n * @param {boolean} skipStyles\n * @returns {undefined}\n */\n\nfunction processImage(img, canvas, radius, blurAlphaChannel, useOffset, skipStyles) {\n  if (typeof img === 'string') {\n    img = document.getElementById(img);\n  }\n\n  if (!img || !('naturalWidth' in img)) {\n    return;\n  }\n\n  var dimensionType = useOffset ? 'offset' : 'natural';\n  var w = img[dimensionType + 'Width'];\n  var h = img[dimensionType + 'Height'];\n\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || !('getContext' in canvas)) {\n    return;\n  }\n\n  if (!skipStyles) {\n    canvas.style.width = w + 'px';\n    canvas.style.height = h + 'px';\n  }\n\n  canvas.width = w;\n  canvas.height = h;\n  var context = canvas.getContext('2d');\n  context.clearRect(0, 0, w, h);\n  context.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight, 0, 0, w, h);\n\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  if (blurAlphaChannel) {\n    processCanvasRGBA(canvas, 0, 0, w, h, radius);\n  } else {\n    processCanvasRGB(canvas, 0, 0, w, h, radius);\n  }\n}\n/**\n * @param {string|HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @throws {Error|TypeError}\n * @returns {ImageData} See {@link https://html.spec.whatwg.org/multipage/canvas.html#imagedata}\n */\n\n\nfunction getImageDataFromCanvas(canvas, topX, topY, width, height) {\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || _typeof(canvas) !== 'object' || !('getContext' in canvas)) {\n    throw new TypeError('Expecting canvas with `getContext` method ' + 'in processCanvasRGB(A) calls!');\n  }\n\n  var context = canvas.getContext('2d');\n\n  try {\n    return context.getImageData(topX, topY, width, height);\n  } catch (e) {\n    throw new Error('unable to access image data: ' + e);\n  }\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGBA(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGBA(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGBA(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (var i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null,\n      stackOut = null,\n      yw = 0,\n      yi = 0;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n\n  for (var y = 0; y < height; y++) {\n    stack = stackStart;\n    var pr = pixels[yi],\n        pg = pixels[yi + 1],\n        pb = pixels[yi + 2],\n        pa = pixels[yi + 3];\n\n    for (var _i = 0; _i < radiusPlus1; _i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack.a = pa;\n      stack = stack.next;\n    }\n\n    var rInSum = 0,\n        gInSum = 0,\n        bInSum = 0,\n        aInSum = 0,\n        rOutSum = radiusPlus1 * pr,\n        gOutSum = radiusPlus1 * pg,\n        bOutSum = radiusPlus1 * pb,\n        aOutSum = radiusPlus1 * pa,\n        rSum = sumFactor * pr,\n        gSum = sumFactor * pg,\n        bSum = sumFactor * pb,\n        aSum = sumFactor * pa;\n\n    for (var _i2 = 1; _i2 < radiusPlus1; _i2++) {\n      var p = yi + ((widthMinus1 < _i2 ? widthMinus1 : _i2) << 2);\n      var r = pixels[p],\n          g = pixels[p + 1],\n          b = pixels[p + 2],\n          a = pixels[p + 3];\n      var rbs = radiusPlus1 - _i2;\n      rSum += (stack.r = r) * rbs;\n      gSum += (stack.g = g) * rbs;\n      bSum += (stack.b = b) * rbs;\n      aSum += (stack.a = a) * rbs;\n      rInSum += r;\n      gInSum += g;\n      bInSum += b;\n      aInSum += a;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var x = 0; x < width; x++) {\n      var paInitial = aSum * mulSum >> shgSum;\n      pixels[yi + 3] = paInitial;\n\n      if (paInitial !== 0) {\n        var _a2 = 255 / paInitial;\n\n        pixels[yi] = (rSum * mulSum >> shgSum) * _a2;\n        pixels[yi + 1] = (gSum * mulSum >> shgSum) * _a2;\n        pixels[yi + 2] = (bSum * mulSum >> shgSum) * _a2;\n      } else {\n        pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;\n      }\n\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      aSum -= aOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      aOutSum -= stackIn.a;\n\n      var _p = x + radius + 1;\n\n      _p = yw + (_p < widthMinus1 ? _p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[_p];\n      gInSum += stackIn.g = pixels[_p + 1];\n      bInSum += stackIn.b = pixels[_p + 2];\n      aInSum += stackIn.a = pixels[_p + 3];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      aSum += aInSum;\n      stackIn = stackIn.next;\n      var _stackOut = stackOut,\n          _r = _stackOut.r,\n          _g = _stackOut.g,\n          _b = _stackOut.b,\n          _a = _stackOut.a;\n      rOutSum += _r;\n      gOutSum += _g;\n      bOutSum += _b;\n      aOutSum += _a;\n      rInSum -= _r;\n      gInSum -= _g;\n      bInSum -= _b;\n      aInSum -= _a;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (var _x = 0; _x < width; _x++) {\n    yi = _x << 2;\n\n    var _pr = pixels[yi],\n        _pg = pixels[yi + 1],\n        _pb = pixels[yi + 2],\n        _pa = pixels[yi + 3],\n        _rOutSum = radiusPlus1 * _pr,\n        _gOutSum = radiusPlus1 * _pg,\n        _bOutSum = radiusPlus1 * _pb,\n        _aOutSum = radiusPlus1 * _pa,\n        _rSum = sumFactor * _pr,\n        _gSum = sumFactor * _pg,\n        _bSum = sumFactor * _pb,\n        _aSum = sumFactor * _pa;\n\n    stack = stackStart;\n\n    for (var _i3 = 0; _i3 < radiusPlus1; _i3++) {\n      stack.r = _pr;\n      stack.g = _pg;\n      stack.b = _pb;\n      stack.a = _pa;\n      stack = stack.next;\n    }\n\n    var yp = width;\n    var _gInSum = 0,\n        _bInSum = 0,\n        _aInSum = 0,\n        _rInSum = 0;\n\n    for (var _i4 = 1; _i4 <= radius; _i4++) {\n      yi = yp + _x << 2;\n\n      var _rbs = radiusPlus1 - _i4;\n\n      _rSum += (stack.r = _pr = pixels[yi]) * _rbs;\n      _gSum += (stack.g = _pg = pixels[yi + 1]) * _rbs;\n      _bSum += (stack.b = _pb = pixels[yi + 2]) * _rbs;\n      _aSum += (stack.a = _pa = pixels[yi + 3]) * _rbs;\n      _rInSum += _pr;\n      _gInSum += _pg;\n      _bInSum += _pb;\n      _aInSum += _pa;\n      stack = stack.next;\n\n      if (_i4 < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = _x;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var _y = 0; _y < height; _y++) {\n      var _p2 = yi << 2;\n\n      pixels[_p2 + 3] = _pa = _aSum * mulSum >> shgSum;\n\n      if (_pa > 0) {\n        _pa = 255 / _pa;\n        pixels[_p2] = (_rSum * mulSum >> shgSum) * _pa;\n        pixels[_p2 + 1] = (_gSum * mulSum >> shgSum) * _pa;\n        pixels[_p2 + 2] = (_bSum * mulSum >> shgSum) * _pa;\n      } else {\n        pixels[_p2] = pixels[_p2 + 1] = pixels[_p2 + 2] = 0;\n      }\n\n      _rSum -= _rOutSum;\n      _gSum -= _gOutSum;\n      _bSum -= _bOutSum;\n      _aSum -= _aOutSum;\n      _rOutSum -= stackIn.r;\n      _gOutSum -= stackIn.g;\n      _bOutSum -= stackIn.b;\n      _aOutSum -= stackIn.a;\n      _p2 = _x + ((_p2 = _y + radiusPlus1) < heightMinus1 ? _p2 : heightMinus1) * width << 2;\n      _rSum += _rInSum += stackIn.r = pixels[_p2];\n      _gSum += _gInSum += stackIn.g = pixels[_p2 + 1];\n      _bSum += _bInSum += stackIn.b = pixels[_p2 + 2];\n      _aSum += _aInSum += stackIn.a = pixels[_p2 + 3];\n      stackIn = stackIn.next;\n      _rOutSum += _pr = stackOut.r;\n      _gOutSum += _pg = stackOut.g;\n      _bOutSum += _pb = stackOut.b;\n      _aOutSum += _pa = stackOut.a;\n      _rInSum -= _pr;\n      _gInSum -= _pg;\n      _bInSum -= _pb;\n      _aInSum -= _pa;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGB(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGB(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGB(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (var i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null;\n  var stackOut = null;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n  var p, rbs;\n  var yw = 0,\n      yi = 0;\n\n  for (var y = 0; y < height; y++) {\n    var pr = pixels[yi],\n        pg = pixels[yi + 1],\n        pb = pixels[yi + 2],\n        rOutSum = radiusPlus1 * pr,\n        gOutSum = radiusPlus1 * pg,\n        bOutSum = radiusPlus1 * pb,\n        rSum = sumFactor * pr,\n        gSum = sumFactor * pg,\n        bSum = sumFactor * pb;\n    stack = stackStart;\n\n    for (var _i5 = 0; _i5 < radiusPlus1; _i5++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack = stack.next;\n    }\n\n    var rInSum = 0,\n        gInSum = 0,\n        bInSum = 0;\n\n    for (var _i6 = 1; _i6 < radiusPlus1; _i6++) {\n      p = yi + ((widthMinus1 < _i6 ? widthMinus1 : _i6) << 2);\n      rSum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - _i6);\n      gSum += (stack.g = pg = pixels[p + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[p + 2]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var x = 0; x < width; x++) {\n      pixels[yi] = rSum * mulSum >> shgSum;\n      pixels[yi + 1] = gSum * mulSum >> shgSum;\n      pixels[yi + 2] = bSum * mulSum >> shgSum;\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[p];\n      gInSum += stackIn.g = pixels[p + 1];\n      bInSum += stackIn.b = pixels[p + 2];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (var _x2 = 0; _x2 < width; _x2++) {\n    yi = _x2 << 2;\n\n    var _pr2 = pixels[yi],\n        _pg2 = pixels[yi + 1],\n        _pb2 = pixels[yi + 2],\n        _rOutSum2 = radiusPlus1 * _pr2,\n        _gOutSum2 = radiusPlus1 * _pg2,\n        _bOutSum2 = radiusPlus1 * _pb2,\n        _rSum2 = sumFactor * _pr2,\n        _gSum2 = sumFactor * _pg2,\n        _bSum2 = sumFactor * _pb2;\n\n    stack = stackStart;\n\n    for (var _i7 = 0; _i7 < radiusPlus1; _i7++) {\n      stack.r = _pr2;\n      stack.g = _pg2;\n      stack.b = _pb2;\n      stack = stack.next;\n    }\n\n    var _rInSum2 = 0,\n        _gInSum2 = 0,\n        _bInSum2 = 0;\n\n    for (var _i8 = 1, yp = width; _i8 <= radius; _i8++) {\n      yi = yp + _x2 << 2;\n      _rSum2 += (stack.r = _pr2 = pixels[yi]) * (rbs = radiusPlus1 - _i8);\n      _gSum2 += (stack.g = _pg2 = pixels[yi + 1]) * rbs;\n      _bSum2 += (stack.b = _pb2 = pixels[yi + 2]) * rbs;\n      _rInSum2 += _pr2;\n      _gInSum2 += _pg2;\n      _bInSum2 += _pb2;\n      stack = stack.next;\n\n      if (_i8 < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = _x2;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var _y2 = 0; _y2 < height; _y2++) {\n      p = yi << 2;\n      pixels[p] = _rSum2 * mulSum >> shgSum;\n      pixels[p + 1] = _gSum2 * mulSum >> shgSum;\n      pixels[p + 2] = _bSum2 * mulSum >> shgSum;\n      _rSum2 -= _rOutSum2;\n      _gSum2 -= _gOutSum2;\n      _bSum2 -= _bOutSum2;\n      _rOutSum2 -= stackIn.r;\n      _gOutSum2 -= stackIn.g;\n      _bOutSum2 -= stackIn.b;\n      p = _x2 + ((p = _y2 + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;\n      _rSum2 += _rInSum2 += stackIn.r = pixels[p];\n      _gSum2 += _gInSum2 += stackIn.g = pixels[p + 1];\n      _bSum2 += _bInSum2 += stackIn.b = pixels[p + 2];\n      stackIn = stackIn.next;\n      _rOutSum2 += _pr2 = stackOut.r;\n      _gOutSum2 += _pg2 = stackOut.g;\n      _bOutSum2 += _pb2 = stackOut.b;\n      _rInSum2 -= _pr2;\n      _gInSum2 -= _pg2;\n      _bInSum2 -= _pb2;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n *\n */\n\n\nvar BlurStack =\n/**\n * Set properties.\n */\nfunction BlurStack() {\n  _classCallCheck(this, BlurStack);\n\n  this.r = 0;\n  this.g = 0;\n  this.b = 0;\n  this.a = 0;\n  this.next = null;\n};\n\nexport { BlurStack, processCanvasRGB as canvasRGB, processCanvasRGBA as canvasRGBA, processImage as image, processImageDataRGB as imageDataRGB, processImageDataRGBA as imageDataRGBA };\n", "import { DOMParser } from './types'\n\ninterface IConfig {\n  /**\n   * XML/HTML parser from string into DOM Document.\n   */\n  DOMParser?: DOMParser\n}\n\n/**\n * Options preset for `OffscreenCanvas`.\n * @param config - Preset requirements.\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\n * @returns Preset object.\n */\nexport function offscreen({ DOMParser: DOMParserFallback }: IConfig = {}) {\n  const preset = {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser: DOMParserFallback,\n    createCanvas(width: number, height: number) {\n      return new OffscreenCanvas(width, height)\n    },\n    async createImage(url: string) {\n      const response = await fetch(url)\n      const blob = await response.blob()\n      const img = await createImageBitmap(blob)\n\n      return img\n    }\n  }\n\n  if (typeof globalThis.DOMParser !== 'undefined'\n    || typeof DOMParserFallback === 'undefined'\n  ) {\n    Reflect.deleteProperty(preset, 'DOMParser')\n  }\n\n  return preset\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { DOMParser } from './types'\n\n/**\n * `node-canvas` exports.\n */\ninterface ICanvas {\n  createCanvas(width: number, height: number): any\n  loadImage(src: string): Promise<any>\n}\n\n/**\n * WHATWG-compatible `fetch` function.\n */\ntype Fetch = (input: any, config?: any) => Promise<any>\n\ninterface IConfig {\n  /**\n   * XML/HTML parser from string into DOM Document.\n   */\n  DOMParser: DOMParser\n  /**\n   * `node-canvas` exports.\n   */\n  canvas: ICanvas\n  /**\n   * WHATWG-compatible `fetch` function.\n   */\n  fetch: Fetch\n}\n\n/**\n * Options preset for `node-canvas`.\n * @param config - Preset requirements.\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\n * @param config.canvas - `node-canvas` exports.\n * @param config.fetch - WHATWG-compatible `fetch` function.\n * @returns Preset object.\n */\nexport function node({\n  DOMParser,\n  canvas,\n  fetch\n}: IConfig) {\n  return {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser,\n    fetch,\n    createCanvas: canvas.createCanvas,\n    createImage: canvas.loadImage\n  }\n}\n", "import { MatrixValue } from '../types'\n\n/**\n * HTML-safe compress white-spaces.\n * @param str - String to compress.\n * @returns String.\n */\nexport function compressSpaces(str: string) {\n  return str.replace(/(?!\\u3000)\\s+/gm, ' ')\n}\n\n/**\n * HTML-safe left trim.\n * @param str - String to trim.\n * @returns String.\n */\nexport function trimLeft(str: string) {\n  return str.replace(/^[\\n \\t]+/, '')\n}\n\n/**\n * HTML-safe right trim.\n * @param str - String to trim.\n * @returns String.\n */\nexport function trimRight(str: string) {\n  return str.replace(/[\\n \\t]+$/, '')\n}\n\n/**\n * String to numbers array.\n * @param str - Numbers string.\n * @returns Numbers array.\n */\nexport function toNumbers(str: string) {\n  const matches = str.match(/-?(\\d+(?:\\.\\d*(?:[eE][+-]?\\d+)?)?|\\.\\d+)(?=\\D|$)/gm)\n\n  return matches ? matches.map(parseFloat) : []\n}\n\n/**\n * String to matrix value.\n * @param str - Numbers string.\n * @returns Matrix value.\n */\nexport function toMatrixValue(str: string): MatrixValue {\n  const numbers = toNumbers(str)\n  const matrix = [\n    numbers[0] || 0,\n    numbers[1] || 0,\n    numbers[2] || 0,\n    numbers[3] || 0,\n    numbers[4] || 0,\n    numbers[5] || 0\n  ] as const\n\n  return matrix\n}\n\n// Microsoft Edge fix\nconst allUppercase = /^[A-Z-]+$/\n\n/**\n * Normalize attribute name.\n * @param name - Attribute name.\n * @returns Normalized attribute name.\n */\nexport function normalizeAttributeName(name: string) {\n  if (allUppercase.test(name)) {\n    return name.toLowerCase()\n  }\n\n  return name\n}\n\n/**\n * Parse external URL.\n * @param url - CSS url string.\n * @returns Parsed URL.\n */\nexport function parseExternalUrl(url: string): string {\n  //                      single quotes [2]\n  //                      v         double quotes [3]\n  //                      v         v         no quotes [4]\n  //                      v         v         v\n  const urlMatch = /url\\(('([^']+)'|\"([^\"]+)\"|([^'\")]+))\\)/.exec(url)\n\n  if (!urlMatch) {\n    return ''\n  }\n\n  return urlMatch[2] || urlMatch[3] || urlMatch[4] || ''\n}\n\n/**\n * Transform floats to integers in rgb colors.\n * @param color - Color to normalize.\n * @returns Normalized color.\n */\nexport function normalizeColor(color: string) {\n  if (!color.startsWith('rgb')) {\n    return color\n  }\n\n  let rgbParts = 3\n  const normalizedColor = color.replace(\n    /\\d+(\\.\\d+)?/g,\n    (num, isFloat) => (rgbParts-- && isFloat\n      ? String(Math.round(parseFloat(num)))\n      : num)\n  )\n\n  return normalizedColor\n}\n", "\n// slightly modified version of https://github.com/keeganstreet/specificity/blob/master/specificity.js\nconst attributeRegex = /(\\[[^\\]]+\\])/g\nconst idRegex = /(#[^\\s+>~.[:]+)/g\nconst classRegex = /(\\.[^\\s+>~.[:]+)/g\nconst pseudoElementRegex = /(::[^\\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi\nconst pseudoClassWithBracketsRegex = /(:[\\w-]+\\([^)]*\\))/gi\nconst pseudoClassRegex = /(:[^\\s+>~.[:]+)/g\nconst elementRegex = /([^\\s+>~.[:]+)/g\n\nfunction findSelectorMatch(selector: string, regex: RegExp): [string, number] {\n  const matches = regex.exec(selector)\n\n  if (!matches) {\n    return [selector, 0]\n  }\n\n  return [selector.replace(regex, ' '), matches.length]\n}\n\n/**\n * Measure selector specificity.\n * @param selector - Selector to measure.\n * @returns Specificity.\n */\nexport function getSelectorSpecificity(selector: string) {\n  const specificity = [\n    0,\n    0,\n    0\n  ]\n  let currentSelector = selector\n    .replace(/:not\\(([^)]*)\\)/g, '     $1 ')\n    .replace(/{[\\s\\S]*/gm, ' ')\n  let delta = 0;\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, attributeRegex)\n  specificity[1] += delta;\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, idRegex)\n  specificity[0] += delta;\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, classRegex)\n  specificity[1] += delta;\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, pseudoElementRegex)\n  specificity[2] += delta;\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, pseudoClassWithBracketsRegex)\n  specificity[1] += delta;\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, pseudoClassRegex)\n  specificity[1] += delta\n\n  currentSelector = currentSelector\n    .replace(/[*\\s+>~]/g, ' ')\n    .replace(/[#.]/g, ' ');\n\n  [currentSelector, delta] = findSelectorMatch(currentSelector, elementRegex) // lgtm [js/useless-assignment-to-local]\n  specificity[2] += delta\n\n  return specificity.join('')\n}\n", "import { VectorValue } from '../types'\n\nexport const PSEUDO_ZERO = .00000001\n\n/**\n * Vector magnitude.\n * @param v\n * @returns Number result.\n */\nexport function vectorMagnitude(v: VectorValue) {\n  return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2))\n}\n\n/**\n * Ratio between two vectors.\n * @param u\n * @param v\n * @returns Number result.\n */\nexport function vectorsRatio(u: VectorValue, v: VectorValue) {\n  return (u[0] * v[0] + u[1] * v[1]) / (vectorMagnitude(u) * vectorMagnitude(v))\n}\n\n/**\n * Angle between two vectors.\n * @param u\n * @param v\n * @returns Number result.\n */\nexport function vectorsAngle(u: VectorValue, v: VectorValue) {\n  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vectorsRatio(u, v))\n}\n\nexport function CB1(t: number) {\n  return t * t * t\n}\n\nexport function CB2(t: number) {\n  return 3 * t * t * (1 - t)\n}\n\nexport function CB3(t: number) {\n  return 3 * t * (1 - t) * (1 - t)\n}\n\nexport function CB4(t: number) {\n  return (1 - t) * (1 - t) * (1 - t)\n}\n\nexport function QB1(t: number) {\n  return t * t\n}\n\nexport function QB2(t: number) {\n  return 2 * t * (1 - t)\n}\n\nexport function QB3(t: number) {\n  return (1 - t) * (1 - t)\n}\n", "import RGBColor from 'rgbcolor'\nimport {\n  compressSpaces,\n  normalizeColor\n} from './util'\nimport { Axis } from './ViewPort'\nimport {\n  Document,\n  Element,\n  PathElement,\n  PatternElement,\n  GradientElement\n} from './Document'\n\nexport class Property<T = unknown> {\n  static empty(document: Document) {\n    return new Property(document, 'EMPTY', '')\n  }\n\n  static readonly textBaselineMapping: Record<string, string> = {\n    'baseline': 'alphabetic',\n    'before-edge': 'top',\n    'text-before-edge': 'top',\n    'middle': 'middle',\n    'central': 'middle',\n    'after-edge': 'bottom',\n    'text-after-edge': 'bottom',\n    'ideographic': 'ideographic',\n    'alphabetic': 'alphabetic',\n    'hanging': 'hanging',\n    'mathematical': 'alphabetic'\n  }\n\n  private isNormalizedColor = false\n\n  constructor(\n    private readonly document: Document,\n    private readonly name: string,\n    private value: T\n  ) {}\n\n  split(separator = ' ') {\n    const {\n      document,\n      name\n    } = this\n\n    return compressSpaces(this.getString())\n      .trim()\n      .split(separator)\n      .map(value => new Property<string>(document, name, value))\n  }\n\n  hasValue(zeroIsValue?: boolean) {\n    const value = this.value as unknown\n\n    return value !== null\n      && value !== ''\n      && (zeroIsValue || value !== 0)\n      && typeof value !== 'undefined'\n  }\n\n  isString(regexp?: RegExp) {\n    const { value } = this\n    const result = typeof value === 'string'\n\n    if (!result || !regexp) {\n      return result\n    }\n\n    return regexp.test(value)\n  }\n\n  isUrlDefinition() {\n    return this.isString(/^url\\(/)\n  }\n\n  isPixels() {\n    if (!this.hasValue()) {\n      return false\n    }\n\n    const asString = this.getString()\n\n    switch (true) {\n      case asString.endsWith('px'):\n      case /^[0-9]+$/.test(asString):\n        return true\n\n      default:\n        return false\n    }\n  }\n\n  setValue(value: T) {\n    this.value = value\n    return this\n  }\n\n  getValue(def?: T) {\n    if (typeof def === 'undefined' || this.hasValue()) {\n      return this.value\n    }\n\n    return def\n  }\n\n  getNumber(def?: T) {\n    if (!this.hasValue()) {\n      if (typeof def === 'undefined') {\n        return 0\n      }\n\n      // @ts-expect-error Parse unknown value.\n      return parseFloat(def)\n    }\n\n    const { value } = this\n    // @ts-expect-error Parse unknown value.\n    let n = parseFloat(value)\n\n    if (this.isString(/%$/)) {\n      n /= 100.0\n    }\n\n    return n\n  }\n\n  getString(def?: T) {\n    if (typeof def === 'undefined' || this.hasValue()) {\n      return typeof this.value === 'undefined'\n        ? ''\n        : String(this.value)\n    }\n\n    return String(def)\n  }\n\n  getColor(def?: T) {\n    let color = this.getString(def)\n\n    if (this.isNormalizedColor) {\n      return color\n    }\n\n    this.isNormalizedColor = true\n    color = normalizeColor(color)\n    this.value = color as unknown as T\n\n    return color\n  }\n\n  getDpi() {\n    return 96.0 // TODO: compute?\n  }\n\n  getRem() {\n    return this.document.rootEmSize\n  }\n\n  getEm() {\n    return this.document.emSize\n  }\n\n  getUnits() {\n    return this.getString().replace(/[0-9.-]/g, '')\n  }\n\n  getPixels(axis?: Axis, processPercent?: boolean): number\n  getPixels(isFontSize?: boolean): number\n  getPixels(axisOrIsFontSize?: Axis | boolean, processPercent = false): number {\n    if (!this.hasValue()) {\n      return 0\n    }\n\n    const [axis, isFontSize] = typeof axisOrIsFontSize === 'boolean'\n      ? [undefined, axisOrIsFontSize]\n      : [axisOrIsFontSize]\n    const { viewPort } = this.document.screen\n\n    switch (true) {\n      case this.isString(/vmin$/):\n        return this.getNumber()\n          / 100.0\n          * Math.min(\n            viewPort.computeSize('x'),\n            viewPort.computeSize('y')\n          )\n\n      case this.isString(/vmax$/):\n        return this.getNumber()\n          / 100.0\n          * Math.max(\n            viewPort.computeSize('x'),\n            viewPort.computeSize('y')\n          )\n\n      case this.isString(/vw$/):\n        return this.getNumber()\n          / 100.0\n          * viewPort.computeSize('x')\n\n      case this.isString(/vh$/):\n        return this.getNumber()\n          / 100.0\n          * viewPort.computeSize('y')\n\n      case this.isString(/rem$/):\n        return this.getNumber() * this.getRem(/* viewPort */)\n\n      case this.isString(/em$/):\n        return this.getNumber() * this.getEm(/* viewPort */)\n\n      case this.isString(/ex$/):\n        return this.getNumber() * this.getEm(/* viewPort */) / 2.0\n\n      case this.isString(/px$/):\n        return this.getNumber()\n\n      case this.isString(/pt$/):\n        return this.getNumber() * this.getDpi(/* viewPort */) * (1.0 / 72.0)\n\n      case this.isString(/pc$/):\n        return this.getNumber() * 15\n\n      case this.isString(/cm$/):\n        return this.getNumber() * this.getDpi(/* viewPort */) / 2.54\n\n      case this.isString(/mm$/):\n        return this.getNumber() * this.getDpi(/* viewPort */) / 25.4\n\n      case this.isString(/in$/):\n        return this.getNumber() * this.getDpi(/* viewPort */)\n\n      case this.isString(/%$/) && isFontSize:\n        return this.getNumber() * this.getEm(/* viewPort */)\n\n      case this.isString(/%$/):\n        return this.getNumber() * viewPort.computeSize(axis)\n\n      default: {\n        const n = this.getNumber()\n\n        if (processPercent && n < 1.0) {\n          return n * viewPort.computeSize(axis)\n        }\n\n        return n\n      }\n    }\n  }\n\n  getMilliseconds() {\n    if (!this.hasValue()) {\n      return 0\n    }\n\n    if (this.isString(/ms$/)) {\n      return this.getNumber()\n    }\n\n    return this.getNumber() * 1000\n  }\n\n  getRadians() {\n    if (!this.hasValue()) {\n      return 0\n    }\n\n    switch (true) {\n      case this.isString(/deg$/):\n        return this.getNumber() * (Math.PI / 180.0)\n\n      case this.isString(/grad$/):\n        return this.getNumber() * (Math.PI / 200.0)\n\n      case this.isString(/rad$/):\n        return this.getNumber()\n\n      default:\n        return this.getNumber() * (Math.PI / 180.0)\n    }\n  }\n\n  getDefinition<T extends Element>() {\n    const asString = this.getString()\n    const match = /#([^)'\"]+)/.exec(asString)\n    const name = match?.[1] || asString\n\n    return this.document.definitions[name] as T | undefined\n  }\n\n  getFillStyleDefinition(element: Element | PathElement, opacity: Property) {\n    let def = this.getDefinition<PatternElement & GradientElement>()\n\n    if (!def) {\n      return null\n    }\n\n    // gradient\n    if (typeof def.createGradient === 'function' && 'getBoundingBox' in element) {\n      return def.createGradient(\n        this.document.ctx,\n        element,\n        opacity\n      )\n    }\n\n    // pattern\n    if (typeof def.createPattern === 'function') {\n      if (def.getHrefAttribute().hasValue()) {\n        const patternTransform = def.getAttribute('patternTransform')\n\n        def = def.getHrefAttribute().getDefinition()\n\n        if (def && patternTransform.hasValue()) {\n          def.getAttribute('patternTransform', true).setValue(patternTransform.value)\n        }\n      }\n\n      if (def) {\n        return def.createPattern(this.document.ctx, element, opacity)\n      }\n    }\n\n    return null\n  }\n\n  getTextBaseline() {\n    if (!this.hasValue()) {\n      return null\n    }\n\n    const key = this.getString()\n\n    return Property.textBaselineMapping[key] || null\n  }\n\n  addOpacity(opacity: Property) {\n    let value = this.getColor()\n    const len = value.length\n    let commas = 0\n\n    // Simulate old RGBColor version, which can't parse rgba.\n    for (let i = 0; i < len; i++) {\n      if (value[i] === ',') {\n        commas++\n      }\n\n      if (commas === 3) {\n        break\n      }\n    }\n\n    if (opacity.hasValue() && this.isString() && commas !== 3) {\n      const color = new RGBColor(value)\n\n      if (color.ok) {\n        color.alpha = opacity.getNumber()\n        value = color.toRGBA()\n      }\n    }\n\n    return new Property<string>(this.document, this.name, value)\n  }\n}\n", "\nexport interface IViewPortSize {\n  width: number\n  height: number\n}\n\nexport type Axis = 'x' | 'y'\n\nexport class ViewPort {\n  static DEFAULT_VIEWPORT_WIDTH = 800\n  static DEFAULT_VIEWPORT_HEIGHT = 600\n\n  viewPorts: IViewPortSize[] = []\n\n  clear() {\n    this.viewPorts = []\n  }\n\n  setCurrent(width: number, height: number) {\n    this.viewPorts.push({\n      width,\n      height\n    })\n  }\n\n  removeCurrent() {\n    this.viewPorts.pop()\n  }\n\n  getRoot() {\n    const [root] = this.viewPorts\n\n    if (!root) {\n      return getDefault()\n    }\n\n    return root\n  }\n\n  getCurrent() {\n    const { viewPorts } = this\n    const current = viewPorts[viewPorts.length - 1]\n\n    if (!current) {\n      return getDefault()\n    }\n\n    return current\n  }\n\n  get width() {\n    return this.getCurrent().width\n  }\n\n  get height() {\n    return this.getCurrent().height\n  }\n\n  computeSize(d?: number|Axis) {\n    if (typeof d === 'number') {\n      return d\n    }\n\n    if (d === 'x') {\n      return this.width\n    }\n\n    if (d === 'y') {\n      return this.height\n    }\n\n    return Math.sqrt(\n      Math.pow(this.width, 2) + Math.pow(this.height, 2)\n    ) / Math.sqrt(2)\n  }\n}\n\nfunction getDefault() {\n  return {\n    width: ViewPort.DEFAULT_VIEWPORT_WIDTH,\n    height: ViewPort.DEFAULT_VIEWPORT_HEIGHT\n  }\n}\n", "import { MatrixValue } from './types'\nimport { toNumbers } from './util'\n\nexport class Point {\n  static parse(point: string, defaultValue = 0) {\n    const [x = defaultValue, y = defaultValue] = toNumbers(point)\n\n    return new Point(x, y)\n  }\n\n  static parseScale(scale: string, defaultValue = 1) {\n    const [x = defaultValue, y = x] = toNumbers(scale)\n\n    return new Point(x, y)\n  }\n\n  static parsePath(path: string) {\n    const points = toNumbers(path)\n    const len = points.length\n    const pathPoints: Point[] = []\n\n    for (let i = 0; i < len; i += 2) {\n      pathPoints.push(new Point(points[i], points[i + 1]))\n    }\n\n    return pathPoints\n  }\n\n  constructor(\n    public x: number,\n    public y: number\n  ) {}\n\n  angleTo(point: Point) {\n    return Math.atan2(point.y - this.y, point.x - this.x)\n  }\n\n  applyTransform(transform: MatrixValue) {\n    const {\n      x,\n      y\n    } = this\n    const xp = x * transform[0] + y * transform[2] + transform[4]\n    const yp = x * transform[1] + y * transform[3] + transform[5]\n\n    this.x = xp\n    this.y = yp\n  }\n}\n", "import { RenderingContext2D } from './types'\nimport { BoundingBox } from './BoundingBox'\nimport { Point } from './Point'\nimport { Screen } from './Screen'\nimport { Element } from './Document'\n\ninterface IEventTarget {\n  onClick?(): void\n  onMouseMove?(): void\n}\n\nexport interface IEvent {\n  type: string\n  x: number\n  y: number\n  run(eventTarget: IEventTarget): void\n}\n\nexport class Mouse {\n  private working = false\n  private events: IEvent[] = []\n  private eventElements: Element[] = []\n\n  constructor(\n    private readonly screen: Screen\n  ) {\n    this.onClick = this.onClick.bind(this)\n    this.onMouseMove = this.onMouseMove.bind(this)\n  }\n\n  isWorking() {\n    return this.working\n  }\n\n  start() {\n    if (this.working) {\n      return\n    }\n\n    const {\n      screen,\n      onClick,\n      onMouseMove\n    } = this\n    const canvas = screen.ctx.canvas as HTMLCanvasElement\n\n    canvas.onclick = onClick\n    canvas.onmousemove = onMouseMove\n    this.working = true\n  }\n\n  stop() {\n    if (!this.working) {\n      return\n    }\n\n    const canvas = this.screen.ctx.canvas as HTMLCanvasElement\n\n    this.working = false\n    canvas.onclick = null\n    canvas.onmousemove = null\n  }\n\n  hasEvents() {\n    return this.working && this.events.length > 0\n  }\n\n  runEvents() {\n    if (!this.working) {\n      return\n    }\n\n    const {\n      screen: document,\n      events,\n      eventElements\n    } = this\n    const { style } = document.ctx.canvas as HTMLCanvasElement\n    let element: Element | null | undefined\n\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (style) {\n      style.cursor = ''\n    }\n\n    events.forEach(({ run }, i) => {\n      element = eventElements[i]\n\n      while (element) {\n        run(element as IEventTarget)\n        element = element.parent\n      }\n    })\n\n    // done running, clear\n    this.events = []\n    this.eventElements = []\n  }\n\n  checkPath(element: Element, ctx: RenderingContext2D | null) {\n    if (!this.working || !ctx) {\n      return\n    }\n\n    const {\n      events,\n      eventElements\n    } = this\n\n    events.forEach(({ x, y }, i) => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!eventElements[i] && ctx.isPointInPath && ctx.isPointInPath(x, y)) {\n        eventElements[i] = element\n      }\n    })\n  }\n\n  checkBoundingBox(element: Element, boundingBox: BoundingBox | null) {\n    if (!this.working || !boundingBox) {\n      return\n    }\n\n    const {\n      events,\n      eventElements\n    } = this\n\n    events.forEach(({ x, y }, i) => {\n      if (!eventElements[i] && boundingBox.isPointInBox(x, y)) {\n        eventElements[i] = element\n      }\n    })\n  }\n\n  private mapXY(x: number, y: number) {\n    const {\n      window,\n      ctx\n    } = this.screen\n    const point = new Point(x, y)\n    let element = ctx.canvas as HTMLElement | null\n\n    while (element) {\n      point.x -= element.offsetLeft\n      point.y -= element.offsetTop\n      element = element.offsetParent as HTMLElement | null\n    }\n\n    if (window?.scrollX) {\n      point.x += window.scrollX\n    }\n\n    if (window?.scrollY) {\n      point.y += window.scrollY\n    }\n\n    return point\n  }\n\n  private onClick(event: MouseEvent) {\n    const {\n      x,\n      y\n    } = this.mapXY(\n      event.clientX,\n      event.clientY\n    )\n\n    this.events.push({\n      type: 'onclick',\n      x,\n      y,\n      run(eventTarget) {\n        if (eventTarget.onClick) {\n          eventTarget.onClick()\n        }\n      }\n    })\n  }\n\n  private onMouseMove(event: MouseEvent) {\n    const {\n      x,\n      y\n    } = this.mapXY(\n      event.clientX,\n      event.clientY\n    )\n\n    this.events.push({\n      type: 'onmousemove',\n      x,\n      y,\n      run(eventTarget) {\n        if (eventTarget.onMouseMove) {\n          eventTarget.onMouseMove()\n        }\n      }\n    })\n  }\n}\n", "import requestAnimationFrame from 'raf'\nimport {\n  RenderingContext2D,\n  Fetch\n} from './types'\nimport {\n  compressSpaces,\n  toNumbers\n} from './util'\nimport { Property } from './Property'\nimport { ViewPort } from './ViewPort'\nimport { Mouse } from './Mouse'\nimport {\n  Document,\n  Element,\n  AnimateElement\n} from './Document'\n\nexport interface IScreenOptions {\n  /**\n   * Window object.\n   */\n  window?: Window | null\n  /**\n   * WHATWG-compatible `fetch` function.\n   */\n  fetch?: Fetch\n}\n\nexport interface IScreenStartOptions {\n  /**\n   * Whether enable the redraw.\n   */\n  enableRedraw?: boolean\n  /**\n   * Ignore mouse events.\n   */\n  ignoreMouse?: boolean\n  /**\n   * Ignore animations.\n   */\n  ignoreAnimation?: boolean\n  /**\n   * Does not try to resize canvas.\n   */\n  ignoreDimensions?: boolean\n  /**\n   * Does not clear canvas.\n   */\n  ignoreClear?: boolean\n  /**\n   * Scales horizontally to width.\n   */\n  scaleWidth?: number\n  /**\n   * Scales vertically to height.\n   */\n  scaleHeight?: number\n  /**\n   * Draws at a x offset.\n   */\n  offsetX?: number\n  /**\n   * Draws at a y offset.\n   */\n  offsetY?: number\n  /**\n   * Will call the function on every frame, if it returns true, will redraw.\n   */\n  forceRedraw?(): boolean\n}\n\nexport interface IScreenViewBoxConfig {\n  document: Document\n  ctx: RenderingContext2D\n  aspectRatio: string\n  width: number\n  desiredWidth: number\n  height: number\n  desiredHeight: number\n  minX?: number\n  minY?: number\n  refX?: number\n  refY?: number\n  clip?: boolean\n  clipX?: number\n  clipY?: number\n}\n\nconst defaultWindow = typeof window !== 'undefined'\n  ? window\n  : null\nconst defaultFetch = typeof fetch !== 'undefined'\n  ? fetch.bind(undefined) // `fetch` depends on context: `someObject.fetch(...)` will throw error.\n  : undefined\n\nexport class Screen {\n  static readonly defaultWindow = defaultWindow\n  static readonly defaultFetch = defaultFetch\n  static FRAMERATE = 30\n  static MAX_VIRTUAL_PIXELS = 30000\n\n  readonly window: Window | null\n  readonly fetch: Fetch\n  readonly viewPort = new ViewPort()\n  readonly mouse = new Mouse(this)\n  readonly animations: AnimateElement[] = []\n  private readyPromise: Promise<void> | undefined\n  private resolveReady: (() => void) | undefined\n  private waits: (() => boolean)[] = []\n  private frameDuration = 0\n  private isReadyLock = false\n  private isFirstRender = true\n  private intervalId: number | null = null\n\n  constructor(\n    readonly ctx: RenderingContext2D,\n    {\n      fetch = defaultFetch,\n      window = defaultWindow\n    }: IScreenOptions = {}\n  ) {\n    this.window = window\n\n    if (!fetch) {\n      throw new Error(`Can't find 'fetch' in 'globalThis', please provide it via options`)\n    }\n\n    this.fetch = fetch\n  }\n\n  wait(checker: () => boolean) {\n    this.waits.push(checker)\n  }\n\n  ready() {\n    // eslint-disable-next-line @typescript-eslint/no-misused-promises\n    if (!this.readyPromise) {\n      return Promise.resolve()\n    }\n\n    return this.readyPromise\n  }\n\n  isReady() {\n    if (this.isReadyLock) {\n      return true\n    }\n\n    const isReadyLock = this.waits.every(_ => _())\n\n    if (isReadyLock) {\n      this.waits = []\n\n      if (this.resolveReady) {\n        this.resolveReady()\n      }\n    }\n\n    this.isReadyLock = isReadyLock\n\n    return isReadyLock\n  }\n\n  setDefaults(ctx: RenderingContext2D) {\n    // initial values and defaults\n    ctx.strokeStyle = 'rgba(0,0,0,0)'\n    ctx.lineCap = 'butt'\n    ctx.lineJoin = 'miter'\n    ctx.miterLimit = 4\n  }\n\n  setViewBox({\n    document,\n    ctx,\n    aspectRatio,\n    width,\n    desiredWidth,\n    height,\n    desiredHeight,\n    minX = 0,\n    minY = 0,\n    refX,\n    refY,\n    clip = false,\n    clipX = 0,\n    clipY = 0\n  }: IScreenViewBoxConfig) {\n    // aspect ratio - http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\n    const cleanAspectRatio = compressSpaces(aspectRatio).replace(/^defer\\s/, '') // ignore defer\n    const [aspectRatioAlign, aspectRatioMeetOrSlice] = cleanAspectRatio.split(' ')\n    const align = aspectRatioAlign || 'xMidYMid'\n    const meetOrSlice = aspectRatioMeetOrSlice || 'meet'\n    // calculate scale\n    const scaleX = width / desiredWidth\n    const scaleY = height / desiredHeight\n    const scaleMin = Math.min(scaleX, scaleY)\n    const scaleMax = Math.max(scaleX, scaleY)\n    let finalDesiredWidth = desiredWidth\n    let finalDesiredHeight = desiredHeight\n\n    if (meetOrSlice === 'meet') {\n      finalDesiredWidth *= scaleMin\n      finalDesiredHeight *= scaleMin\n    }\n\n    if (meetOrSlice === 'slice') {\n      finalDesiredWidth *= scaleMax\n      finalDesiredHeight *= scaleMax\n    }\n\n    const refXProp = new Property(document, 'refX', refX)\n    const refYProp = new Property(document, 'refY', refY)\n    const hasRefs = refXProp.hasValue() && refYProp.hasValue()\n\n    if (hasRefs) {\n      ctx.translate(\n        -scaleMin * refXProp.getPixels('x'),\n        -scaleMin * refYProp.getPixels('y')\n      )\n    }\n\n    if (clip) {\n      const scaledClipX = scaleMin * clipX\n      const scaledClipY = scaleMin * clipY\n\n      ctx.beginPath()\n      ctx.moveTo(scaledClipX, scaledClipY)\n      ctx.lineTo(width, scaledClipY)\n      ctx.lineTo(width, height)\n      ctx.lineTo(scaledClipX, height)\n      ctx.closePath()\n      ctx.clip()\n    }\n\n    if (!hasRefs) {\n      const isMeetMinY = meetOrSlice === 'meet' && scaleMin === scaleY\n      const isSliceMaxY = meetOrSlice === 'slice' && scaleMax === scaleY\n      const isMeetMinX = meetOrSlice === 'meet' && scaleMin === scaleX\n      const isSliceMaxX = meetOrSlice === 'slice' && scaleMax === scaleX\n\n      if (align.startsWith('xMid') && (\n        isMeetMinY || isSliceMaxY\n      )) {\n        ctx.translate(width / 2.0 - finalDesiredWidth / 2.0, 0)\n      }\n\n      if (align.endsWith('YMid') && (\n        isMeetMinX || isSliceMaxX\n      )) {\n        ctx.translate(0, height / 2.0 - finalDesiredHeight / 2.0)\n      }\n\n      if (align.startsWith('xMax') && (\n        isMeetMinY || isSliceMaxY\n      )) {\n        ctx.translate(width - finalDesiredWidth, 0)\n      }\n\n      if (align.endsWith('YMax') && (\n        isMeetMinX || isSliceMaxX\n      )) {\n        ctx.translate(0, height - finalDesiredHeight)\n      }\n    }\n\n    // scale\n    switch (true) {\n      case align === 'none':\n        ctx.scale(scaleX, scaleY)\n        break\n\n      case meetOrSlice === 'meet':\n        ctx.scale(scaleMin, scaleMin)\n        break\n\n      case meetOrSlice === 'slice':\n        ctx.scale(scaleMax, scaleMax)\n        break\n    }\n\n    // translate\n    ctx.translate(-minX, -minY)\n  }\n\n  start(\n    element: Element,\n    {\n      enableRedraw = false,\n      ignoreMouse = false,\n      ignoreAnimation = false,\n      ignoreDimensions = false,\n      ignoreClear = false,\n      forceRedraw,\n      scaleWidth,\n      scaleHeight,\n      offsetX,\n      offsetY\n    }: IScreenStartOptions = {}\n  ) {\n    const { mouse } = this\n    const frameDuration = 1000 / Screen.FRAMERATE\n\n    this.isReadyLock = false\n    this.frameDuration = frameDuration\n    this.readyPromise = new Promise((resolve) => {\n      this.resolveReady = resolve\n    })\n\n    if (this.isReady()) {\n      this.render(\n        element,\n        ignoreDimensions,\n        ignoreClear,\n        scaleWidth,\n        scaleHeight,\n        offsetX,\n        offsetY\n      )\n    }\n\n    if (!enableRedraw) {\n      return\n    }\n\n    let now = Date.now()\n    let then = now\n    let delta = 0\n    const tick = () => {\n      now = Date.now()\n      delta = now - then\n\n      if (delta >= frameDuration) {\n        then = now - (delta % frameDuration)\n\n        if (this.shouldUpdate(\n          ignoreAnimation,\n          forceRedraw\n        )) {\n          this.render(\n            element,\n            ignoreDimensions,\n            ignoreClear,\n            scaleWidth,\n            scaleHeight,\n            offsetX,\n            offsetY\n          )\n          mouse.runEvents()\n        }\n      }\n\n      this.intervalId = requestAnimationFrame(tick)\n    }\n\n    if (!ignoreMouse) {\n      mouse.start()\n    }\n\n    this.intervalId = requestAnimationFrame(tick)\n  }\n\n  stop() {\n    if (this.intervalId) {\n      requestAnimationFrame.cancel(this.intervalId)\n      this.intervalId = null\n    }\n\n    this.mouse.stop()\n  }\n\n  private shouldUpdate(\n    ignoreAnimation: boolean,\n    forceRedraw: (() => boolean) | undefined\n  ) {\n    // need update from animations?\n    if (!ignoreAnimation) {\n      const { frameDuration } = this\n      const shouldUpdate = this.animations.reduce(\n        (shouldUpdate, animation) => animation.update(frameDuration) || shouldUpdate,\n        false\n      )\n\n      if (shouldUpdate) {\n        return true\n      }\n    }\n\n    // need update from redraw?\n    if (typeof forceRedraw === 'function' && forceRedraw()) {\n      return true\n    }\n\n    if (!this.isReadyLock && this.isReady()) {\n      return true\n    }\n\n    // need update from mouse events?\n    if (this.mouse.hasEvents()) {\n      return true\n    }\n\n    return false\n  }\n\n  private render(\n    element: Element,\n    ignoreDimensions: boolean,\n    ignoreClear: boolean,\n    scaleWidth: number | undefined,\n    scaleHeight: number | undefined,\n    offsetX: number | undefined,\n    offsetY: number | undefined\n  ) {\n    const {\n      viewPort,\n      ctx,\n      isFirstRender\n    } = this\n    const canvas = ctx.canvas as HTMLCanvasElement\n\n    viewPort.clear()\n\n    if (canvas.width && canvas.height) {\n      viewPort.setCurrent(canvas.width, canvas.height)\n    }\n\n    const widthStyle = element.getStyle('width')\n    const heightStyle = element.getStyle('height')\n\n    if (!ignoreDimensions && (\n      isFirstRender\n      || typeof scaleWidth !== 'number' && typeof scaleHeight !== 'number'\n    )) {\n      // set canvas size\n      if (widthStyle.hasValue()) {\n        canvas.width = widthStyle.getPixels('x')\n\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (canvas.style) {\n          canvas.style.width = `${canvas.width}px`\n        }\n      }\n\n      if (heightStyle.hasValue()) {\n        canvas.height = heightStyle.getPixels('y')\n\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (canvas.style) {\n          canvas.style.height = `${canvas.height}px`\n        }\n      }\n    }\n\n    let cWidth = canvas.clientWidth || canvas.width\n    let cHeight = canvas.clientHeight || canvas.height\n\n    if (ignoreDimensions && widthStyle.hasValue() && heightStyle.hasValue()) {\n      cWidth = widthStyle.getPixels('x')\n      cHeight = heightStyle.getPixels('y')\n    }\n\n    viewPort.setCurrent(cWidth, cHeight)\n\n    if (typeof offsetX === 'number') {\n      element.getAttribute('x', true).setValue(offsetX)\n    }\n\n    if (typeof offsetY === 'number') {\n      element.getAttribute('y', true).setValue(offsetY)\n    }\n\n    if (typeof scaleWidth === 'number'\n      || typeof scaleHeight === 'number'\n    ) {\n      const viewBox = toNumbers(element.getAttribute('viewBox').getString())\n      let xRatio = 0\n      let yRatio = 0\n\n      if (typeof scaleWidth === 'number') {\n        const widthStyle = element.getStyle('width')\n\n        if (widthStyle.hasValue()) {\n          xRatio = widthStyle.getPixels('x') / scaleWidth\n        } else\n        if (viewBox[2] && !isNaN(viewBox[2])) {\n          xRatio = viewBox[2] / scaleWidth\n        }\n      }\n\n      if (typeof scaleHeight === 'number') {\n        const heightStyle = element.getStyle('height')\n\n        if (heightStyle.hasValue()) {\n          yRatio = heightStyle.getPixels('y') / scaleHeight\n        } else\n        if (viewBox[3] && !isNaN(viewBox[3])) {\n          yRatio = viewBox[3] / scaleHeight\n        }\n      }\n\n      if (!xRatio) {\n        xRatio = yRatio\n      }\n\n      if (!yRatio) {\n        yRatio = xRatio\n      }\n\n      element.getAttribute('width', true).setValue(scaleWidth)\n      element.getAttribute('height', true).setValue(scaleHeight)\n\n      const transformStyle = element.getStyle('transform', true, true)\n\n      transformStyle.setValue(`${transformStyle.getString()} scale(${1.0 / xRatio}, ${1.0 / yRatio})`)\n    }\n\n    // clear and render\n    if (!ignoreClear) {\n      ctx.clearRect(0, 0, cWidth, cHeight)\n    }\n\n    element.render(ctx)\n\n    if (isFirstRender) {\n      this.isFirstRender = false\n    }\n  }\n}\n", "import { Fetch } from './types'\nimport { Screen } from './Screen'\n\ntype DOMParserConstructor = typeof DOMParser\n\nexport interface IParserOptions {\n  /**\n   * WHATWG-compatible `fetch` function.\n   */\n  fetch?: Fetch\n  /**\n   * XML/HTML parser from string into DOM Document.\n   */\n  DOMParser?: DOMParserConstructor\n}\n\nconst { defaultFetch } = Screen\nconst DefaultDOMParser = typeof DOMParser !== 'undefined'\n  ? DOMParser\n  : undefined\n\nexport class Parser {\n  private readonly fetch: Fetch\n  private readonly DOMParser: DOMParserConstructor\n\n  constructor({\n    fetch = defaultFetch,\n    DOMParser = DefaultDOMParser\n  }: IParserOptions = {}) {\n    if (!fetch) {\n      throw new Error(`Can't find 'fetch' in 'globalThis', please provide it via options`)\n    }\n\n    if (!DOMParser) {\n      throw new Error(`Can't find 'DOMParser' in 'globalThis', please provide it via options`)\n    }\n\n    this.fetch = fetch\n    this.DOMParser = DOMParser\n  }\n\n  async parse(resource: string) {\n    if (resource.startsWith('<')) {\n      return this.parseFromString(resource)\n    }\n\n    return this.load(resource)\n  }\n\n  parseFromString(xml: string) {\n    const parser = new this.DOMParser()\n\n    try {\n      return this.checkDocument(\n        parser.parseFromString(xml, 'image/svg+xml')\n      )\n    } catch (err) {\n      return this.checkDocument(\n        parser.parseFromString(xml, 'text/xml')\n      )\n    }\n  }\n\n  private checkDocument(document: Document) {\n    const parserError = document.getElementsByTagName('parsererror')[0]\n\n    if (parserError) {\n      throw new Error(parserError.textContent || 'Unknown parse error')\n    }\n\n    return document\n  }\n\n  async load(url: string) {\n    const response = await this.fetch(url)\n    const xml = await response.text()\n\n    return this.parseFromString(xml)\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Document } from '../Document'\nimport { Point } from '../Point'\n\nexport class Translate {\n  type = 'translate'\n  private readonly point: Point\n\n  constructor(\n    _: Document,\n    point: string\n  ) {\n    this.point = Point.parse(point)\n  }\n\n  apply(ctx: RenderingContext2D) {\n    const {\n      x,\n      y\n    } = this.point\n\n    ctx.translate(\n      x || 0.0,\n      y || 0.0\n    )\n  }\n\n  unapply(ctx: RenderingContext2D) {\n    const {\n      x,\n      y\n    } = this.point\n\n    ctx.translate(\n      -1.0 * x || 0.0,\n      -1.0 * y || 0.0\n    )\n  }\n\n  applyToPoint(point: Point) {\n    const {\n      x,\n      y\n    } = this.point\n\n    point.applyTransform([\n      1,\n      0,\n      0,\n      1,\n      x || 0.0,\n      y || 0.0\n    ])\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { toNumbers } from '../util'\nimport { Document } from '../Document'\nimport { Property } from '../Property'\nimport { Point } from '../Point'\n\nexport class Rotate {\n  type = 'rotate'\n  private readonly angle: Property\n  private readonly originX: Property\n  private readonly originY: Property\n  private readonly cx: number\n  private readonly cy: number\n\n  constructor(\n    document: Document,\n    rotate: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    const numbers = toNumbers(rotate)\n\n    this.angle = new Property(document, 'angle', numbers[0])\n    this.originX = transformOrigin[0]\n    this.originY = transformOrigin[1]\n    this.cx = numbers[1] || 0\n    this.cy = numbers[2] || 0\n  }\n\n  apply(ctx: RenderingContext2D) {\n    const {\n      cx,\n      cy,\n      originX,\n      originY,\n      angle\n    } = this\n    const tx = cx + originX.getPixels('x')\n    const ty = cy + originY.getPixels('y')\n\n    ctx.translate(tx, ty)\n    ctx.rotate(angle.getRadians())\n    ctx.translate(-tx, -ty)\n  }\n\n  unapply(ctx: RenderingContext2D) {\n    const {\n      cx,\n      cy,\n      originX,\n      originY,\n      angle\n    } = this\n    const tx = cx + originX.getPixels('x')\n    const ty = cy + originY.getPixels('y')\n\n    ctx.translate(tx, ty)\n    ctx.rotate(-1.0 * angle.getRadians())\n    ctx.translate(-tx, -ty)\n  }\n\n  applyToPoint(point: Point) {\n    const {\n      cx,\n      cy,\n      angle\n    } = this\n    const rad = angle.getRadians()\n\n    point.applyTransform([\n      1,\n      0,\n      0,\n      1,\n      cx || 0.0, // this.p.x\n      cy || 0.0 // this.p.y\n    ])\n    point.applyTransform([\n      Math.cos(rad),\n      Math.sin(rad),\n      -Math.sin(rad),\n      Math.cos(rad),\n      0,\n      0\n    ])\n    point.applyTransform([\n      1,\n      0,\n      0,\n      1,\n      -cx || 0.0, // -this.p.x\n      -cy || 0.0 // -this.p.y\n    ])\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { PSEUDO_ZERO } from '../util'\nimport { Document } from '../Document'\nimport { Point } from '../Point'\nimport { Property } from '../Property'\n\nexport class Scale {\n  type = 'scale'\n  private readonly scale: Point\n  private readonly originX: Property\n  private readonly originY: Property\n\n  constructor(\n    _: Document,\n    scale: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    const scaleSize = Point.parseScale(scale)\n\n    // Workaround for node-canvas\n    if (scaleSize.x === 0\n      || scaleSize.y === 0\n    ) {\n      scaleSize.x = PSEUDO_ZERO\n      scaleSize.y = PSEUDO_ZERO\n    }\n\n    this.scale = scaleSize\n    this.originX = transformOrigin[0]\n    this.originY = transformOrigin[1]\n  }\n\n  apply(ctx: RenderingContext2D) {\n    const {\n      scale: {\n        x,\n        y\n      },\n      originX,\n      originY\n    } = this\n    const tx = originX.getPixels('x')\n    const ty = originY.getPixels('y')\n\n    ctx.translate(tx, ty)\n    ctx.scale(x, y || x)\n    ctx.translate(-tx, -ty)\n  }\n\n  unapply(ctx: RenderingContext2D) {\n    const {\n      scale: {\n        x,\n        y\n      },\n      originX,\n      originY\n    } = this\n    const tx = originX.getPixels('x')\n    const ty = originY.getPixels('y')\n\n    ctx.translate(tx, ty)\n    ctx.scale(1.0 / x, 1.0 / y || x)\n    ctx.translate(-tx, -ty)\n  }\n\n  applyToPoint(point: Point) {\n    const {\n      x,\n      y\n    } = this.scale\n\n    point.applyTransform([\n      x || 0.0,\n      0,\n      0,\n      y || 0.0,\n      0,\n      0\n    ])\n  }\n}\n", "import { MatrixValue, RenderingContext2D } from '../types'\nimport { toMatrixValue } from '../util'\nimport { Document } from '../Document'\nimport { Point } from '../Point'\nimport { Property } from '../Property'\nimport { ITransform } from './types'\n\nexport class Matrix implements ITransform {\n  type = 'matrix'\n  protected matrix: MatrixValue\n  private readonly originX: Property\n  private readonly originY: Property\n\n  constructor(\n    _: Document,\n    matrix: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    this.matrix = toMatrixValue(matrix)\n    this.originX = transformOrigin[0]\n    this.originY = transformOrigin[1]\n  }\n\n  apply(ctx: RenderingContext2D) {\n    const {\n      originX,\n      originY,\n      matrix\n    } = this\n    const tx = originX.getPixels('x')\n    const ty = originY.getPixels('y')\n\n    ctx.translate(tx, ty)\n    ctx.transform(\n      matrix[0],\n      matrix[1],\n      matrix[2],\n      matrix[3],\n      matrix[4],\n      matrix[5]\n    )\n    ctx.translate(-tx, -ty)\n  }\n\n  unapply(ctx: RenderingContext2D) {\n    const {\n      originX,\n      originY,\n      matrix\n    } = this\n    const a = matrix[0]\n    const b = matrix[2]\n    const c = matrix[4]\n    const d = matrix[1]\n    const e = matrix[3]\n    const f = matrix[5]\n    const g = 0.0\n    const h = 0.0\n    const i = 1.0\n    const det = 1 / (a * (e * i - f * h) - b * (d * i - f * g) + c * (d * h - e * g))\n    const tx = originX.getPixels('x')\n    const ty = originY.getPixels('y')\n\n    ctx.translate(tx, ty)\n    ctx.transform(\n      det * (e * i - f * h),\n      det * (f * g - d * i),\n      det * (c * h - b * i),\n      det * (a * i - c * g),\n      det * (b * f - c * e),\n      det * (c * d - a * f)\n    )\n    ctx.translate(-tx, -ty)\n  }\n\n  applyToPoint(point: Point) {\n    point.applyTransform(this.matrix)\n  }\n}\n", "import { Document } from '../Document'\nimport { Property } from '../Property'\nimport { Matrix } from './Matrix'\n\nexport class Skew extends Matrix {\n  override type = 'skew'\n  protected readonly angle: Property\n\n  constructor(\n    document: Document,\n    skew: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    super(document, skew, transformOrigin)\n\n    this.angle = new Property(document, 'angle', skew)\n  }\n}\n", "import { Document } from '../Document'\nimport { Property } from '../Property'\nimport { Skew } from './Skew'\n\nexport class SkewX extends Skew {\n  override type = 'skewX'\n\n  constructor(\n    document: Document,\n    skew: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    super(document, skew, transformOrigin)\n\n    this.matrix = [\n      1,\n      0,\n      Math.tan(this.angle.getRadians()),\n      1,\n      0,\n      0\n    ]\n  }\n}\n", "import { Document } from '../Document'\nimport { Property } from '../Property'\nimport { Skew } from './Skew'\n\nexport class SkewY extends Skew {\n  override type = 'skewY'\n\n  constructor(\n    document: Document,\n    skew: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    super(document, skew, transformOrigin)\n\n    this.matrix = [\n      1,\n      Math.tan(this.angle.getRadians()),\n      0,\n      1,\n      0,\n      0\n    ]\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { compressSpaces } from '../util'\nimport { Property } from '../Property'\nimport { Point } from '../Point'\nimport { Document, Element } from '../Document'\nimport { ITransform } from './types'\nimport { Translate } from './Translate'\nimport { Rotate } from './Rotate'\nimport { Scale } from './Scale'\nimport { Matrix } from './Matrix'\nimport { SkewX } from './SkewX'\nimport { SkewY } from './SkewY'\n\nfunction parseTransforms(transform: string) {\n  return compressSpaces(transform)\n    .trim()\n    .replace(/\\)([a-zA-Z])/g, ') $1')\n    .replace(/\\)(\\s?,\\s?)/g, ') ')\n    .split(/\\s(?=[a-z])/)\n}\n\nfunction parseTransform(transform: string) {\n  const [type = '', value = ''] = transform.split('(')\n\n  return [type.trim(), value.trim().replace(')', '')] as const\n}\n\ninterface ITransformConstructor {\n  prototype: ITransform\n  new (\n    document: Document,\n    value: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ): ITransform\n}\n\nexport class Transform {\n  static fromElement(document: Document, element: Element) {\n    const transformStyle = element.getStyle('transform', false, true)\n\n    if (transformStyle.hasValue()) {\n      const [transformOriginXProperty, transformOriginYProperty = transformOriginXProperty] = element.getStyle('transform-origin', false, true).split()\n\n      if (transformOriginXProperty && transformOriginYProperty) {\n        const transformOrigin = [transformOriginXProperty, transformOriginYProperty] as const\n\n        return new Transform(\n          document,\n          transformStyle.getString(),\n          transformOrigin\n        )\n      }\n    }\n\n    return null\n  }\n\n  static transformTypes: Record<string, ITransformConstructor> = {\n    translate: Translate,\n    rotate: Rotate,\n    scale: Scale,\n    matrix: Matrix,\n    skewX: SkewX,\n    skewY: SkewY\n  }\n\n  private readonly transforms: ITransform[] = []\n\n  constructor(\n    private readonly document: Document,\n    transform: string,\n    transformOrigin: readonly [Property<string>, Property<string>]\n  ) {\n    const data = parseTransforms(transform)\n\n    data.forEach((transform) => {\n      if (transform === 'none') {\n        return\n      }\n\n      const [type, value] = parseTransform(transform)\n      const TransformType = Transform.transformTypes[type]\n\n      if (TransformType) {\n        this.transforms.push(new TransformType(this.document, value, transformOrigin))\n      }\n    })\n  }\n\n  apply(ctx: RenderingContext2D) {\n    this.transforms.forEach(transform => transform.apply(ctx))\n  }\n\n  unapply(ctx: RenderingContext2D) {\n    this.transforms.forEach(transform => transform.unapply(ctx))\n  }\n\n  // TODO: applyToPoint unused ... remove?\n  applyToPoint(point: Point) {\n    this.transforms.forEach(transform => transform.applyToPoint(point))\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { normalizeAttributeName } from '../util'\nimport { Property } from '../Property'\nimport { Transform } from '../Transform'\nimport { Document } from './Document'\nimport { ClipPathElement } from './ClipPathElement'\nimport { MaskElement } from './MaskElement'\nimport { FilterElement } from './FilterElement'\n\nexport abstract class Element {\n  static readonly ignoreChildTypes = ['title']\n\n  readonly type: string = ''\n  readonly attributes: Record<string, Property> = {}\n  readonly styles: Record<string, Property> = {}\n  readonly stylesSpecificity: Record<string, string> = {}\n  animationFrozen = false\n  animationFrozenValue = ''\n  parent: Element | null = null\n  children: Element[] = []\n\n  constructor(\n    protected readonly document: Document,\n    protected readonly node?: HTMLElement,\n    protected readonly captureTextNodes = false\n  ) {\n    if (!node || node.nodeType !== 1) { // ELEMENT_NODE\n      return\n    }\n\n    // add attributes\n    Array.from(node.attributes).forEach((attribute) => {\n      const nodeName = normalizeAttributeName(attribute.nodeName)\n\n      this.attributes[nodeName] = new Property(document, nodeName, attribute.value)\n    })\n\n    this.addStylesFromStyleDefinition()\n\n    // add inline styles\n    if (this.getAttribute('style').hasValue()) {\n      const styles = this.getAttribute('style')\n        .getString()\n        .split(';')\n        .map(_ => _.trim())\n\n      styles.forEach((style) => {\n        if (!style) {\n          return\n        }\n\n        const [name, value] = style.split(':').map(_ => _.trim())\n\n        if (name) {\n          this.styles[name] = new Property(document, name, value)\n        }\n      })\n    }\n\n    const { definitions } = document\n    const id = this.getAttribute('id')\n\n    // add id\n    if (id.hasValue()) {\n      if (!definitions[id.getString()]) {\n        definitions[id.getString()] = this\n      }\n    }\n\n    Array.from(node.childNodes).forEach((childNode: HTMLElement) => {\n      if (childNode.nodeType === 1) {\n        this.addChild(childNode) // ELEMENT_NODE\n      } else\n      if (captureTextNodes && (\n        childNode.nodeType === 3\n        || childNode.nodeType === 4\n      )) {\n        const textNode = document.createTextNode(childNode)\n\n        if (textNode.getText().length > 0) {\n          this.addChild(textNode) // TEXT_NODE\n        }\n      }\n    })\n  }\n\n  getAttribute(name: string, createIfNotExists = false): Property {\n    const attr = this.attributes[name]\n\n    if (!attr && createIfNotExists) {\n      const attr = new Property(this.document, name, '')\n\n      this.attributes[name] = attr\n\n      return attr\n    }\n\n    return attr || Property.empty(this.document)\n  }\n\n  getHrefAttribute(): Property {\n    let href: Property | undefined\n\n    for (const key in this.attributes) {\n      if (key === 'href' || key.endsWith(':href')) {\n        href = this.attributes[key]\n        break\n      }\n    }\n\n    return href || Property.empty(this.document)\n  }\n\n  getStyle(name: string, createIfNotExists = false, skipAncestors = false): Property {\n    const style = this.styles[name]\n\n    if (style) {\n      return style\n    }\n\n    const attr = this.getAttribute(name)\n\n    if (attr.hasValue()) {\n      this.styles[name] = attr // move up to me to cache\n      return attr\n    }\n\n    if (!skipAncestors) {\n      const { parent } = this\n\n      if (parent) {\n        const parentStyle = parent.getStyle(name)\n\n        if (parentStyle.hasValue()) {\n          return parentStyle\n        }\n      }\n    }\n\n    if (createIfNotExists) {\n      const style = new Property(this.document, name, '')\n\n      this.styles[name] = style\n\n      return style\n    }\n\n    return Property.empty(this.document)\n  }\n\n  render(ctx: RenderingContext2D) {\n    // don't render display=none\n    // don't render visibility=hidden\n    if (this.getStyle('display').getString() === 'none'\n      || this.getStyle('visibility').getString() === 'hidden'\n    ) {\n      return\n    }\n\n    ctx.save()\n\n    if (this.getStyle('mask').hasValue()) { // mask\n      const mask = this.getStyle('mask').getDefinition<MaskElement>()\n\n      if (mask) {\n        this.applyEffects(ctx)\n        mask.apply(ctx, this)\n      }\n    } else\n    if (this.getStyle('filter').getValue('none') !== 'none') { // filter\n      const filter = this.getStyle('filter').getDefinition<FilterElement>()\n\n      if (filter) {\n        this.applyEffects(ctx)\n        filter.apply(ctx, this)\n      }\n    } else {\n      this.setContext(ctx)\n      this.renderChildren(ctx)\n      this.clearContext(ctx)\n    }\n\n    ctx.restore()\n  }\n\n  setContext(_: RenderingContext2D) {\n    // NO RENDER\n  }\n\n  protected applyEffects(ctx: RenderingContext2D) {\n    // transform\n    const transform = Transform.fromElement(this.document, this)\n\n    if (transform) {\n      transform.apply(ctx)\n    }\n\n    // clip\n    const clipPathStyleProp = this.getStyle('clip-path', false, true)\n\n    if (clipPathStyleProp.hasValue()) {\n      const clip = clipPathStyleProp.getDefinition<ClipPathElement>()\n\n      if (clip) {\n        clip.apply(ctx)\n      }\n    }\n  }\n\n  clearContext(_: RenderingContext2D) {\n    // NO RENDER\n  }\n\n  renderChildren(ctx: RenderingContext2D) {\n    this.children.forEach((child) => {\n      child.render(ctx)\n    })\n  }\n\n  protected addChild(childNode: Element|HTMLElement) {\n    const child = childNode instanceof Element\n      ? childNode\n      : this.document.createElement(childNode)\n\n    child.parent = this\n\n    if (!Element.ignoreChildTypes.includes(child.type)) {\n      this.children.push(child)\n    }\n  }\n\n  protected matchesSelector(selector: string) {\n    const { node } = this\n\n    if (typeof node.matches === 'function') {\n      return node.matches(selector)\n    }\n\n    const styleClasses = node.getAttribute?.('class')\n\n    if (!styleClasses || styleClasses === '') {\n      return false\n    }\n\n    return styleClasses.split(' ').some(styleClass => `.${styleClass}` === selector)\n  }\n\n  addStylesFromStyleDefinition() {\n    const {\n      styles,\n      stylesSpecificity\n    } = this.document\n    let styleProp: Property | undefined\n\n    for (const selector in styles) {\n      if (!selector.startsWith('@') && this.matchesSelector(selector)) {\n        const style = styles[selector]\n        const specificity = stylesSpecificity[selector]\n\n        if (style) {\n          for (const name in style) {\n            let existingSpecificity = this.stylesSpecificity[name]\n\n            if (typeof existingSpecificity === 'undefined') {\n              existingSpecificity = '000'\n            }\n\n            if (specificity && specificity >= existingSpecificity) {\n              styleProp = style[name]\n\n              if (styleProp) {\n                this.styles[name] = styleProp\n              }\n\n              this.stylesSpecificity[name] = specificity\n            }\n          }\n        }\n      }\n    }\n  }\n\n  protected removeStyles(element: Element, ignoreStyles: string[]) {\n    const toRestore = ignoreStyles.reduce<[string, string][]>((toRestore, name) => {\n      const styleProp = element.getStyle(name)\n\n      if (!styleProp.hasValue()) {\n        return toRestore\n      }\n\n      const value = styleProp.getString()\n\n      styleProp.setValue('')\n\n      return [...toRestore, [name, value]]\n    }, [])\n\n    return toRestore\n  }\n\n  protected restoreStyles(element: Element, styles: [string, string][]) {\n    styles.forEach(([name, value]) => {\n      element.getStyle(name, true).setValue(value)\n    })\n  }\n\n  isFirstChild() {\n    return this.parent?.children.indexOf(this) === 0\n  }\n}\n", "import { Document } from './Document'\nimport { Element } from './Element'\n\nexport class UnknownElement extends Element {\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn(`Element ${node.nodeName} not yet implemented.`)\n    }\n  }\n}\n", "import { compressSpaces } from './util'\n\nfunction wrapFontFamily(fontFamily: string) {\n  const trimmed = fontFamily.trim()\n\n  return /^('|\")/.test(trimmed)\n    ? trimmed\n    : `\"${trimmed}\"`\n}\n\nfunction prepareFontFamily(fontFamily: string) {\n  return typeof process === 'undefined'\n    ? fontFamily\n    : fontFamily\n      .trim()\n      .split(',')\n      .map(wrapFontFamily)\n      .join(',')\n}\n\n/**\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-style\n * @param fontStyle\n * @returns CSS font style.\n */\nfunction prepareFontStyle(fontStyle: string) {\n  if (!fontStyle) {\n    return ''\n  }\n\n  const targetFontStyle = fontStyle.trim().toLowerCase()\n\n  switch (targetFontStyle) {\n    case 'normal':\n    case 'italic':\n    case 'oblique':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontStyle\n\n    default:\n\n      if (/^oblique\\s+(-|)\\d+deg$/.test(targetFontStyle)) {\n        return targetFontStyle\n      }\n\n      return ''\n  }\n}\n\n/**\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\n * @param fontWeight\n * @returns CSS font weight.\n */\nfunction prepareFontWeight(fontWeight: string) {\n  if (!fontWeight) {\n    return ''\n  }\n\n  const targetFontWeight = fontWeight.trim().toLowerCase()\n\n  switch (targetFontWeight) {\n    case 'normal':\n    case 'bold':\n    case 'lighter':\n    case 'bolder':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontWeight\n\n    default:\n\n      if (/^[\\d.]+$/.test(targetFontWeight)) {\n        return targetFontWeight\n      }\n\n      return ''\n  }\n}\n\nexport class Font {\n  static parse(\n    font = '',\n    inherit?: string | Font\n  ) {\n    let fontStyle = ''\n    let fontVariant = ''\n    let fontWeight = ''\n    let fontSize = ''\n    let fontFamily = ''\n    const parts = compressSpaces(font).trim().split(' ')\n    const set = {\n      fontSize: false,\n      fontStyle: false,\n      fontWeight: false,\n      fontVariant: false\n    }\n\n    parts.forEach((part) => {\n      switch (true) {\n        case !set.fontStyle && Font.styles.includes(part):\n\n          if (part !== 'inherit') {\n            fontStyle = part\n          }\n\n          set.fontStyle = true\n          break\n\n        case !set.fontVariant && Font.variants.includes(part):\n\n          if (part !== 'inherit') {\n            fontVariant = part\n          }\n\n          set.fontStyle = true\n          set.fontVariant = true\n          break\n\n        case !set.fontWeight && Font.weights.includes(part):\n\n          if (part !== 'inherit') {\n            fontWeight = part\n          }\n\n          set.fontStyle = true\n          set.fontVariant = true\n          set.fontWeight = true\n          break\n\n        case !set.fontSize:\n\n          if (part !== 'inherit') {\n            fontSize = part.split('/')[0] || ''\n          }\n\n          set.fontStyle = true\n          set.fontVariant = true\n          set.fontWeight = true\n          set.fontSize = true\n          break\n\n        default:\n\n          if (part !== 'inherit') {\n            fontFamily += part\n          }\n      }\n    })\n\n    return new Font(\n      fontStyle,\n      fontVariant,\n      fontWeight,\n      fontSize,\n      fontFamily,\n      inherit\n    )\n  }\n\n  static readonly styles = 'normal|italic|oblique|inherit'\n  static readonly variants = 'normal|small-caps|inherit'\n  static readonly weights = 'normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit'\n\n  readonly fontFamily: string\n  readonly fontSize: string\n  readonly fontStyle: string\n  readonly fontWeight: string\n  readonly fontVariant: string\n\n  constructor(\n    fontStyle: string,\n    fontVariant: string,\n    fontWeight: string,\n    fontSize: string,\n    fontFamily: string,\n    inherit?: string | Font\n  ) {\n    const inheritFont = inherit\n      ? typeof inherit === 'string'\n        ? Font.parse(inherit)\n        : inherit\n      : {} as Font\n\n    this.fontFamily = fontFamily || inheritFont.fontFamily\n    this.fontSize = fontSize || inheritFont.fontSize\n    this.fontStyle = fontStyle || inheritFont.fontStyle\n    this.fontWeight = fontWeight || inheritFont.fontWeight\n    this.fontVariant = fontVariant || inheritFont.fontVariant\n  }\n\n  toString() {\n    return [\n      prepareFontStyle(this.fontStyle),\n      this.fontVariant,\n      prepareFontWeight(this.fontWeight),\n      this.fontSize,\n      // Wrap fontFamily only on nodejs and only for canvas.ctx\n      prepareFontFamily(this.fontFamily)\n    ].join(' ').trim()\n  }\n}\n", "\nexport class BoundingBox {\n  constructor(\n    public x1 = Number.NaN,\n    public y1 = Number.NaN,\n    public x2 = Number.NaN,\n    public y2 = Number.NaN\n  ) {\n    this.addPoint(x1, y1)\n    this.addPoint(x2, y2)\n  }\n\n  get x() {\n    return this.x1\n  }\n\n  get y() {\n    return this.y1\n  }\n\n  get width() {\n    return this.x2 - this.x1\n  }\n\n  get height() {\n    return this.y2 - this.y1\n  }\n\n  addPoint(x: number | undefined, y: number | undefined) {\n    if (typeof x !== 'undefined') {\n      if (isNaN(this.x1) || isNaN(this.x2)) {\n        this.x1 = x\n        this.x2 = x\n      }\n\n      if (x < this.x1) {\n        this.x1 = x\n      }\n\n      if (x > this.x2) {\n        this.x2 = x\n      }\n    }\n\n    if (typeof y !== 'undefined') {\n      if (isNaN(this.y1) || isNaN(this.y2)) {\n        this.y1 = y\n        this.y2 = y\n      }\n\n      if (y < this.y1) {\n        this.y1 = y\n      }\n\n      if (y > this.y2) {\n        this.y2 = y\n      }\n    }\n  }\n\n  addX(x: number) {\n    this.addPoint(x, 0)\n  }\n\n  addY(y: number) {\n    this.addPoint(0, y)\n  }\n\n  addBoundingBox(boundingBox: BoundingBox | null) {\n    if (!boundingBox) {\n      return\n    }\n\n    const {\n      x1,\n      y1,\n      x2,\n      y2\n    } = boundingBox\n\n    this.addPoint(x1, y1)\n    this.addPoint(x2, y2)\n  }\n\n  private sumCubic(\n    t: number,\n    p0: number,\n    p1: number,\n    p2: number,\n    p3: number\n  ) {\n    return (\n      Math.pow(1 - t, 3) * p0\n      + 3 * Math.pow(1 - t, 2) * t * p1\n      + 3 * (1 - t) * Math.pow(t, 2) * p2\n      + Math.pow(t, 3) * p3\n    )\n  }\n\n  private bezierCurveAdd(\n    forX: boolean,\n    p0: number,\n    p1: number,\n    p2: number,\n    p3: number\n  ) {\n    const b = 6 * p0 - 12 * p1 + 6 * p2\n    const a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3\n    const c = 3 * p1 - 3 * p0\n\n    if (a === 0) {\n      if (b === 0) {\n        return\n      }\n\n      const t = -c / b\n\n      if (0 < t && t < 1) {\n        if (forX) {\n          this.addX(this.sumCubic(t, p0, p1, p2, p3))\n        } else {\n          this.addY(this.sumCubic(t, p0, p1, p2, p3))\n        }\n      }\n\n      return\n    }\n\n    const b2ac = Math.pow(b, 2) - 4 * c * a\n\n    if (b2ac < 0) {\n      return\n    }\n\n    const t1 = (-b + Math.sqrt(b2ac)) / (2 * a)\n\n    if (0 < t1 && t1 < 1) {\n      if (forX) {\n        this.addX(\n          this.sumCubic(t1, p0, p1, p2, p3)\n        )\n      } else {\n        this.addY(\n          this.sumCubic(t1, p0, p1, p2, p3)\n        )\n      }\n    }\n\n    const t2 = (-b - Math.sqrt(b2ac)) / (2 * a)\n\n    if (0 < t2 && t2 < 1) {\n      if (forX) {\n        this.addX(this.sumCubic(t2, p0, p1, p2, p3))\n      } else {\n        this.addY(this.sumCubic(t2, p0, p1, p2, p3))\n      }\n    }\n  }\n\n  // from http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n  addBezierCurve(\n    p0x: number,\n    p0y: number,\n    p1x: number,\n    p1y: number,\n    p2x: number,\n    p2y: number,\n    p3x: number,\n    p3y: number\n  ) {\n    this.addPoint(p0x, p0y)\n    this.addPoint(p3x, p3y)\n    this.bezierCurveAdd(true, p0x, p1x, p2x, p3x)\n    this.bezierCurveAdd(false, p0y, p1y, p2y, p3y)\n  }\n\n  addQuadraticCurve(\n    p0x: number,\n    p0y: number,\n    p1x: number,\n    p1y: number,\n    p2x: number,\n    p2y: number\n  ) {\n    const cp1x = p0x + 2 / 3 * (p1x - p0x) // CP1 = QP0 + 2/3 *(QP1-QP0)\n    const cp1y = p0y + 2 / 3 * (p1y - p0y) // CP1 = QP0 + 2/3 *(QP1-QP0)\n    const cp2x = cp1x + 1 / 3 * (p2x - p0x) // CP2 = CP1 + 1/3 *(QP2-QP0)\n    const cp2y = cp1y + 1 / 3 * (p2y - p0y) // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n    this.addBezierCurve(p0x, p0y, cp1x, cp2x, cp1y, cp2y, p2x, p2y)\n  }\n\n  isPointInBox(\n    x: number,\n    y: number\n  ) {\n    const {\n      x1,\n      y1,\n      x2,\n      y2\n    } = this\n\n    return (\n      x1 <= x\n      && x <= x2\n      && y1 <= y\n      && y <= y2\n    )\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport {\n  PSEUDO_ZERO,\n  toNumbers\n} from '../util'\nimport { Font } from '../Font'\nimport { Property } from '../Property'\nimport { Element } from './Element'\n\nexport abstract class RenderedElement extends Element {\n  private modifiedEmSizeStack = false\n\n  protected calculateOpacity() {\n    let opacity = 1.0\n    // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n    let element: Element | null = this\n\n    while (element) {\n      const opacityStyle = element.getStyle('opacity', false, true) // no ancestors on style call\n\n      if (opacityStyle.hasValue(true)) {\n        opacity *= opacityStyle.getNumber()\n      }\n\n      element = element.parent\n    }\n\n    return opacity\n  }\n\n  override setContext(ctx: RenderingContext2D, fromMeasure = false) {\n    if (!fromMeasure) { // causes stack overflow when measuring text with gradients\n      // fill\n      const fillStyleProp = this.getStyle('fill')\n      const fillOpacityStyleProp = this.getStyle('fill-opacity')\n      const strokeStyleProp = this.getStyle('stroke')\n      const strokeOpacityProp = this.getStyle('stroke-opacity')\n\n      if (fillStyleProp.isUrlDefinition()) {\n        const fillStyle = fillStyleProp.getFillStyleDefinition(this, fillOpacityStyleProp)\n\n        if (fillStyle) {\n          ctx.fillStyle = fillStyle\n        }\n      } else\n      if (fillStyleProp.hasValue()) {\n        if (fillStyleProp.getString() === 'currentColor') {\n          fillStyleProp.setValue(this.getStyle('color').getColor())\n        }\n\n        const fillStyle = fillStyleProp.getColor()\n\n        if (fillStyle !== 'inherit') {\n          ctx.fillStyle = fillStyle === 'none'\n            ? 'rgba(0,0,0,0)'\n            : fillStyle\n        }\n      }\n\n      if (fillOpacityStyleProp.hasValue()) {\n        const fillStyle = new Property(this.document, 'fill', ctx.fillStyle)\n          .addOpacity(fillOpacityStyleProp)\n          .getColor()\n\n        ctx.fillStyle = fillStyle\n      }\n\n      // stroke\n      if (strokeStyleProp.isUrlDefinition()) {\n        const strokeStyle = strokeStyleProp.getFillStyleDefinition(this, strokeOpacityProp)\n\n        if (strokeStyle) {\n          ctx.strokeStyle = strokeStyle\n        }\n      } else\n      if (strokeStyleProp.hasValue()) {\n        if (strokeStyleProp.getString() === 'currentColor') {\n          strokeStyleProp.setValue(this.getStyle('color').getColor())\n        }\n\n        const strokeStyle = strokeStyleProp.getString()\n\n        if (strokeStyle !== 'inherit') {\n          ctx.strokeStyle = strokeStyle === 'none'\n            ? 'rgba(0,0,0,0)'\n            : strokeStyle\n        }\n      }\n\n      if (strokeOpacityProp.hasValue()) {\n        const strokeStyle = new Property(this.document, 'stroke', ctx.strokeStyle)\n          .addOpacity(strokeOpacityProp)\n          .getString()\n\n        ctx.strokeStyle = strokeStyle\n      }\n\n      const strokeWidthStyleProp = this.getStyle('stroke-width')\n\n      if (strokeWidthStyleProp.hasValue()) {\n        const newLineWidth = strokeWidthStyleProp.getPixels()\n\n        ctx.lineWidth = !newLineWidth\n          ? PSEUDO_ZERO // browsers don't respect 0 (or node-canvas? :-)\n          : newLineWidth\n      }\n\n      const strokeLinecapStyleProp = this.getStyle('stroke-linecap')\n      const strokeLinejoinStyleProp = this.getStyle('stroke-linejoin')\n      const strokeMiterlimitProp = this.getStyle('stroke-miterlimit')\n      // NEED TEST\n      // const pointOrderStyleProp = this.getStyle('paint-order');\n      const strokeDasharrayStyleProp = this.getStyle('stroke-dasharray')\n      const strokeDashoffsetProp = this.getStyle('stroke-dashoffset')\n\n      if (strokeLinecapStyleProp.hasValue()) {\n        ctx.lineCap = strokeLinecapStyleProp.getString() as CanvasLineCap\n      }\n\n      if (strokeLinejoinStyleProp.hasValue()) {\n        ctx.lineJoin = strokeLinejoinStyleProp.getString() as CanvasLineJoin\n      }\n\n      if (strokeMiterlimitProp.hasValue()) {\n        ctx.miterLimit = strokeMiterlimitProp.getNumber()\n      }\n\n      // NEED TEST\n      // if (pointOrderStyleProp.hasValue()) {\n      //   // ?\n      //   ctx.paintOrder = pointOrderStyleProp.getValue();\n      // }\n\n      if (strokeDasharrayStyleProp.hasValue() && strokeDasharrayStyleProp.getString() !== 'none') {\n        const gaps = toNumbers(strokeDasharrayStyleProp.getString())\n\n        if (typeof ctx.setLineDash !== 'undefined') {\n          ctx.setLineDash(gaps)\n        } else\n        // @ts-expect-error Handle browser prefix.\n        if (typeof ctx.webkitLineDash !== 'undefined') {\n          // @ts-expect-error Handle browser prefix.\n          ctx.webkitLineDash = gaps\n        } else\n        // @ts-expect-error Handle browser prefix.\n        if (typeof ctx.mozDash !== 'undefined' && !(gaps.length === 1 && gaps[0] === 0)) {\n          // @ts-expect-error Handle browser prefix.\n          ctx.mozDash = gaps\n        }\n\n        const offset = strokeDashoffsetProp.getPixels()\n\n        if (typeof ctx.lineDashOffset !== 'undefined') {\n          ctx.lineDashOffset = offset\n        } else\n        // @ts-expect-error Handle browser prefix.\n        if (typeof ctx.webkitLineDashOffset !== 'undefined') {\n          // @ts-expect-error Handle browser prefix.\n          ctx.webkitLineDashOffset = offset\n        } else\n        // @ts-expect-error Handle browser prefix.\n        if (typeof ctx.mozDashOffset !== 'undefined') {\n          // @ts-expect-error Handle browser prefix.\n          ctx.mozDashOffset = offset\n        }\n      }\n    }\n\n    // font\n    this.modifiedEmSizeStack = false\n\n    if (typeof ctx.font !== 'undefined') {\n      const fontStyleProp = this.getStyle('font')\n      const fontStyleStyleProp = this.getStyle('font-style')\n      const fontVariantStyleProp = this.getStyle('font-variant')\n      const fontWeightStyleProp = this.getStyle('font-weight')\n      const fontSizeStyleProp = this.getStyle('font-size')\n      const fontFamilyStyleProp = this.getStyle('font-family')\n      const font = new Font(\n        fontStyleStyleProp.getString(),\n        fontVariantStyleProp.getString(),\n        fontWeightStyleProp.getString(),\n        fontSizeStyleProp.hasValue()\n          ? `${fontSizeStyleProp.getPixels(true)}px`\n          : '',\n        fontFamilyStyleProp.getString(),\n        Font.parse(\n          fontStyleProp.getString(),\n          ctx.font\n        )\n      )\n\n      fontStyleStyleProp.setValue(font.fontStyle)\n      fontVariantStyleProp.setValue(font.fontVariant)\n      fontWeightStyleProp.setValue(font.fontWeight)\n      fontSizeStyleProp.setValue(font.fontSize)\n      fontFamilyStyleProp.setValue(font.fontFamily)\n\n      ctx.font = font.toString()\n\n      if (fontSizeStyleProp.isPixels()) {\n        this.document.emSize = fontSizeStyleProp.getPixels()\n        this.modifiedEmSizeStack = true\n      }\n    }\n\n    if (!fromMeasure) {\n      // effects\n      this.applyEffects(ctx)\n      // opacity\n      ctx.globalAlpha = this.calculateOpacity()\n    }\n  }\n\n  override clearContext(ctx: RenderingContext2D) {\n    super.clearContext(ctx)\n\n    if (this.modifiedEmSizeStack) {\n      this.document.popEmSize()\n    }\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport {\n  toNumbers,\n  compressSpaces,\n  trimLeft,\n  trimRight\n} from '../util'\nimport { Font } from '../Font'\nimport { BoundingBox } from '../BoundingBox'\nimport { Document } from './Document'\nimport { Element } from './Element'\nimport { FontElement } from './FontElement'\nimport { ArabicForm, GlyphElement } from './GlyphElement'\nimport { RenderedElement } from './RenderedElement'\n\nexport class TextElement extends RenderedElement {\n  override type = 'text'\n  protected x = 0\n  protected y = 0\n  private leafTexts: TextElement[] = []\n  private textChunkStart = 0\n  private minX = Number.POSITIVE_INFINITY\n  private maxX = Number.NEGATIVE_INFINITY\n  private measureCache = -1\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(\n      document,\n      node,\n      new.target === TextElement\n        ? true\n        : captureTextNodes\n    )\n  }\n\n  override setContext(ctx: RenderingContext2D, fromMeasure = false) {\n    super.setContext(ctx, fromMeasure)\n\n    const textBaseline = this.getStyle('dominant-baseline').getTextBaseline()\n      || this.getStyle('alignment-baseline').getTextBaseline()\n\n    if (textBaseline) {\n      ctx.textBaseline = textBaseline as CanvasTextBaseline\n    }\n  }\n\n  protected initializeCoordinates() {\n    this.x = 0\n    this.y = 0\n    this.leafTexts = []\n    this.textChunkStart = 0\n    this.minX = Number.POSITIVE_INFINITY\n    this.maxX = Number.NEGATIVE_INFINITY\n  }\n\n  getBoundingBox(ctx: RenderingContext2D) {\n    if (this.type !== 'text') {\n      return this.getTElementBoundingBox(ctx)\n    }\n\n    // first, calculate child positions\n    this.initializeCoordinates()\n    this.adjustChildCoordinatesRecursive(ctx)\n\n    let boundingBox: BoundingBox | null = null\n\n    // then calculate bounding box\n    this.children.forEach((_, i) => {\n      const childBoundingBox = this.getChildBoundingBox(ctx, this, this, i)\n\n      if (!boundingBox) {\n        boundingBox = childBoundingBox\n      } else {\n        boundingBox.addBoundingBox(childBoundingBox)\n      }\n    })\n\n    return boundingBox\n  }\n\n  protected getFontSize() {\n    const {\n      document,\n      parent\n    } = this\n    const inheritFontSize = Font.parse(document.ctx.font).fontSize\n    const fontSize = parent.getStyle('font-size').getNumber(inheritFontSize)\n\n    return fontSize\n  }\n\n  protected getTElementBoundingBox(ctx: RenderingContext2D) {\n    const fontSize = this.getFontSize()\n\n    return new BoundingBox(\n      this.x,\n      this.y - fontSize,\n      this.x + this.measureText(ctx),\n      this.y\n    )\n  }\n\n  getGlyph(\n    font: FontElement,\n    text: string,\n    i: number\n  ) {\n    const char = text[i]\n    let glyph: GlyphElement | undefined\n\n    if (font.isArabic) {\n      const len = text.length\n      const prevChar = text[i - 1]\n      const nextChar = text[i + 1]\n      let arabicForm: ArabicForm = 'isolated'\n\n      if ((i === 0 || prevChar === ' ') && i < len - 1 && nextChar !== ' ') {\n        arabicForm = 'terminal'\n      }\n\n      if (i > 0 && prevChar !== ' ' && i < len - 1 && nextChar !== ' ') {\n        arabicForm = 'medial'\n      }\n\n      if (i > 0 && prevChar !== ' ' && (i === len - 1 || nextChar === ' ')) {\n        arabicForm = 'initial'\n      }\n\n      glyph = font.arabicGlyphs[char]?.[arabicForm] || font.glyphs[char]\n    } else {\n      glyph = font.glyphs[char]\n    }\n\n    if (!glyph) {\n      glyph = font.missingGlyph\n    }\n\n    return glyph\n  }\n\n  getText() {\n    return ''\n  }\n\n  protected getTextFromNode(node?: ChildNode) {\n    const textNode = node || this.node\n    const childNodes = Array.from(textNode.parentNode.childNodes)\n    const index = childNodes.indexOf(textNode)\n    const lastIndex = childNodes.length - 1\n    let text = compressSpaces(\n      // textNode.value\n      // || textNode.text\n      textNode.textContent\n      || ''\n    )\n\n    if (index === 0) {\n      text = trimLeft(text)\n    }\n\n    if (index === lastIndex) {\n      text = trimRight(text)\n    }\n\n    return text\n  }\n\n  override renderChildren(ctx: RenderingContext2D) {\n    if (this.type !== 'text') {\n      this.renderTElementChildren(ctx)\n      return\n    }\n\n    // first, calculate child positions\n    this.initializeCoordinates()\n    this.adjustChildCoordinatesRecursive(ctx)\n\n    // then render\n    this.children.forEach((_, i) => {\n      this.renderChild(ctx, this, this, i)\n    })\n\n    const { mouse } = this.document.screen\n\n    // Do not calc bounding box if mouse is not working.\n    if (mouse.isWorking()) {\n      mouse.checkBoundingBox(\n        this,\n        this.getBoundingBox(ctx)\n      )\n    }\n  }\n\n  protected renderTElementChildren(ctx: RenderingContext2D) {\n    const {\n      document,\n      parent\n    } = this\n    const renderText = this.getText()\n    const customFont = parent.getStyle('font-family').getDefinition<FontElement>()\n\n    if (customFont) {\n      const { unitsPerEm } = customFont.fontFace\n      const ctxFont = Font.parse(document.ctx.font)\n      const fontSize = parent.getStyle('font-size').getNumber(ctxFont.fontSize)\n      const fontStyle = parent.getStyle('font-style').getString(ctxFont.fontStyle)\n      const scale = fontSize / unitsPerEm\n      const text = customFont.isRTL\n        ? renderText.split('').reverse().join('')\n        : renderText\n      const dx = toNumbers(parent.getAttribute('dx').getString())\n      const len = text.length\n\n      for (let i = 0; i < len; i++) {\n        const glyph = this.getGlyph(customFont, text, i)\n\n        ctx.translate(this.x, this.y)\n        ctx.scale(scale, -scale)\n\n        const lw = ctx.lineWidth\n\n        ctx.lineWidth = ctx.lineWidth * unitsPerEm / fontSize\n\n        if (fontStyle === 'italic') {\n          ctx.transform(1, 0, .4, 1, 0, 0)\n        }\n\n        glyph.render(ctx)\n\n        if (fontStyle === 'italic') {\n          ctx.transform(1, 0, -.4, 1, 0, 0)\n        }\n\n        ctx.lineWidth = lw\n        ctx.scale(1 / scale, -1 / scale)\n        ctx.translate(-this.x, -this.y)\n\n        this.x += fontSize * (glyph.horizAdvX || customFont.horizAdvX) / unitsPerEm\n\n        if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n          this.x += dx[i]\n        }\n      }\n\n      return\n    }\n\n    const {\n      x,\n      y\n    } = this\n\n    // NEED TEST\n    // if (ctx.paintOrder === 'stroke') {\n    //   if (ctx.strokeStyle) {\n    //     ctx.strokeText(renderText, x, y);\n    //   }\n\n    //   if (ctx.fillStyle) {\n    //     ctx.fillText(renderText, x, y);\n    //   }\n    // } else {\n    if (ctx.fillStyle) {\n      ctx.fillText(renderText, x, y)\n    }\n\n    if (ctx.strokeStyle) {\n      ctx.strokeText(renderText, x, y)\n    }\n    // }\n  }\n\n  protected applyAnchoring() {\n    if (this.textChunkStart >= this.leafTexts.length) {\n      return\n    }\n\n    // This is basically the \"Apply anchoring\" part of https://www.w3.org/TR/SVG2/text.html#TextLayoutAlgorithm.\n    // The difference is that we apply the anchoring as soon as a chunk is finished. This saves some extra looping.\n    // Vertical text is not supported.\n\n    const firstElement = this.leafTexts[this.textChunkStart]\n    const textAnchor = firstElement.getStyle('text-anchor').getString('start')\n    const isRTL = false // we treat RTL like LTR\n    let shift = 0\n\n    if (textAnchor === 'start' && !isRTL || textAnchor === 'end' && isRTL) {\n      shift = firstElement.x - this.minX\n    } else if (textAnchor === 'end' && !isRTL || textAnchor === 'start' && isRTL) {\n      shift = firstElement.x - this.maxX\n    } else {\n      shift = firstElement.x - (this.minX + this.maxX) / 2\n    }\n\n    for (let i = this.textChunkStart; i < this.leafTexts.length; i++) {\n      this.leafTexts[i].x += shift\n    }\n\n    // start new chunk\n    this.minX = Number.POSITIVE_INFINITY\n    this.maxX = Number.NEGATIVE_INFINITY\n    this.textChunkStart = this.leafTexts.length\n  }\n\n  protected adjustChildCoordinatesRecursive(ctx: RenderingContext2D) {\n    this.children.forEach((_, i) => {\n      this.adjustChildCoordinatesRecursiveCore(ctx, this, this, i)\n    })\n    this.applyAnchoring()\n  }\n\n  protected adjustChildCoordinatesRecursiveCore(\n    ctx: RenderingContext2D,\n    textParent: TextElement,\n    parent: Element,\n    i: number\n  ): void {\n    const child = parent.children[i] as TextElement\n\n    if (child.children.length > 0) {\n      child.children.forEach((_, i) => {\n        textParent.adjustChildCoordinatesRecursiveCore(ctx, textParent, child, i)\n      })\n    } else {\n      // only leafs are relevant\n      this.adjustChildCoordinates(ctx, textParent, parent, i)\n    }\n  }\n\n  protected adjustChildCoordinates(\n    ctx: RenderingContext2D,\n    textParent: TextElement,\n    parent: Element,\n    i: number\n  ) {\n    const child = parent.children[i] as TextElement\n\n    if (typeof child.measureText !== 'function') {\n      return child\n    }\n\n    ctx.save()\n    child.setContext(ctx, true)\n\n    const xAttr = child.getAttribute('x')\n    const yAttr = child.getAttribute('y')\n    const dxAttr = child.getAttribute('dx')\n    const dyAttr = child.getAttribute('dy')\n    const customFont = child.getStyle('font-family').getDefinition<FontElement>()\n    const isRTL = Boolean(customFont?.isRTL)\n\n    if (i === 0) {\n      // First children inherit attributes from parent(s). Positional attributes\n      // are only inherited from a parent to it's first child.\n      if (!xAttr.hasValue()) {\n        xAttr.setValue(child.getInheritedAttribute('x'))\n      }\n\n      if (!yAttr.hasValue()) {\n        yAttr.setValue(child.getInheritedAttribute('y'))\n      }\n\n      if (!dxAttr.hasValue()) {\n        dxAttr.setValue(child.getInheritedAttribute('dx'))\n      }\n\n      if (!dyAttr.hasValue()) {\n        dyAttr.setValue(child.getInheritedAttribute('dy'))\n      }\n    }\n\n    const width = child.measureText(ctx)\n\n    if (isRTL) {\n      textParent.x -= width\n    }\n\n    if (xAttr.hasValue()) {\n      // an \"x\" attribute marks the start of a new chunk\n      textParent.applyAnchoring()\n\n      child.x = xAttr.getPixels('x')\n\n      if (dxAttr.hasValue()) {\n        child.x += dxAttr.getPixels('x')\n      }\n    } else {\n      if (dxAttr.hasValue()) {\n        textParent.x += dxAttr.getPixels('x')\n      }\n\n      child.x = textParent.x\n    }\n\n    textParent.x = child.x\n\n    if (!isRTL) {\n      textParent.x += width\n    }\n\n    if (yAttr.hasValue()) {\n      child.y = yAttr.getPixels('y')\n\n      if (dyAttr.hasValue()) {\n        child.y += dyAttr.getPixels('y')\n      }\n    } else {\n      if (dyAttr.hasValue()) {\n        textParent.y += dyAttr.getPixels('y')\n      }\n\n      child.y = textParent.y\n    }\n\n    textParent.y = child.y\n\n    // update the current chunk and it's bounds\n    textParent.leafTexts.push(child)\n    textParent.minX = Math.min(textParent.minX, child.x, child.x + width)\n    textParent.maxX = Math.max(textParent.maxX, child.x, child.x + width)\n\n    child.clearContext(ctx)\n    ctx.restore()\n\n    return child\n  }\n\n  protected getChildBoundingBox(\n    ctx: RenderingContext2D,\n    textParent: TextElement,\n    parent: Element,\n    i: number\n  ) {\n    const child = parent.children[i] as TextElement\n\n    // not a text node?\n    if (typeof child.getBoundingBox !== 'function') {\n      return null\n    }\n\n    const boundingBox = child.getBoundingBox(ctx)\n\n    if (boundingBox) {\n      child.children.forEach((_, i) => {\n        const childBoundingBox = textParent.getChildBoundingBox(ctx, textParent, child, i)\n\n        boundingBox.addBoundingBox(childBoundingBox)\n      })\n    }\n\n    return boundingBox\n  }\n\n  protected renderChild(\n    ctx: RenderingContext2D,\n    textParent: TextElement,\n    parent: Element,\n    i: number\n  ) {\n    const child = parent.children[i] as TextElement\n\n    child.render(ctx)\n    child.children.forEach((_, i) => {\n      textParent.renderChild(ctx, textParent, child, i)\n    })\n  }\n\n  protected measureText(ctx: RenderingContext2D) {\n    const { measureCache } = this\n\n    if (~measureCache) {\n      return measureCache\n    }\n\n    const renderText = this.getText()\n    const measure = this.measureTargetText(ctx, renderText)\n\n    this.measureCache = measure\n\n    return measure\n  }\n\n  protected measureTargetText(\n    ctx: RenderingContext2D,\n    targetText: string\n  ) {\n    if (!targetText.length) {\n      return 0\n    }\n\n    const { parent } = this\n    const customFont = parent.getStyle('font-family').getDefinition<FontElement>()\n\n    if (customFont) {\n      const fontSize = this.getFontSize()\n      const text = customFont.isRTL\n        ? targetText.split('').reverse().join('')\n        : targetText\n      const dx = toNumbers(parent.getAttribute('dx').getString())\n      const len = text.length\n      let measure = 0\n\n      for (let i = 0; i < len; i++) {\n        const glyph = this.getGlyph(customFont, text, i)\n\n        measure += (glyph.horizAdvX || customFont.horizAdvX)\n          * fontSize\n          / customFont.fontFace.unitsPerEm\n\n        if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n          measure += dx[i]\n        }\n      }\n\n      return measure\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (!ctx.measureText) {\n      return targetText.length * 10\n    }\n\n    ctx.save()\n    this.setContext(ctx, true)\n\n    const { width: measure } = ctx.measureText(targetText)\n\n    this.clearContext(ctx)\n    ctx.restore()\n\n    return measure\n  }\n\n  /**\n   * Inherits positional attributes from {@link TextElement} parent(s). Attributes\n   * are only inherited from a parent to its first child.\n   * @param name - The attribute name.\n   * @returns The attribute value or null.\n   */\n  protected getInheritedAttribute(name: string): string | null {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias,consistent-this\n    let current: Element | null = this\n\n    while (current instanceof TextElement && current.isFirstChild() && current.parent) {\n      const parentAttr = current.parent.getAttribute(name)\n\n      if (parentAttr.hasValue(true)) {\n        return parentAttr.getString('0')\n      }\n\n      current = current.parent\n    }\n\n    return null\n  }\n}\n", "import { Document } from './Document'\nimport { TextElement } from './TextElement'\n\nexport class TSpanElement extends TextElement {\n  override type = 'tspan'\n  protected readonly text: string\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(\n      document,\n      node,\n      new.target === TSpanElement\n        ? true\n        : captureTextNodes\n    )\n\n    // if this node has children, then they own the text\n    this.text = this.children.length > 0\n      ? ''\n      : this.getTextFromNode()\n  }\n\n  override getText() {\n    return this.text\n  }\n}\n", "import { TSpanElement } from './TSpanElement'\n\nexport class TextNode extends TSpanElement {\n  override type = 'textNode'\n}\n", "import {\n  SVGCommand,\n  CommandM,\n  CommandL,\n  CommandH,\n  CommandV,\n  CommandZ,\n  CommandQ,\n  CommandT,\n  CommandC,\n  CommandS,\n  CommandA\n} from 'svg-pathdata/lib/types'\nimport { SVGPathData } from 'svg-pathdata'\nimport { Point } from './Point'\n\nexport type CommandType = SVGCommand['type']\nexport type Command = { type: CommandType }\n  & Omit<CommandM, 'type'>\n  & Omit<CommandL, 'type'>\n  & Omit<CommandH, 'type'>\n  & Omit<CommandV, 'type'>\n  & Omit<CommandZ, 'type'>\n  & Omit<CommandQ, 'type'>\n  & Omit<CommandT, 'type'>\n  & Omit<CommandC, 'type'>\n  & Omit<CommandS, 'type'>\n  & Omit<CommandA, 'type'>\n\nexport class PathParser extends SVGPathData {\n  control: Point = new Point(0, 0)\n  start: Point = new Point(0, 0)\n  current: Point = new Point(0, 0)\n  command: Command | null = null\n  override readonly commands: Command[] /* Babel fix: */ = this.commands\n  private i = -1\n  private previousCommand: Command | null = null\n  private points: Point[] = []\n  private angles: (number | null)[] = []\n\n  constructor(path: string) {\n    super(\n      path\n        // Fix spaces after signs.\n        .replace(/([+\\-.])\\s+/gm, '$1')\n        // Remove invalid part.\n        .replace(/[^MmZzLlHhVvCcSsQqTtAae\\d\\s.,+-].*/g, '')\n    )\n  }\n\n  reset() {\n    this.i = -1\n    this.command = null\n    this.previousCommand = null\n    this.start = new Point(0, 0)\n    this.control = new Point(0, 0)\n    this.current = new Point(0, 0)\n    this.points = []\n    this.angles = []\n  }\n\n  isEnd() {\n    const {\n      i,\n      commands\n    } = this\n\n    return i >= commands.length - 1\n  }\n\n  next() {\n    const command = this.commands[++this.i]\n\n    this.previousCommand = this.command\n    this.command = command\n\n    return command\n  }\n\n  getPoint(xProp = 'x', yProp = 'y') {\n    const point = new Point(\n      this.command[xProp] as number,\n      this.command[yProp] as number\n    )\n\n    return this.makeAbsolute(point)\n  }\n\n  getAsControlPoint(xProp?: string, yProp?: string) {\n    const point = this.getPoint(xProp, yProp)\n\n    this.control = point\n\n    return point\n  }\n\n  getAsCurrentPoint(xProp?: string, yProp?: string) {\n    const point = this.getPoint(xProp, yProp)\n\n    this.current = point\n\n    return point\n  }\n\n  getReflectedControlPoint() {\n    const previousCommand = this.previousCommand.type\n\n    if (previousCommand !== SVGPathData.CURVE_TO\n      && previousCommand !== SVGPathData.SMOOTH_CURVE_TO\n      && previousCommand !== SVGPathData.QUAD_TO\n      && previousCommand !== SVGPathData.SMOOTH_QUAD_TO\n    ) {\n      return this.current\n    }\n\n    // reflect point\n    const {\n      current: {\n        x: cx,\n        y: cy\n      },\n      control: {\n        x: ox,\n        y: oy\n      }\n    } = this\n    const point = new Point(2 * cx - ox, 2 * cy - oy)\n\n    return point\n  }\n\n  makeAbsolute(point: Point) {\n    if (this.command.relative) {\n      const {\n        x,\n        y\n      } = this.current\n\n      point.x += x\n      point.y += y\n    }\n\n    return point\n  }\n\n  addMarker(point: Point, from?: Point, priorTo?: Point) {\n    const {\n      points,\n      angles\n    } = this\n\n    // if the last angle isn't filled in because we didn't have this point yet ...\n    if (priorTo && angles.length > 0 && !angles[angles.length - 1]) {\n      angles[angles.length - 1] = points[points.length - 1].angleTo(priorTo)\n    }\n\n    this.addMarkerAngle(point, from ? from.angleTo(point) : null)\n  }\n\n  addMarkerAngle(point: Point, angle: number) {\n    this.points.push(point)\n    this.angles.push(angle)\n  }\n\n  getMarkerPoints() {\n    return this.points\n  }\n\n  getMarkerAngles() {\n    const { angles } = this\n    const len = angles.length\n\n    for (let i = 0; i < len; i++) {\n      if (!angles[i]) {\n        for (let j = i + 1; j < len; j++) {\n          if (angles[j]) {\n            angles[i] = angles[j]\n            break\n          }\n        }\n      }\n    }\n\n    return angles\n  }\n}\n", "/* eslint-disable @typescript-eslint/member-ordering */\nimport { RenderingContext2D } from '../types'\nimport {\n  vectorsRatio,\n  vectorsAngle\n} from '../util'\nimport { Point } from '../Point'\nimport { BoundingBox } from '../BoundingBox'\nimport { PathParser } from '../PathParser'\nimport { Document } from './Document'\nimport { RenderedElement } from './RenderedElement'\nimport { MarkerElement } from './MarkerElement'\n\nexport type Marker = [Point, number]\n\nexport class PathElement extends RenderedElement {\n  override type = 'path'\n  readonly pathParser: PathParser\n\n  constructor(\n    document: Document,\n    node?: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.pathParser = new PathParser(this.getAttribute('d').getString())\n  }\n\n  path(ctx?: RenderingContext2D) {\n    const { pathParser } = this\n    const boundingBox = new BoundingBox()\n\n    pathParser.reset()\n\n    if (ctx) {\n      ctx.beginPath()\n    }\n\n    while (!pathParser.isEnd()) {\n      switch (pathParser.next().type) {\n        case PathParser.MOVE_TO:\n          this.pathM(ctx, boundingBox)\n          break\n\n        case PathParser.LINE_TO:\n          this.pathL(ctx, boundingBox)\n          break\n\n        case PathParser.HORIZ_LINE_TO:\n          this.pathH(ctx, boundingBox)\n          break\n\n        case PathParser.VERT_LINE_TO:\n          this.pathV(ctx, boundingBox)\n          break\n\n        case PathParser.CURVE_TO:\n          this.pathC(ctx, boundingBox)\n          break\n\n        case PathParser.SMOOTH_CURVE_TO:\n          this.pathS(ctx, boundingBox)\n          break\n\n        case PathParser.QUAD_TO:\n          this.pathQ(ctx, boundingBox)\n          break\n\n        case PathParser.SMOOTH_QUAD_TO:\n          this.pathT(ctx, boundingBox)\n          break\n\n        case PathParser.ARC:\n          this.pathA(ctx, boundingBox)\n          break\n\n        case PathParser.CLOSE_PATH:\n          this.pathZ(ctx, boundingBox)\n          break\n\n        default:\n      }\n    }\n\n    return boundingBox\n  }\n\n  getBoundingBox(_ctx: RenderingContext2D) {\n    return this.path()\n  }\n\n  getMarkers(): Marker[] {\n    const { pathParser } = this\n    const points = pathParser.getMarkerPoints()\n    const angles = pathParser.getMarkerAngles()\n    const markers = points.map((point, i): Marker => [point, angles[i]])\n\n    return markers\n  }\n\n  override renderChildren(ctx: RenderingContext2D) {\n    this.path(ctx)\n    this.document.screen.mouse.checkPath(this, ctx)\n\n    const fillRuleStyleProp = this.getStyle('fill-rule')\n\n    if (ctx.fillStyle !== '') {\n      if (fillRuleStyleProp.getString('inherit') !== 'inherit') {\n        ctx.fill(fillRuleStyleProp.getString() as CanvasFillRule)\n      } else {\n        ctx.fill()\n      }\n    }\n\n    if (ctx.strokeStyle !== '') {\n      if (this.getAttribute('vector-effect').getString() === 'non-scaling-stroke') {\n        ctx.save()\n        ctx.setTransform(1, 0, 0, 1, 0, 0)\n        ctx.stroke()\n        ctx.restore()\n      } else {\n        ctx.stroke()\n      }\n    }\n\n    const markers = this.getMarkers()\n\n    if (markers) {\n      const markersLastIndex = markers.length - 1\n      const markerStartStyleProp = this.getStyle('marker-start')\n      const markerMidStyleProp = this.getStyle('marker-mid')\n      const markerEndStyleProp = this.getStyle('marker-end')\n\n      if (markerStartStyleProp.isUrlDefinition()) {\n        const marker = markerStartStyleProp.getDefinition<MarkerElement>()\n        const [point, angle] = markers[0]\n\n        marker.render(ctx, point, angle)\n      }\n\n      if (markerMidStyleProp.isUrlDefinition()) {\n        const marker = markerMidStyleProp.getDefinition<MarkerElement>()\n\n        for (let i = 1; i < markersLastIndex; i++) {\n          const [point, angle] = markers[i]\n\n          marker.render(ctx, point, angle)\n        }\n      }\n\n      if (markerEndStyleProp.isUrlDefinition()) {\n        const marker = markerEndStyleProp.getDefinition<MarkerElement>()\n        const [point, angle] = markers[markersLastIndex]\n\n        marker.render(ctx, point, angle)\n      }\n    }\n  }\n\n  static pathM(pathParser: PathParser) {\n    const point = pathParser.getAsCurrentPoint()\n\n    pathParser.start = pathParser.current\n\n    return {\n      point\n    }\n  }\n\n  protected pathM(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const { point } = PathElement.pathM(pathParser)\n    const {\n      x,\n      y\n    } = point\n\n    pathParser.addMarker(point)\n    boundingBox.addPoint(x, y)\n\n    if (ctx) {\n      ctx.moveTo(x, y)\n    }\n  }\n\n  static pathL(pathParser: PathParser) {\n    const { current } = pathParser\n    const point = pathParser.getAsCurrentPoint()\n\n    return {\n      current,\n      point\n    }\n  }\n\n  protected pathL(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      point\n    } = PathElement.pathL(pathParser)\n    const {\n      x,\n      y\n    } = point\n\n    pathParser.addMarker(point, current)\n    boundingBox.addPoint(x, y)\n\n    if (ctx) {\n      ctx.lineTo(x, y)\n    }\n  }\n\n  static pathH(pathParser: PathParser) {\n    const {\n      current,\n      command\n    } = pathParser\n    const point = new Point(\n      (command.relative ? current.x : 0) + command.x,\n      current.y\n    )\n\n    pathParser.current = point\n\n    return {\n      current,\n      point\n    }\n  }\n\n  protected pathH(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      point\n    } = PathElement.pathH(pathParser)\n    const {\n      x,\n      y\n    } = point\n\n    pathParser.addMarker(point, current)\n    boundingBox.addPoint(x, y)\n\n    if (ctx) {\n      ctx.lineTo(x, y)\n    }\n  }\n\n  static pathV(pathParser: PathParser) {\n    const {\n      current,\n      command\n    } = pathParser\n    const point = new Point(\n      current.x,\n      (command.relative ? current.y : 0) + command.y\n    )\n\n    pathParser.current = point\n\n    return {\n      current,\n      point\n    }\n  }\n\n  protected pathV(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      point\n    } = PathElement.pathV(pathParser)\n    const {\n      x,\n      y\n    } = point\n\n    pathParser.addMarker(point, current)\n    boundingBox.addPoint(x, y)\n\n    if (ctx) {\n      ctx.lineTo(x, y)\n    }\n  }\n\n  static pathC(pathParser: PathParser) {\n    const { current } = pathParser\n    const point = pathParser.getPoint('x1', 'y1')\n    const controlPoint = pathParser.getAsControlPoint('x2', 'y2')\n    const currentPoint = pathParser.getAsCurrentPoint()\n\n    return {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    }\n  }\n\n  protected pathC(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathC(pathParser)\n\n    pathParser.addMarker(currentPoint, controlPoint, point)\n    boundingBox.addBezierCurve(\n      current.x,\n      current.y,\n      point.x,\n      point.y,\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n\n    if (ctx) {\n      ctx.bezierCurveTo(\n        point.x,\n        point.y,\n        controlPoint.x,\n        controlPoint.y,\n        currentPoint.x,\n        currentPoint.y\n      )\n    }\n  }\n\n  static pathS(pathParser: PathParser) {\n    const { current } = pathParser\n    const point = pathParser.getReflectedControlPoint()\n    const controlPoint = pathParser.getAsControlPoint('x2', 'y2')\n    const currentPoint = pathParser.getAsCurrentPoint()\n\n    return {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    }\n  }\n\n  protected pathS(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathS(pathParser)\n\n    pathParser.addMarker(currentPoint, controlPoint, point)\n    boundingBox.addBezierCurve(\n      current.x,\n      current.y,\n      point.x,\n      point.y,\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n\n    if (ctx) {\n      ctx.bezierCurveTo(\n        point.x,\n        point.y,\n        controlPoint.x,\n        controlPoint.y,\n        currentPoint.x,\n        currentPoint.y\n      )\n    }\n  }\n\n  static pathQ(pathParser: PathParser) {\n    const { current } = pathParser\n    const controlPoint = pathParser.getAsControlPoint('x1', 'y1')\n    const currentPoint = pathParser.getAsCurrentPoint()\n\n    return {\n      current,\n      controlPoint,\n      currentPoint\n    }\n  }\n\n  protected pathQ(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathQ(pathParser)\n\n    pathParser.addMarker(currentPoint, controlPoint, controlPoint)\n    boundingBox.addQuadraticCurve(\n      current.x,\n      current.y,\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n\n    if (ctx) {\n      ctx.quadraticCurveTo(\n        controlPoint.x,\n        controlPoint.y,\n        currentPoint.x,\n        currentPoint.y\n      )\n    }\n  }\n\n  static pathT(pathParser: PathParser) {\n    const { current } = pathParser\n    const controlPoint = pathParser.getReflectedControlPoint()\n\n    pathParser.control = controlPoint\n\n    const currentPoint = pathParser.getAsCurrentPoint()\n\n    return {\n      current,\n      controlPoint,\n      currentPoint\n    }\n  }\n\n  protected pathT(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      current,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathT(pathParser)\n\n    pathParser.addMarker(currentPoint, controlPoint, controlPoint)\n    boundingBox.addQuadraticCurve(\n      current.x,\n      current.y,\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n\n    if (ctx) {\n      ctx.quadraticCurveTo(\n        controlPoint.x,\n        controlPoint.y,\n        currentPoint.x,\n        currentPoint.y\n      )\n    }\n  }\n\n  static pathA(pathParser: PathParser) {\n    const {\n      current,\n      command\n    } = pathParser\n    let {\n      rX,\n      rY,\n      xRot,\n      lArcFlag,\n      sweepFlag\n    } = command\n    const xAxisRotation = xRot * (Math.PI / 180.0)\n    const currentPoint = pathParser.getAsCurrentPoint()\n    // Conversion from endpoint to center parameterization\n    // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n    // x1', y1'\n    const currp = new Point(\n      Math.cos(xAxisRotation) * (current.x - currentPoint.x) / 2.0\n      + Math.sin(xAxisRotation) * (current.y - currentPoint.y) / 2.0,\n      -Math.sin(xAxisRotation) * (current.x - currentPoint.x) / 2.0\n      + Math.cos(xAxisRotation) * (current.y - currentPoint.y) / 2.0\n    )\n    // adjust radii\n    const l =\n      Math.pow(currp.x, 2) / Math.pow(rX, 2)\n      + Math.pow(currp.y, 2) / Math.pow(rY, 2)\n\n    if (l > 1) {\n      rX *= Math.sqrt(l)\n      rY *= Math.sqrt(l)\n    }\n\n    // cx', cy'\n    let s = (lArcFlag === sweepFlag ? -1 : 1) * Math.sqrt(\n      (\n        (Math.pow(rX, 2) * Math.pow(rY, 2))\n        - (Math.pow(rX, 2) * Math.pow(currp.y, 2))\n        - (Math.pow(rY, 2) * Math.pow(currp.x, 2))\n      ) / (\n        Math.pow(rX, 2) * Math.pow(currp.y, 2)\n        + Math.pow(rY, 2) * Math.pow(currp.x, 2)\n      )\n    )\n\n    if (isNaN(s)) {\n      s = 0\n    }\n\n    const cpp = new Point(\n      s * rX * currp.y / rY,\n      s * -rY * currp.x / rX\n    )\n    // cx, cy\n    const centp = new Point(\n      (current.x + currentPoint.x) / 2.0\n      + Math.cos(xAxisRotation) * cpp.x\n      - Math.sin(xAxisRotation) * cpp.y,\n      (current.y + currentPoint.y) / 2.0\n      + Math.sin(xAxisRotation) * cpp.x\n      + Math.cos(xAxisRotation) * cpp.y\n    )\n    // initial angle\n    const a1 = vectorsAngle([1, 0], [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY]) // \u03B81\n    // angle delta\n    const u = [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY] as const\n    const v = [(-currp.x - cpp.x) / rX, (-currp.y - cpp.y) / rY] as const\n    let ad = vectorsAngle(u, v) // \u0394\u03B8\n\n    if (vectorsRatio(u, v) <= -1) {\n      ad = Math.PI\n    }\n\n    if (vectorsRatio(u, v) >= 1) {\n      ad = 0\n    }\n\n    return {\n      currentPoint,\n      rX,\n      rY,\n      sweepFlag,\n      xAxisRotation,\n      centp,\n      a1,\n      ad\n    }\n  }\n\n  protected pathA(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    const { pathParser } = this\n    const {\n      currentPoint,\n      rX,\n      rY,\n      sweepFlag,\n      xAxisRotation,\n      centp,\n      a1,\n      ad\n    } = PathElement.pathA(pathParser)\n    // for markers\n    const dir = 1 - sweepFlag ? 1.0 : -1.0\n    const ah = a1 + dir * (ad / 2.0)\n    const halfWay = new Point(\n      centp.x + rX * Math.cos(ah),\n      centp.y + rY * Math.sin(ah)\n    )\n\n    pathParser.addMarkerAngle(halfWay, ah - dir * Math.PI / 2)\n    pathParser.addMarkerAngle(currentPoint, ah - dir * Math.PI)\n    boundingBox.addPoint(currentPoint.x, currentPoint.y) // TODO: this is too naive, make it better\n\n    if (ctx && !isNaN(a1) && !isNaN(ad)) {\n      const r = rX > rY ? rX : rY\n      const sx = rX > rY ? 1 : rX / rY\n      const sy = rX > rY ? rY / rX : 1\n\n      ctx.translate(centp.x, centp.y)\n      ctx.rotate(xAxisRotation)\n      ctx.scale(sx, sy)\n      ctx.arc(0, 0, r, a1, a1 + ad, Boolean(1 - sweepFlag))\n      ctx.scale(1 / sx, 1 / sy)\n      ctx.rotate(-xAxisRotation)\n      ctx.translate(-centp.x, -centp.y)\n    }\n  }\n\n  static pathZ(pathParser: PathParser) {\n    pathParser.current = pathParser.start\n  }\n\n  protected pathZ(\n    ctx: RenderingContext2D | undefined,\n    boundingBox: BoundingBox\n  ) {\n    PathElement.pathZ(this.pathParser)\n\n    if (ctx) {\n      // only close path if it is not a straight line\n      if (boundingBox.x1 !== boundingBox.x2\n        && boundingBox.y1 !== boundingBox.y2\n      ) {\n        ctx.closePath()\n      }\n    }\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { toNumbers } from '../util'\nimport { Property } from '../Property'\nimport { Font } from '../Font'\nimport { RenderedElement } from './RenderedElement'\n\nexport class SVGElement extends RenderedElement {\n  override type = 'svg'\n  root = false\n\n  override setContext(ctx: RenderingContext2D) {\n    const { document } = this\n    const {\n      screen,\n      window\n    } = document\n    const canvas = ctx.canvas\n\n    screen.setDefaults(ctx)\n\n    if ('style' in canvas\n      && typeof ctx.font !== 'undefined'\n      && window\n      && typeof window.getComputedStyle !== 'undefined'\n    ) {\n      ctx.font = window.getComputedStyle(canvas).getPropertyValue('font')\n\n      const fontSizeProp = new Property(\n        document,\n        'fontSize',\n        Font.parse(ctx.font).fontSize\n      )\n\n      if (fontSizeProp.hasValue()) {\n        document.rootEmSize = fontSizeProp.getPixels('y')\n        document.emSize = document.rootEmSize\n      }\n    }\n\n    // create new view port\n    if (!this.getAttribute('x').hasValue()) {\n      this.getAttribute('x', true).setValue(0)\n    }\n\n    if (!this.getAttribute('y').hasValue()) {\n      this.getAttribute('y', true).setValue(0)\n    }\n\n    let {\n      width,\n      height\n    } = screen.viewPort\n\n    if (!this.getStyle('width').hasValue()) {\n      this.getStyle('width', true).setValue('100%')\n    }\n\n    if (!this.getStyle('height').hasValue()) {\n      this.getStyle('height', true).setValue('100%')\n    }\n\n    if (!this.getStyle('color').hasValue()) {\n      this.getStyle('color', true).setValue('black')\n    }\n\n    const refXAttr = this.getAttribute('refX')\n    const refYAttr = this.getAttribute('refY')\n    const viewBoxAttr = this.getAttribute('viewBox')\n    const viewBox = viewBoxAttr.hasValue()\n      ? toNumbers(viewBoxAttr.getString())\n      : null\n    const clip = !this.root\n      && this.getStyle('overflow').getValue('hidden') !== 'visible'\n    let minX = 0\n    let minY = 0\n    let clipX = 0\n    let clipY = 0\n\n    if (viewBox) {\n      minX = viewBox[0]\n      minY = viewBox[1]\n    }\n\n    if (!this.root) {\n      width = this.getStyle('width').getPixels('x')\n      height = this.getStyle('height').getPixels('y')\n\n      if (this.type === 'marker') {\n        clipX = minX\n        clipY = minY\n        minX = 0\n        minY = 0\n      }\n    }\n\n    screen.viewPort.setCurrent(width, height)\n\n    // Default value of transform-origin is center only for root SVG elements\n    // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform-origin\n    if (this.node // is not temporary SVGElement\n      && (!this.parent || this.node.parentNode?.nodeName === 'foreignObject')\n      && this.getStyle('transform', false, true).hasValue()\n      && !this.getStyle('transform-origin', false, true).hasValue()\n    ) {\n      this.getStyle('transform-origin', true, true).setValue('50% 50%')\n    }\n\n    super.setContext(ctx)\n\n    ctx.translate(\n      this.getAttribute('x').getPixels('x'),\n      this.getAttribute('y').getPixels('y')\n    )\n\n    if (viewBox) {\n      width = viewBox[2]\n      height = viewBox[3]\n    }\n\n    document.setViewBox({\n      ctx,\n      aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n      width: screen.viewPort.width,\n      desiredWidth: width,\n      height: screen.viewPort.height,\n      desiredHeight: height,\n      minX,\n      minY,\n      refX: refXAttr.getValue() as number,\n      refY: refYAttr.getValue() as number,\n      clip,\n      clipX,\n      clipY\n    })\n\n    if (viewBox) {\n      screen.viewPort.removeCurrent()\n      screen.viewPort.setCurrent(width, height)\n    }\n  }\n\n  override clearContext(ctx: RenderingContext2D) {\n    super.clearContext(ctx)\n\n    this.document.screen.viewPort.removeCurrent()\n  }\n\n  /**\n   * Resize SVG to fit in given size.\n   * @param width\n   * @param height\n   * @param preserveAspectRatio\n   */\n  resize(\n    width: number,\n    height = width,\n    preserveAspectRatio: boolean | string = false\n  ) {\n    const widthAttr = this.getAttribute('width', true)\n    const heightAttr = this.getAttribute('height', true)\n    const viewBoxAttr = this.getAttribute('viewBox')\n    const styleAttr = this.getAttribute('style')\n    const originWidth = widthAttr.getNumber(0)\n    const originHeight = heightAttr.getNumber(0)\n\n    if (preserveAspectRatio) {\n      if (typeof preserveAspectRatio === 'string') {\n        this.getAttribute('preserveAspectRatio', true).setValue(preserveAspectRatio)\n      } else {\n        const preserveAspectRatioAttr = this.getAttribute('preserveAspectRatio')\n\n        if (preserveAspectRatioAttr.hasValue()) {\n          preserveAspectRatioAttr.setValue(preserveAspectRatioAttr.getString().replace(/^\\s*(\\S.*\\S)\\s*$/, '$1'))\n        }\n      }\n    }\n\n    widthAttr.setValue(width)\n    heightAttr.setValue(height)\n\n    if (!viewBoxAttr.hasValue()) {\n      viewBoxAttr.setValue(`0 0 ${originWidth || width} ${originHeight || height}`)\n    }\n\n    if (styleAttr.hasValue()) {\n      const widthStyle = this.getStyle('width')\n      const heightStyle = this.getStyle('height')\n\n      if (widthStyle.hasValue()) {\n        widthStyle.setValue(`${width}px`)\n      }\n\n      if (heightStyle.hasValue()) {\n        heightStyle.setValue(`${height}px`)\n      }\n    }\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { BoundingBox } from '../BoundingBox'\nimport { PathElement } from './PathElement'\n\nexport class RectElement extends PathElement {\n  override type = 'rect'\n\n  override path(ctx: RenderingContext2D) {\n    const x = this.getAttribute('x').getPixels('x')\n    const y = this.getAttribute('y').getPixels('y')\n    const width = this.getStyle('width', false, true).getPixels('x')\n    const height = this.getStyle('height', false, true).getPixels('y')\n    const rxAttr = this.getAttribute('rx')\n    const ryAttr = this.getAttribute('ry')\n    let rx = rxAttr.getPixels('x')\n    let ry = ryAttr.getPixels('y')\n\n    if (rxAttr.hasValue() && !ryAttr.hasValue()) {\n      ry = rx\n    }\n\n    if (ryAttr.hasValue() && !rxAttr.hasValue()) {\n      rx = ry\n    }\n\n    rx = Math.min(rx, width / 2.0)\n    ry = Math.min(ry, height / 2.0)\n\n    if (ctx) {\n      const KAPPA = 4 * ((Math.sqrt(2) - 1) / 3)\n\n      ctx.beginPath() // always start the path so we don't fill prior paths\n\n      if (height > 0 && width > 0) {\n        ctx.moveTo(x + rx, y)\n        ctx.lineTo(x + width - rx, y)\n        ctx.bezierCurveTo(x + width - rx + (KAPPA * rx), y, x + width, y + ry - (KAPPA * ry), x + width, y + ry)\n        ctx.lineTo(x + width, y + height - ry)\n        ctx.bezierCurveTo(\n          x + width,\n          y + height - ry + (KAPPA * ry),\n          x + width - rx + (KAPPA * rx),\n          y + height,\n          x + width - rx,\n          y + height\n        )\n        ctx.lineTo(x + rx, y + height)\n        ctx.bezierCurveTo(x + rx - (KAPPA * rx), y + height, x, y + height - ry + (KAPPA * ry), x, y + height - ry)\n        ctx.lineTo(x, y + ry)\n        ctx.bezierCurveTo(x, y + ry - (KAPPA * ry), x + rx - (KAPPA * rx), y, x + rx, y)\n        ctx.closePath()\n      }\n    }\n\n    return new BoundingBox(x, y, x + width, y + height)\n  }\n\n  override getMarkers() {\n    return null\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { BoundingBox } from '../BoundingBox'\nimport { PathElement } from './PathElement'\n\nexport class CircleElement extends PathElement {\n  override type = 'circle'\n\n  override path(ctx: RenderingContext2D) {\n    const cx = this.getAttribute('cx').getPixels('x')\n    const cy = this.getAttribute('cy').getPixels('y')\n    const r = this.getAttribute('r').getPixels()\n\n    if (ctx && r > 0) {\n      ctx.beginPath()\n      ctx.arc(cx, cy, r, 0, Math.PI * 2, false)\n      ctx.closePath()\n    }\n\n    return new BoundingBox(\n      cx - r,\n      cy - r,\n      cx + r,\n      cy + r\n    )\n  }\n\n  override getMarkers() {\n    return null\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { BoundingBox } from '../BoundingBox'\nimport { PathElement } from './PathElement'\n\nexport class EllipseElement extends PathElement {\n  override type = 'ellipse'\n\n  override path(ctx: RenderingContext2D) {\n    const KAPPA = 4 * ((Math.sqrt(2) - 1) / 3)\n    const rx = this.getAttribute('rx').getPixels('x')\n    const ry = this.getAttribute('ry').getPixels('y')\n    const cx = this.getAttribute('cx').getPixels('x')\n    const cy = this.getAttribute('cy').getPixels('y')\n\n    if (ctx && rx > 0 && ry > 0) {\n      ctx.beginPath()\n      ctx.moveTo(cx + rx, cy)\n      ctx.bezierCurveTo(\n        cx + rx,\n        cy + (KAPPA * ry),\n        cx + (KAPPA * rx),\n        cy + ry,\n        cx,\n        cy + ry\n      )\n      ctx.bezierCurveTo(\n        cx - (KAPPA * rx),\n        cy + ry,\n        cx - rx,\n        cy + (KAPPA * ry),\n        cx - rx,\n        cy\n      )\n      ctx.bezierCurveTo(\n        cx - rx,\n        cy - (KAPPA * ry),\n        cx - (KAPPA * rx),\n        cy - ry,\n        cx,\n        cy - ry\n      )\n      ctx.bezierCurveTo(\n        cx + (KAPPA * rx),\n        cy - ry,\n        cx + rx,\n        cy - (KAPPA * ry),\n        cx + rx,\n        cy\n      )\n      ctx.closePath()\n    }\n\n    return new BoundingBox(\n      cx - rx,\n      cy - ry,\n      cx + rx,\n      cy + ry\n    )\n  }\n\n  override getMarkers() {\n    return null\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Point } from '../Point'\nimport { BoundingBox } from '../BoundingBox'\nimport { PathElement, Marker } from './PathElement'\n\nexport class LineElement extends PathElement {\n  override type = 'line'\n\n  getPoints() {\n    return [\n      new Point(\n        this.getAttribute('x1').getPixels('x'),\n        this.getAttribute('y1').getPixels('y')\n      ),\n      new Point(\n        this.getAttribute('x2').getPixels('x'),\n        this.getAttribute('y2').getPixels('y')\n      )\n    ]\n  }\n\n  override path(ctx: RenderingContext2D) {\n    const [\n      {\n        x: x0,\n        y: y0\n      },\n      {\n        x: x1,\n        y: y1\n      }\n    ] = this.getPoints()\n\n    if (ctx) {\n      ctx.beginPath()\n      ctx.moveTo(x0, y0)\n      ctx.lineTo(x1, y1)\n    }\n\n    return new BoundingBox(\n      x0,\n      y0,\n      x1,\n      y1\n    )\n  }\n\n  override getMarkers(): Marker[] {\n    const [p0, p1] = this.getPoints()\n    const a = p0.angleTo(p1)\n\n    return [[p0, a], [p1, a]]\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Point } from '../Point'\nimport { BoundingBox } from '../BoundingBox'\nimport { Document } from './Document'\nimport { PathElement, Marker } from './PathElement'\n\nexport class PolylineElement extends PathElement {\n  override type = 'polyline'\n  protected readonly points: Point[] = []\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.points = Point.parsePath(\n      this.getAttribute('points').getString()\n    )\n  }\n\n  override path(ctx: RenderingContext2D) {\n    const { points } = this\n    const [\n      {\n        x: x0,\n        y: y0\n      }\n    ] = points\n    const boundingBox = new BoundingBox(x0, y0)\n\n    if (ctx) {\n      ctx.beginPath()\n      ctx.moveTo(x0, y0)\n    }\n\n    points.forEach(({\n      x,\n      y\n    }) => {\n      boundingBox.addPoint(x, y)\n\n      if (ctx) {\n        ctx.lineTo(x, y)\n      }\n    })\n\n    return boundingBox\n  }\n\n  override getMarkers() {\n    const { points } = this\n    const lastIndex = points.length - 1\n    const markers: Marker[] = []\n\n    points.forEach((point, i) => {\n      if (i === lastIndex) {\n        return\n      }\n\n      markers.push([point, point.angleTo(points[i + 1])])\n    })\n\n    if (markers.length > 0) {\n      markers.push([points[points.length - 1], markers[markers.length - 1][1]])\n    }\n\n    return markers\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { PolylineElement } from './PolylineElement'\n\nexport class PolygonElement extends PolylineElement {\n  override type = 'polygon'\n\n  override path(ctx: RenderingContext2D) {\n    const boundingBox = super.path(ctx)\n    const [\n      {\n        x,\n        y\n      }\n    ] = this.points\n\n    if (ctx) {\n      ctx.lineTo(x, y)\n      ctx.closePath()\n    }\n\n    return boundingBox\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Property } from '../Property'\nimport { Element } from './Element'\nimport { SVGElement } from './SVGElement'\n\nexport class PatternElement extends Element {\n  override type = 'pattern'\n\n  createPattern(\n    ctx: RenderingContext2D,\n    _: Element,\n    parentOpacityProp: Property\n  ) {\n    const width = this.getStyle('width').getPixels('x', true)\n    const height = this.getStyle('height').getPixels('y', true)\n    // render me using a temporary svg element\n    const patternSvg = new SVGElement(\n      this.document,\n      null\n    )\n\n    patternSvg.attributes.viewBox = new Property(\n      this.document,\n      'viewBox',\n      this.getAttribute('viewBox').getValue()\n    )\n    patternSvg.attributes.width = new Property(\n      this.document,\n      'width',\n      `${width}px`\n    )\n    patternSvg.attributes.height = new Property(\n      this.document,\n      'height',\n      `${height}px`\n    )\n    patternSvg.attributes.transform = new Property(\n      this.document,\n      'transform',\n      this.getAttribute('patternTransform').getValue()\n    )\n    patternSvg.children = this.children\n\n    const patternCanvas = this.document.createCanvas(width, height)\n    const patternCtx = patternCanvas.getContext('2d')\n    const xAttr = this.getAttribute('x')\n    const yAttr = this.getAttribute('y')\n\n    if (xAttr.hasValue() && yAttr.hasValue()) {\n      patternCtx.translate(\n        xAttr.getPixels('x', true),\n        yAttr.getPixels('y', true)\n      )\n    }\n\n    if (parentOpacityProp.hasValue()) {\n      this.styles['fill-opacity'] = parentOpacityProp\n    } else {\n      Reflect.deleteProperty(this.styles, 'fill-opacity')\n    }\n\n    // render 3x3 grid so when we transform there's no white space on edges\n    for (let x = -1; x <= 1; x++) {\n      for (let y = -1; y <= 1; y++) {\n        patternCtx.save()\n        patternSvg.attributes.x = new Property(\n          this.document,\n          'x',\n          x * patternCanvas.width\n        )\n        patternSvg.attributes.y = new Property(\n          this.document,\n          'y',\n          y * patternCanvas.height\n        )\n        patternSvg.render(patternCtx)\n        patternCtx.restore()\n      }\n    }\n\n    const pattern = ctx.createPattern(patternCanvas as CanvasImageSource, 'repeat')\n\n    return pattern\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Point } from '../Point'\nimport { Property } from '../Property'\nimport { Element } from './Element'\nimport { SVGElement } from './SVGElement'\n\nexport class MarkerElement extends Element {\n  override type = 'marker'\n\n  override render(ctx: RenderingContext2D, point?: Point, angle?: number) {\n    if (!point) {\n      return\n    }\n\n    const {\n      x,\n      y\n    } = point\n    const orient = this.getAttribute('orient').getString('auto')\n    const markerUnits = this.getAttribute('markerUnits').getString('strokeWidth')\n\n    ctx.translate(x, y)\n\n    if (orient === 'auto') {\n      ctx.rotate(angle)\n    }\n\n    if (markerUnits === 'strokeWidth') {\n      ctx.scale(ctx.lineWidth, ctx.lineWidth)\n    }\n\n    ctx.save()\n\n    // render me using a temporary svg element\n    const markerSvg = new SVGElement(this.document)\n\n    markerSvg.type = this.type\n    markerSvg.attributes.viewBox = new Property(\n      this.document,\n      'viewBox',\n      this.getAttribute('viewBox').getValue()\n    )\n    markerSvg.attributes.refX = new Property(\n      this.document,\n      'refX',\n      this.getAttribute('refX').getValue()\n    )\n    markerSvg.attributes.refY = new Property(\n      this.document,\n      'refY',\n      this.getAttribute('refY').getValue()\n    )\n    markerSvg.attributes.width = new Property(\n      this.document,\n      'width',\n      this.getAttribute('markerWidth').getValue()\n    )\n    markerSvg.attributes.height = new Property(\n      this.document,\n      'height',\n      this.getAttribute('markerHeight').getValue()\n    )\n    markerSvg.attributes.overflow = new Property(\n      this.document,\n      'overflow',\n      this.getAttribute('overflow').getValue()\n    )\n    markerSvg.attributes.fill = new Property(\n      this.document,\n      'fill',\n      this.getAttribute('fill').getColor('black')\n    )\n    markerSvg.attributes.stroke = new Property(\n      this.document,\n      'stroke',\n      this.getAttribute('stroke').getValue('none')\n    )\n    markerSvg.children = this.children\n\n    markerSvg.render(ctx)\n\n    ctx.restore()\n\n    if (markerUnits === 'strokeWidth') {\n      ctx.scale(1 / ctx.lineWidth, 1 / ctx.lineWidth)\n    }\n\n    if (orient === 'auto') {\n      ctx.rotate(-angle)\n    }\n\n    ctx.translate(-x, -y)\n  }\n}\n", "import { Element } from './Element'\n\nexport class DefsElement extends Element {\n  override type = 'defs'\n\n  override render() {\n    // NOOP\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { BoundingBox } from '../BoundingBox'\nimport { PathElement } from './PathElement'\nimport { RenderedElement } from './RenderedElement'\n\nexport class GElement extends RenderedElement {\n  override type = 'g'\n\n  getBoundingBox(ctx: RenderingContext2D) {\n    const boundingBox = new BoundingBox()\n\n    this.children.forEach((child: PathElement) => {\n      boundingBox.addBoundingBox(child.getBoundingBox(ctx))\n    })\n\n    return boundingBox\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Screen } from '../Screen'\nimport { Property } from '../Property'\nimport { Document } from './Document'\nimport { Element } from './Element'\nimport { PathElement } from './PathElement'\nimport { SVGElement } from './SVGElement'\nimport { RectElement } from './RectElement'\nimport { StopElement } from './StopElement'\nimport { GElement } from './GElement'\n\nexport abstract class GradientElement extends Element {\n  readonly attributesToInherit = ['gradientUnits']\n\n  protected readonly stops: StopElement[] = []\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    const {\n      stops,\n      children\n    } = this\n\n    children.forEach((child) => {\n      if (child.type === 'stop') {\n        stops.push(child as StopElement)\n      }\n    })\n  }\n\n  abstract getGradient(ctx: RenderingContext2D, element: PathElement): CanvasGradient | null\n\n  getGradientUnits() {\n    return this.getAttribute('gradientUnits').getString('objectBoundingBox')\n  }\n\n  createGradient(\n    ctx: RenderingContext2D,\n    element: PathElement,\n    parentOpacityProp: Property\n  ) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n    let stopsContainer = this\n\n    if (this.getHrefAttribute().hasValue()) {\n      stopsContainer = this.getHrefAttribute().getDefinition()\n      this.inheritStopContainer(stopsContainer)\n    }\n\n    const { stops } = stopsContainer\n    const gradient = this.getGradient(ctx, element)\n\n    if (!gradient) {\n      return this.addParentOpacity(\n        parentOpacityProp,\n        stops[stops.length - 1].color\n      )\n    }\n\n    stops.forEach((stop: StopElement) => {\n      gradient.addColorStop(\n        stop.offset,\n        this.addParentOpacity(\n          parentOpacityProp,\n          stop.color\n        )\n      )\n    })\n\n    if (this.getAttribute('gradientTransform').hasValue()) {\n      // render as transformed pattern on temporary canvas\n      const { document } = this\n      const { MAX_VIRTUAL_PIXELS } = Screen\n      const { viewPort } = document.screen\n      const rootView = viewPort.getRoot()\n      const rect = new RectElement(document)\n\n      rect.attributes.x = new Property(\n        document,\n        'x',\n        -MAX_VIRTUAL_PIXELS / 3.0\n      )\n      rect.attributes.y = new Property(\n        document,\n        'y',\n        -MAX_VIRTUAL_PIXELS / 3.0\n      )\n      rect.attributes.width = new Property(\n        document,\n        'width',\n        MAX_VIRTUAL_PIXELS\n      )\n      rect.attributes.height = new Property(\n        document,\n        'height',\n        MAX_VIRTUAL_PIXELS\n      )\n\n      const group = new GElement(document)\n\n      group.attributes.transform = new Property(\n        document,\n        'transform',\n        this.getAttribute('gradientTransform').getValue()\n      )\n      group.children = [rect]\n\n      const patternSvg = new SVGElement(document)\n\n      patternSvg.attributes.x = new Property(\n        document,\n        'x',\n        0\n      )\n      patternSvg.attributes.y = new Property(\n        document,\n        'y',\n        0\n      )\n      patternSvg.attributes.width = new Property(\n        document,\n        'width',\n        rootView.width\n      )\n      patternSvg.attributes.height = new Property(\n        document,\n        'height',\n        rootView.height\n      )\n      patternSvg.children = [group]\n\n      const patternCanvas = document.createCanvas(rootView.width, rootView.height)\n      const patternCtx = patternCanvas.getContext('2d')\n\n      patternCtx.fillStyle = gradient\n      patternSvg.render(patternCtx)\n\n      return patternCtx.createPattern(patternCanvas as CanvasImageSource, 'no-repeat')\n    }\n\n    return gradient\n  }\n\n  protected inheritStopContainer(stopsContainer: Element) {\n    this.attributesToInherit.forEach((attributeToInherit) => {\n      if (!this.getAttribute(attributeToInherit).hasValue()\n        && stopsContainer.getAttribute(attributeToInherit).hasValue()\n      ) {\n        this.getAttribute(attributeToInherit, true)\n          .setValue(stopsContainer.getAttribute(attributeToInherit).getValue())\n      }\n    })\n  }\n\n  protected addParentOpacity(parentOpacityProp: Property, color: string) {\n    if (parentOpacityProp.hasValue()) {\n      const colorProp = new Property(\n        this.document,\n        'color',\n        color\n      )\n\n      return colorProp.addOpacity(parentOpacityProp).getColor()\n    }\n\n    return color\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Document } from './Document'\nimport { PathElement } from './PathElement'\nimport { GradientElement } from './GradientElement'\n\nexport class LinearGradientElement extends GradientElement {\n  override type = 'linearGradient'\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.attributesToInherit.push(\n      'x1',\n      'y1',\n      'x2',\n      'y2'\n    )\n  }\n\n  getGradient(ctx: RenderingContext2D, element: PathElement) {\n    const isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox'\n    const boundingBox = isBoundingBoxUnits\n      ? element.getBoundingBox(ctx)\n      : null\n\n    if (isBoundingBoxUnits && !boundingBox) {\n      return null\n    }\n\n    if (!this.getAttribute('x1').hasValue()\n      && !this.getAttribute('y1').hasValue()\n      && !this.getAttribute('x2').hasValue()\n      && !this.getAttribute('y2').hasValue()\n    ) {\n      this.getAttribute('x1', true).setValue(0)\n      this.getAttribute('y1', true).setValue(0)\n      this.getAttribute('x2', true).setValue(1)\n      this.getAttribute('y2', true).setValue(0)\n    }\n\n    const x1 = isBoundingBoxUnits\n      ? boundingBox.x + boundingBox.width * this.getAttribute('x1').getNumber()\n      : this.getAttribute('x1').getPixels('x')\n    const y1 = isBoundingBoxUnits\n      ? boundingBox.y + boundingBox.height * this.getAttribute('y1').getNumber()\n      : this.getAttribute('y1').getPixels('y')\n    const x2 = isBoundingBoxUnits\n      ? boundingBox.x + boundingBox.width * this.getAttribute('x2').getNumber()\n      : this.getAttribute('x2').getPixels('x')\n    const y2 = isBoundingBoxUnits\n      ? boundingBox.y + boundingBox.height * this.getAttribute('y2').getNumber()\n      : this.getAttribute('y2').getPixels('y')\n\n    if (x1 === x2 && y1 === y2) {\n      return null\n    }\n\n    return ctx.createLinearGradient(x1, y1, x2, y2)\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Document } from './Document'\nimport { PathElement } from './PathElement'\nimport { GradientElement } from './GradientElement'\n\nexport class RadialGradientElement extends GradientElement {\n  override type = 'radialGradient'\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.attributesToInherit.push(\n      'cx',\n      'cy',\n      'r',\n      'fx',\n      'fy',\n      'fr'\n    )\n  }\n\n  getGradient(ctx: RenderingContext2D, element: PathElement) {\n    const isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox'\n    const boundingBox = element.getBoundingBox(ctx)\n\n    if (isBoundingBoxUnits && !boundingBox) {\n      return null\n    }\n\n    if (!this.getAttribute('cx').hasValue()) {\n      this.getAttribute('cx', true).setValue('50%')\n    }\n\n    if (!this.getAttribute('cy').hasValue()) {\n      this.getAttribute('cy', true).setValue('50%')\n    }\n\n    if (!this.getAttribute('r').hasValue()) {\n      this.getAttribute('r', true).setValue('50%')\n    }\n\n    const cx = isBoundingBoxUnits\n      ? boundingBox.x + boundingBox.width * this.getAttribute('cx').getNumber()\n      : this.getAttribute('cx').getPixels('x')\n    const cy = isBoundingBoxUnits\n      ? boundingBox.y + boundingBox.height * this.getAttribute('cy').getNumber()\n      : this.getAttribute('cy').getPixels('y')\n    let fx = cx\n    let fy = cy\n\n    if (this.getAttribute('fx').hasValue()) {\n      fx = isBoundingBoxUnits\n        ? boundingBox.x + boundingBox.width * this.getAttribute('fx').getNumber()\n        : this.getAttribute('fx').getPixels('x')\n    }\n\n    if (this.getAttribute('fy').hasValue()) {\n      fy = isBoundingBoxUnits\n        ? boundingBox.y + boundingBox.height * this.getAttribute('fy').getNumber()\n        : this.getAttribute('fy').getPixels('y')\n    }\n\n    const r = isBoundingBoxUnits\n      ? (boundingBox.width + boundingBox.height) / 2.0 * this.getAttribute('r').getNumber()\n      : this.getAttribute('r').getPixels()\n    const fr = this.getAttribute('fr').getPixels()\n\n    return ctx.createRadialGradient(fx, fy, fr, cx, cy, r)\n  }\n}\n", "import { Document } from './Document'\nimport { Element } from './Element'\n\nexport class StopElement extends Element {\n  override type = 'stop'\n  readonly offset: number\n  readonly color: string\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    const offset = Math.max(0, Math.min(1, this.getAttribute('offset').getNumber()))\n    const stopOpacity = this.getStyle('stop-opacity')\n    let stopColor = this.getStyle('stop-color', true)\n\n    if (stopColor.getString() === '') {\n      stopColor.setValue('#000')\n    }\n\n    if (stopOpacity.hasValue()) {\n      stopColor = stopColor.addOpacity(stopOpacity)\n    }\n\n    this.offset = offset\n    this.color = stopColor.getColor()\n  }\n}\n", "import { Property } from '../Property'\nimport { Document } from './Document'\nimport { Element } from './Element'\n\nexport interface IProgress {\n  from: Property\n  to: Property\n  progress: number\n}\n\nexport class AnimateElement extends Element {\n  override type = 'animate'\n  protected readonly begin: number\n  protected readonly maxDuration: number\n  protected readonly from: Property\n  protected readonly to: Property\n  protected readonly values: Property<string[]>\n  protected duration = 0\n  protected initialValue: string | undefined\n  protected initialUnits = ''\n  protected removed = false\n  protected frozen = false\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    document.screen.animations.push(this)\n\n    this.begin = this.getAttribute('begin').getMilliseconds()\n    this.maxDuration = this.begin + this.getAttribute('dur').getMilliseconds()\n    this.from = this.getAttribute('from')\n    this.to = this.getAttribute('to')\n    this.values = new Property<string[] | null>(document, 'values', null)\n\n    const valuesAttr = this.getAttribute('values')\n\n    if (valuesAttr.hasValue()) {\n      this.values.setValue(valuesAttr.getString().split(';'))\n    }\n  }\n\n  protected getProperty() {\n    const attributeType = this.getAttribute('attributeType').getString()\n    const attributeName = this.getAttribute('attributeName').getString()\n\n    if (attributeType === 'CSS') {\n      return this.parent.getStyle(attributeName, true)\n    }\n\n    return this.parent.getAttribute(attributeName, true)\n  }\n\n  calcValue() {\n    const { initialUnits } = this\n    const {\n      progress,\n      from,\n      to\n    } = this.getProgress()\n    // tween value linearly\n    let newValue = from.getNumber() + (to.getNumber() - from.getNumber()) * progress\n\n    if (initialUnits === '%') {\n      newValue *= 100.0 // numValue() returns 0-1 whereas properties are 0-100\n    }\n\n    return `${newValue}${initialUnits}`\n  }\n\n  update(delta: number) {\n    const { parent } = this\n    const prop = this.getProperty()\n\n    // set initial value\n    if (!this.initialValue) {\n      this.initialValue = prop.getString()\n      this.initialUnits = prop.getUnits()\n    }\n\n    // if we're past the end time\n    if (this.duration > this.maxDuration) {\n      const fill = this.getAttribute('fill').getString('remove')\n\n      // loop for indefinitely repeating animations\n      if (this.getAttribute('repeatCount').getString() === 'indefinite'\n        || this.getAttribute('repeatDur').getString() === 'indefinite'\n      ) {\n        this.duration = 0\n      } else\n      if (fill === 'freeze' && !this.frozen) {\n        this.frozen = true\n\n        if (parent && prop) {\n          parent.animationFrozen = true\n          parent.animationFrozenValue = prop.getString()\n        }\n      } else\n      if (fill === 'remove' && !this.removed) {\n        this.removed = true\n\n        if (parent && prop) {\n          prop.setValue(\n            parent.animationFrozen\n              ? parent.animationFrozenValue\n              : this.initialValue\n          )\n        }\n\n        return true\n      }\n\n      return false\n    }\n\n    this.duration += delta\n\n    // if we're past the begin time\n    let updated = false\n\n    if (this.begin < this.duration) {\n      let newValue = this.calcValue() // tween\n      const typeAttr = this.getAttribute('type')\n\n      if (typeAttr.hasValue()) {\n        // for transform, etc.\n        const type = typeAttr.getString()\n\n        newValue = `${type}(${newValue})`\n      }\n\n      prop.setValue(newValue)\n      updated = true\n    }\n\n    return updated\n  }\n\n  getProgress(): IProgress {\n    const {\n      document,\n      values\n    } = this\n    let progress = (this.duration - this.begin) / (this.maxDuration - this.begin)\n    let from: Property\n    let to: Property\n\n    if (values.hasValue()) {\n      const p = progress * (values.getValue().length - 1)\n      const lb = Math.floor(p)\n      const ub = Math.ceil(p)\n      let value: string | undefined\n\n      value = values.getValue()[lb]\n      from = new Property(\n        document,\n        'from',\n        value ? parseFloat(value) : 0\n      )\n\n      value = values.getValue()[ub]\n      to = new Property(\n        document,\n        'to',\n        value ? parseFloat(value) : 0\n      )\n\n      progress = (p - lb) / (ub - lb)\n    } else {\n      from = this.from\n      to = this.to\n    }\n\n    return {\n      progress,\n      from,\n      to\n    }\n  }\n}\n", "import RGBColor from 'rgbcolor'\nimport { AnimateElement } from './AnimateElement'\n\nexport class AnimateColorElement extends AnimateElement {\n  override type = 'animateColor'\n\n  override calcValue() {\n    const {\n      progress,\n      from,\n      to\n    } = this.getProgress()\n    const colorFrom = new RGBColor(from.getColor())\n    const colorTo = new RGBColor(to.getColor())\n\n    if (colorFrom.ok && colorTo.ok) {\n      // tween color linearly\n      const r = colorFrom.r + (colorTo.r - colorFrom.r) * progress\n      const g = colorFrom.g + (colorTo.g - colorFrom.g) * progress\n      const b = colorFrom.b + (colorTo.b - colorFrom.b) * progress\n\n      // ? alpha\n      return `rgb(${\n        Math.floor(r)\n      }, ${\n        Math.floor(g)\n      }, ${\n        Math.floor(b)\n      })`\n    }\n\n    return this.getAttribute('from').getColor()\n  }\n}\n", "import { toNumbers } from '../util'\nimport { AnimateElement } from './AnimateElement'\n\nexport class AnimateTransformElement extends AnimateElement {\n  override type = 'animateTransform'\n\n  override calcValue() {\n    const {\n      progress,\n      from,\n      to\n    } = this.getProgress()\n    // tween value linearly\n    const transformFrom = toNumbers(from.getString())\n    const transformTo = toNumbers(to.getString())\n    const newValue = transformFrom.map((from, i) => {\n      const to = transformTo[i]\n\n      return from + (to - from) * progress\n    }).join(' ')\n\n    return newValue\n  }\n}\n", "import { Document } from './Document'\nimport { Element } from './Element'\n\nexport class FontFaceElement extends Element {\n  override type = 'font-face'\n  readonly ascent: number\n  readonly descent: number\n  readonly unitsPerEm: number\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.ascent = this.getAttribute('ascent').getNumber()\n    this.descent = this.getAttribute('descent').getNumber()\n    this.unitsPerEm = this.getAttribute('units-per-em').getNumber()\n  }\n}\n", "import { Document } from './Document'\nimport { PathElement } from './PathElement'\n\nexport type ArabicForm = 'isolated' | 'terminal' | 'medial' | 'initial'\n\nexport class GlyphElement extends PathElement {\n  override type = 'glyph'\n  readonly horizAdvX: number\n  readonly unicode: string\n  readonly arabicForm: ArabicForm | undefined\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.horizAdvX = this.getAttribute('horiz-adv-x').getNumber()\n    this.unicode = this.getAttribute('unicode').getString()\n    this.arabicForm = this.getAttribute('arabic-form').getString() as ArabicForm\n  }\n}\n", "import { GlyphElement } from './GlyphElement'\n\nexport class MissingGlyphElement extends GlyphElement {\n  override type = 'missing-glyph'\n  override readonly horizAdvX = 0\n}\n", "import { Document } from './Document'\nimport { Element } from './Element'\nimport { FontFaceElement } from './FontFaceElement'\nimport { MissingGlyphElement } from './MissingGlyphElement'\nimport { ArabicForm, GlyphElement } from './GlyphElement'\n\nexport class FontElement extends Element {\n  override type = 'font'\n  readonly isArabic: boolean = false\n  readonly missingGlyph: MissingGlyphElement | undefined\n  readonly glyphs: Record<string, GlyphElement> = {}\n  readonly arabicGlyphs: Record<string, Partial<Record<ArabicForm, GlyphElement>>> = {}\n  readonly horizAdvX: number\n  readonly isRTL: boolean = false\n  readonly fontFace: FontFaceElement | undefined\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.horizAdvX = this.getAttribute('horiz-adv-x').getNumber()\n\n    const { definitions } = document\n    const { children } = this\n\n    for (const child of children) {\n      if (child instanceof FontFaceElement) {\n        this.fontFace = child\n\n        const fontFamilyStyle = child.getStyle('font-family')\n\n        if (fontFamilyStyle.hasValue()) {\n          definitions[fontFamilyStyle.getString()] = this\n        }\n      } else\n      if (child instanceof MissingGlyphElement) {\n        this.missingGlyph = child\n      } else\n      if (child instanceof GlyphElement) {\n        if (child.arabicForm) {\n          this.isRTL = true\n          this.isArabic = true\n\n          const arabicGlyph = this.arabicGlyphs[child.unicode]\n\n          if (typeof arabicGlyph === 'undefined') {\n            this.arabicGlyphs[child.unicode] = {\n              [child.arabicForm]: child\n            }\n          } else {\n            arabicGlyph[child.arabicForm] = child\n          }\n        } else {\n          this.glyphs[child.unicode] = child\n        }\n      }\n    }\n  }\n\n  override render() {\n    // NO RENDER\n  }\n}\n", "import { TextElement } from './TextElement'\n\nexport class TRefElement extends TextElement {\n  override type = 'tref'\n\n  override getText() {\n    const element = this.getHrefAttribute().getDefinition()\n\n    if (element) {\n      const firstChild = element.children[0] as TextElement\n\n      if (firstChild) {\n        return firstChild.getText()\n      }\n    }\n\n    return ''\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Property } from '../Property'\nimport { Font } from '../Font'\nimport { BoundingBox } from '../BoundingBox'\nimport { Document } from './Document'\nimport { TextElement } from './TextElement'\nimport { GElement } from './GElement'\n\nexport class AElement extends TextElement {\n  override type = 'a'\n  protected readonly hasText: boolean\n  protected readonly text: string\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    const { childNodes } = node\n    const firstChild = childNodes[0]\n    const hasText = childNodes.length > 0\n      && Array.from(childNodes).every(node => node.nodeType === 3)\n\n    this.hasText = hasText\n    this.text = hasText\n      ? this.getTextFromNode(firstChild)\n      : ''\n  }\n\n  override getText() {\n    return this.text\n  }\n\n  override renderChildren(ctx: RenderingContext2D) {\n    if (this.hasText) {\n      // render as text element\n      super.renderChildren(ctx)\n\n      const {\n        document,\n        x,\n        y\n      } = this\n      const { mouse } = document.screen\n      const fontSize = new Property(\n        document,\n        'fontSize',\n        Font.parse(document.ctx.font).fontSize\n      )\n\n      // Do not calc bounding box if mouse is not working.\n      if (mouse.isWorking()) {\n        mouse.checkBoundingBox(\n          this,\n          new BoundingBox(\n            x,\n            y - fontSize.getPixels('y'),\n            x + this.measureText(ctx),\n            y\n          )\n        )\n      }\n    } else\n    if (this.children.length > 0) {\n      // render as temporary group\n      const g = new GElement(this.document)\n\n      g.children = this.children\n      g.parent = this\n      g.render(ctx)\n    }\n  }\n\n  onClick() {\n    const { window } = this.document\n\n    if (window) {\n      window.open(this.getHrefAttribute().getString())\n    }\n  }\n\n  onMouseMove() {\n    const ctx = this.document.ctx as CanvasRenderingContext2D\n\n    ctx.canvas.style.cursor = 'pointer'\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport {\n  PSEUDO_ZERO,\n  CB1,\n  CB2,\n  CB3,\n  CB4,\n  QB1,\n  QB2,\n  QB3\n} from '../util'\nimport { PathParser, CommandType } from '../PathParser'\nimport { Document } from './Document'\nimport { TextElement } from './TextElement'\nimport { PathElement } from './PathElement'\n\nexport interface IPoint {\n  x: number\n  y: number\n}\n\nexport interface IPathCommand {\n  type: CommandType\n  points: number[]\n  start?: IPoint\n  pathLength: number\n}\n\ninterface ICachedPoint extends IPoint {\n  distance: number\n}\n\ninterface IEquidistantCache {\n  step: number\n  precision: number\n  points: ICachedPoint[]\n}\n\ninterface IGlyphInfo {\n  // transposeX: number;\n  // transposeY: number;\n  text: string\n  rotation: number\n  p0: ICachedPoint\n  p1: ICachedPoint\n}\n\nexport class TextPathElement extends TextElement {\n  override type = 'textPath'\n  protected textWidth = 0\n  protected textHeight = 0\n  protected pathLength = -1\n  protected glyphInfo: IGlyphInfo[] = null\n  protected readonly text: string\n  protected readonly dataArray: IPathCommand[]\n  private letterSpacingCache: number[] = []\n  private equidistantCache: IEquidistantCache\n  private readonly measuresCache = new Map<string, number>([['', 0]])\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    const pathElement = this.getHrefAttribute().getDefinition<PathElement>()\n\n    this.text = this.getTextFromNode()\n    this.dataArray = this.parsePathData(pathElement)\n  }\n\n  override getText() {\n    return this.text\n  }\n\n  path(ctx: RenderingContext2D) {\n    const { dataArray } = this\n\n    if (ctx) {\n      ctx.beginPath()\n    }\n\n    dataArray.forEach(({\n      type,\n      points\n    }) => {\n      switch (type) {\n        case PathParser.LINE_TO:\n\n          if (ctx) {\n            ctx.lineTo(points[0], points[1])\n          }\n\n          break\n\n        case PathParser.MOVE_TO:\n\n          if (ctx) {\n            ctx.moveTo(points[0], points[1])\n          }\n\n          break\n\n        case PathParser.CURVE_TO:\n\n          if (ctx) {\n            ctx.bezierCurveTo(\n              points[0],\n              points[1],\n              points[2],\n              points[3],\n              points[4],\n              points[5]\n            )\n          }\n\n          break\n\n        case PathParser.QUAD_TO:\n\n          if (ctx) {\n            ctx.quadraticCurveTo(\n              points[0],\n              points[1],\n              points[2],\n              points[3]\n            )\n          }\n\n          break\n\n        case PathParser.ARC: {\n          const [\n            cx,\n            cy,\n            rx,\n            ry,\n            theta,\n            dTheta,\n            psi,\n            fs\n          ] = points\n          const r = rx > ry ? rx : ry\n          const scaleX = rx > ry ? 1 : rx / ry\n          const scaleY = rx > ry ? ry / rx : 1\n\n          if (ctx) {\n            ctx.translate(cx, cy)\n            ctx.rotate(psi)\n            ctx.scale(scaleX, scaleY)\n            ctx.arc(0, 0, r, theta, theta + dTheta, Boolean(1 - fs))\n            ctx.scale(1 / scaleX, 1 / scaleY)\n            ctx.rotate(-psi)\n            ctx.translate(-cx, -cy)\n          }\n\n          break\n        }\n\n        case PathParser.CLOSE_PATH:\n\n          if (ctx) {\n            ctx.closePath()\n          }\n\n          break\n\n        default:\n      }\n    })\n  }\n\n  override renderChildren(ctx: RenderingContext2D) {\n    this.setTextData(ctx)\n    ctx.save()\n\n    const textDecoration = this.parent.getStyle('text-decoration').getString()\n    const fontSize = this.getFontSize()\n    const { glyphInfo } = this\n    const fill = ctx.fillStyle\n\n    if (textDecoration === 'underline') {\n      ctx.beginPath()\n    }\n\n    glyphInfo.forEach((glyph, i) => {\n      const {\n        p0,\n        p1,\n        rotation,\n        text: partialText\n      } = glyph\n\n      ctx.save()\n      ctx.translate(p0.x, p0.y)\n      ctx.rotate(rotation)\n\n      if (ctx.fillStyle) {\n        ctx.fillText(partialText, 0, 0)\n      }\n\n      if (ctx.strokeStyle) {\n        ctx.strokeText(partialText, 0, 0)\n      }\n\n      ctx.restore()\n\n      if (textDecoration === 'underline') {\n        if (i === 0) {\n          ctx.moveTo(p0.x, p0.y + fontSize / 8)\n        }\n\n        ctx.lineTo(p1.x, p1.y + fontSize / 5)\n      }\n\n      // // To assist with debugging visually, uncomment following\n      //\n      // ctx.beginPath();\n      // if (i % 2)\n      //   ctx.strokeStyle = 'red';\n      // else\n      //   ctx.strokeStyle = 'green';\n      // ctx.moveTo(p0.x, p0.y);\n      // ctx.lineTo(p1.x, p1.y);\n      // ctx.stroke();\n      // ctx.closePath();\n    })\n\n    if (textDecoration === 'underline') {\n      ctx.lineWidth = fontSize / 20\n      ctx.strokeStyle = fill\n      ctx.stroke()\n      ctx.closePath()\n    }\n\n    ctx.restore()\n  }\n\n  protected getLetterSpacingAt(idx = 0) {\n    return this.letterSpacingCache[idx] || 0\n  }\n\n  protected findSegmentToFitChar(\n    ctx: RenderingContext2D,\n    anchor: string,\n    textFullWidth: number,\n    fullPathWidth: number,\n    spacesNumber: number,\n    inputOffset: number,\n    dy: number,\n    c: string,\n    charI: number\n  ) {\n    let offset = inputOffset\n    let glyphWidth = this.measureText(ctx, c)\n\n    if (c === ' '\n      && anchor === 'justify'\n      && textFullWidth < fullPathWidth\n    ) {\n      glyphWidth += (fullPathWidth - textFullWidth) / spacesNumber\n    }\n\n    if (charI > -1) {\n      offset += this.getLetterSpacingAt(charI)\n    }\n\n    const splineStep = this.textHeight / 20\n    const p0 = this.getEquidistantPointOnPath(offset, splineStep, 0)\n    const p1 = this.getEquidistantPointOnPath(offset + glyphWidth, splineStep, 0)\n    const segment = {\n      p0,\n      p1\n    }\n    const rotation = p0 && p1\n      ? Math.atan2(\n        p1.y - p0.y,\n        p1.x - p0.x\n      )\n      : 0\n\n    if (dy) {\n      const dyX = Math.cos(Math.PI / 2 + rotation) * dy\n      const dyY = Math.cos(-rotation) * dy\n\n      segment.p0 = {\n        ...p0,\n        x: p0.x + dyX,\n        y: p0.y + dyY\n      }\n      segment.p1 = {\n        ...p1,\n        x: p1.x + dyX,\n        y: p1.y + dyY\n      }\n    }\n\n    offset += glyphWidth\n\n    return {\n      offset,\n      segment,\n      rotation\n    }\n  }\n\n  protected override measureText(\n    ctx: RenderingContext2D,\n    text?: string\n  ) {\n    const { measuresCache } = this\n    const targetText = text || this.getText()\n\n    if (measuresCache.has(targetText)) {\n      return measuresCache.get(targetText)\n    }\n\n    const measure = this.measureTargetText(ctx, targetText)\n\n    measuresCache.set(targetText, measure)\n\n    return measure\n  }\n\n  // This method supposes what all custom fonts already loaded.\n  // If some font will be loaded after this method call, <textPath> will not be rendered correctly.\n  // You need to call this method manually to update glyphs cache.\n  protected setTextData(ctx: RenderingContext2D) {\n    if (this.glyphInfo) {\n      return\n    }\n\n    const renderText = this.getText()\n    const chars = renderText.split('')\n    const spacesNumber = renderText.split(' ').length - 1\n    const dx = this.parent.getAttribute('dx').split().map(_ => _.getPixels('x'))\n    const dy = this.parent.getAttribute('dy').getPixels('y')\n    const anchor = this.parent.getStyle('text-anchor').getString('start')\n    const thisSpacing = this.getStyle('letter-spacing')\n    const parentSpacing = this.parent.getStyle('letter-spacing')\n    let letterSpacing = 0\n\n    if (!thisSpacing.hasValue()\n      || thisSpacing.getValue() === 'inherit'\n    ) {\n      letterSpacing = parentSpacing.getPixels()\n    } else\n    if (thisSpacing.hasValue()) {\n      if (thisSpacing.getValue() !== 'initial'\n        && thisSpacing.getValue() !== 'unset'\n      ) {\n        letterSpacing = thisSpacing.getPixels()\n      }\n    }\n\n    // fill letter-spacing cache\n    const letterSpacingCache: number[] = []\n    const textLen = renderText.length\n\n    this.letterSpacingCache = letterSpacingCache\n\n    for (let i = 0; i < textLen; i++) {\n      letterSpacingCache.push(\n        typeof dx[i] !== 'undefined'\n          ? dx[i]\n          : letterSpacing\n      )\n    }\n\n    const dxSum = letterSpacingCache.reduce(\n      (acc, cur, i) => (\n        i === 0\n          ? 0\n          : acc + cur || 0\n      ),\n      0\n    )\n    const textWidth = this.measureText(ctx)\n    const textFullWidth = Math.max(textWidth + dxSum, 0)\n\n    this.textWidth = textWidth\n    this.textHeight = this.getFontSize()\n    this.glyphInfo = []\n\n    const fullPathWidth = this.getPathLength()\n    const startOffset = this.getStyle('startOffset').getNumber(0) * fullPathWidth\n    let offset = 0\n\n    if (anchor === 'middle'\n      || anchor === 'center'\n    ) {\n      offset = -textFullWidth / 2\n    }\n\n    if (anchor === 'end'\n      || anchor === 'right'\n    ) {\n      offset = -textFullWidth\n    }\n\n    offset += startOffset\n\n    chars.forEach((char, i) => {\n      // Find such segment what distance between p0 and p1 is approx. width of glyph\n      const {\n        offset: nextOffset,\n        segment,\n        rotation\n      } = this.findSegmentToFitChar(\n        ctx,\n        anchor,\n        textFullWidth,\n        fullPathWidth,\n        spacesNumber,\n        offset,\n        dy,\n        char,\n        i\n      )\n\n      offset = nextOffset\n\n      if (!segment.p0 || !segment.p1) {\n        return\n      }\n\n      // const width = this.getLineLength(\n      //   segment.p0.x,\n      //   segment.p0.y,\n      //   segment.p1.x,\n      //   segment.p1.y\n      // );\n      // Note: Since glyphs are rendered one at a time, any kerning pair data built into the font will not be used.\n      // Can foresee having a rough pair table built in that the developer can override as needed.\n      // Or use \"dx\" attribute of the <text> node as a naive replacement\n      // const kern = 0;\n      // placeholder for future implementation\n      // const midpoint = this.getPointOnLine(\n      //   kern + width / 2.0,\n      //   segment.p0.x, segment.p0.y, segment.p1.x, segment.p1.y\n      // );\n\n      this.glyphInfo.push({\n        // transposeX: midpoint.x,\n        // transposeY: midpoint.y,\n        text: chars[i],\n        p0: segment.p0,\n        p1: segment.p1,\n        rotation\n      })\n    })\n  }\n\n  protected parsePathData(path: PathElement) {\n    this.pathLength = -1 // reset path length\n\n    if (!path) {\n      return []\n    }\n\n    const pathCommands: IPathCommand[] = []\n    const { pathParser } = path\n\n    pathParser.reset()\n\n    // convert l, H, h, V, and v to L\n    while (!pathParser.isEnd()) {\n      const { current } = pathParser\n      const startX = current ? current.x : 0\n      const startY = current ? current.y : 0\n      const command = pathParser.next()\n      let nextCommandType: CommandType = command.type\n      let points: number[] = []\n\n      switch (command.type) {\n        case PathParser.MOVE_TO:\n          this.pathM(pathParser, points)\n          break\n\n        case PathParser.LINE_TO:\n          nextCommandType = this.pathL(pathParser, points)\n          break\n\n        case PathParser.HORIZ_LINE_TO:\n          nextCommandType = this.pathH(pathParser, points)\n          break\n\n        case PathParser.VERT_LINE_TO:\n          nextCommandType = this.pathV(pathParser, points)\n          break\n\n        case PathParser.CURVE_TO:\n          this.pathC(pathParser, points)\n          break\n\n        case PathParser.SMOOTH_CURVE_TO:\n          nextCommandType = this.pathS(pathParser, points)\n          break\n\n        case PathParser.QUAD_TO:\n          this.pathQ(pathParser, points)\n          break\n\n        case PathParser.SMOOTH_QUAD_TO:\n          nextCommandType = this.pathT(pathParser, points)\n          break\n\n        case PathParser.ARC:\n          points = this.pathA(pathParser)\n          break\n\n        case PathParser.CLOSE_PATH:\n          PathElement.pathZ(pathParser)\n          break\n\n        default:\n      }\n\n      if (command.type !== PathParser.CLOSE_PATH) {\n        pathCommands.push({\n          type: nextCommandType,\n          points,\n          start: {\n            x: startX,\n            y: startY\n          },\n          pathLength: this.calcLength(startX, startY, nextCommandType, points)\n        })\n      } else {\n        pathCommands.push({\n          type: PathParser.CLOSE_PATH,\n          points: [],\n          pathLength: 0\n        })\n      }\n    }\n\n    return pathCommands\n  }\n\n  protected pathM(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      x,\n      y\n    } = PathElement.pathM(pathParser).point\n\n    points.push(x, y)\n  }\n\n  protected pathL(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      x,\n      y\n    } = PathElement.pathL(pathParser).point\n\n    points.push(x, y)\n\n    return PathParser.LINE_TO\n  }\n\n  protected pathH(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      x,\n      y\n    } = PathElement.pathH(pathParser).point\n\n    points.push(x, y)\n\n    return PathParser.LINE_TO\n  }\n\n  protected pathV(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      x,\n      y\n    } = PathElement.pathV(pathParser).point\n\n    points.push(x, y)\n\n    return PathParser.LINE_TO\n  }\n\n  protected pathC(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathC(pathParser)\n\n    points.push(\n      point.x,\n      point.y,\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n  }\n\n  protected pathS(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathS(pathParser)\n\n    points.push(\n      point.x,\n      point.y,\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n\n    return PathParser.CURVE_TO\n  }\n\n  protected pathQ(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      controlPoint,\n      currentPoint\n    } = PathElement.pathQ(pathParser)\n\n    points.push(\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n  }\n\n  protected pathT(\n    pathParser: PathParser,\n    points: number[]\n  ) {\n    const {\n      controlPoint,\n      currentPoint\n    } = PathElement.pathT(pathParser)\n\n    points.push(\n      controlPoint.x,\n      controlPoint.y,\n      currentPoint.x,\n      currentPoint.y\n    )\n\n    return PathParser.QUAD_TO\n  }\n\n  protected pathA(\n    pathParser: PathParser\n  ) {\n    let {\n      rX,\n      rY,\n      sweepFlag,\n      xAxisRotation,\n      centp,\n      a1,\n      ad\n    } = PathElement.pathA(pathParser)\n\n    if (sweepFlag === 0 && ad > 0) {\n      ad -= 2 * Math.PI\n    }\n\n    if (sweepFlag === 1 && ad < 0) {\n      ad += 2 * Math.PI\n    }\n\n    return [\n      centp.x,\n      centp.y,\n      rX,\n      rY,\n      a1,\n      ad,\n      xAxisRotation,\n      sweepFlag\n    ]\n  }\n\n  protected calcLength(\n    x: number,\n    y: number,\n    commandType: CommandType,\n    points: number[]\n  ) {\n    let len = 0\n    let p1: IPoint = null\n    let p2: IPoint = null\n    let t = 0\n\n    switch (commandType) {\n      case PathParser.LINE_TO:\n        return this.getLineLength(x, y, points[0], points[1])\n\n      case PathParser.CURVE_TO:\n        // Approximates by breaking curve into 100 line segments\n        len = 0.0\n        p1 = this.getPointOnCubicBezier(\n          0,\n          x,\n          y,\n          points[0],\n          points[1],\n          points[2],\n          points[3],\n          points[4],\n          points[5]\n        )\n\n        for (t = 0.01; t <= 1; t += 0.01) {\n          p2 = this.getPointOnCubicBezier(\n            t,\n            x,\n            y,\n            points[0],\n            points[1],\n            points[2],\n            points[3],\n            points[4],\n            points[5]\n          )\n          len += this.getLineLength(p1.x, p1.y, p2.x, p2.y)\n          p1 = p2\n        }\n\n        return len\n\n      case PathParser.QUAD_TO:\n        // Approximates by breaking curve into 100 line segments\n        len = 0.0\n        p1 = this.getPointOnQuadraticBezier(\n          0,\n          x,\n          y,\n          points[0],\n          points[1],\n          points[2],\n          points[3]\n        )\n\n        for (t = 0.01; t <= 1; t += 0.01) {\n          p2 = this.getPointOnQuadraticBezier(\n            t,\n            x,\n            y,\n            points[0],\n            points[1],\n            points[2],\n            points[3]\n          )\n          len += this.getLineLength(\n            p1.x,\n            p1.y,\n            p2.x,\n            p2.y\n          )\n          p1 = p2\n        }\n\n        return len\n\n      case PathParser.ARC: {\n        // Approximates by breaking curve into line segments\n        len = 0.0\n\n        const start = points[4]\n        // 4 = theta\n        const dTheta = points[5]\n        // 5 = dTheta\n        const end = points[4] + dTheta\n        let inc = Math.PI / 180.0\n\n        // 1 degree resolution\n        if (Math.abs(start - end) < inc) {\n          inc = Math.abs(start - end)\n        }\n\n        // Note: for purpose of calculating arc length, not going to worry about rotating X-axis by angle psi\n        p1 = this.getPointOnEllipticalArc(\n          points[0],\n          points[1],\n          points[2],\n          points[3],\n          start,\n          0\n        )\n\n        if (dTheta < 0) { // clockwise\n          for (t = start - inc; t > end; t -= inc) {\n            p2 = this.getPointOnEllipticalArc(\n              points[0],\n              points[1],\n              points[2],\n              points[3],\n              t,\n              0\n            )\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y)\n            p1 = p2\n          }\n        } else { // counter-clockwise\n          for (t = start + inc; t < end; t += inc) {\n            p2 = this.getPointOnEllipticalArc(\n              points[0],\n              points[1],\n              points[2],\n              points[3],\n              t,\n              0\n            )\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y)\n            p1 = p2\n          }\n        }\n\n        p2 = this.getPointOnEllipticalArc(\n          points[0],\n          points[1],\n          points[2],\n          points[3],\n          end,\n          0\n        )\n        len += this.getLineLength(p1.x, p1.y, p2.x, p2.y)\n\n        return len\n      }\n\n      default:\n    }\n\n    return 0\n  }\n\n  protected getPointOnLine(\n    dist: number,\n    p1x: number,\n    p1y: number,\n    p2x: number,\n    p2y: number,\n    fromX = p1x,\n    fromY = p1y\n  ) {\n    const m = (p2y - p1y) / ((p2x - p1x) + PSEUDO_ZERO)\n    let run = Math.sqrt(dist * dist / (1 + m * m))\n\n    if (p2x < p1x) {\n      run *= -1\n    }\n\n    let rise = m * run\n    let pt: IPoint = null\n\n    if (p2x === p1x) { // vertical line\n      pt = {\n        x: fromX,\n        y: fromY + rise\n      }\n    } else\n    if ((fromY - p1y) / ((fromX - p1x) + PSEUDO_ZERO) === m) {\n      pt = {\n        x: fromX + run,\n        y: fromY + rise\n      }\n    } else {\n      let ix = 0\n      let iy = 0\n      const len = this.getLineLength(p1x, p1y, p2x, p2y)\n\n      if (len < PSEUDO_ZERO) {\n        return null\n      }\n\n      let u =\n        ((fromX - p1x) * (p2x - p1x))\n        + ((fromY - p1y) * (p2y - p1y))\n\n      u /= len * len\n      ix = p1x + u * (p2x - p1x)\n      iy = p1y + u * (p2y - p1y)\n\n      const pRise = this.getLineLength(fromX, fromY, ix, iy)\n      const pRun = Math.sqrt(dist * dist - pRise * pRise)\n\n      run = Math.sqrt(pRun * pRun / (1 + m * m))\n\n      if (p2x < p1x) {\n        run *= -1\n      }\n\n      rise = m * run\n      pt = {\n        x: ix + run,\n        y: iy + rise\n      }\n    }\n\n    return pt\n  }\n\n  protected getPointOnPath(distance: number) {\n    const fullLen = this.getPathLength()\n    let cumulativePathLength = 0\n    let p: IPoint = null\n\n    if (distance < -0.00005\n      || distance - 0.00005 > fullLen\n    ) {\n      return null\n    }\n\n    const { dataArray } = this\n\n    for (const command of dataArray) {\n      if (command\n        && (\n          command.pathLength < 0.00005\n          || cumulativePathLength + command.pathLength + 0.00005 < distance\n        )\n      ) {\n        cumulativePathLength += command.pathLength\n        continue\n      }\n\n      const delta = distance - cumulativePathLength\n      let currentT = 0\n\n      switch (command.type) {\n        case PathParser.LINE_TO:\n          p = this.getPointOnLine(\n            delta,\n            command.start.x,\n            command.start.y,\n            command.points[0],\n            command.points[1],\n            command.start.x,\n            command.start.y\n          )\n          break\n\n        case PathParser.ARC: {\n          const start = command.points[4]\n          // 4 = theta\n          const dTheta = command.points[5]\n          // 5 = dTheta\n          const end = command.points[4] + dTheta\n\n          currentT = start + delta / command.pathLength * dTheta\n\n          if (dTheta < 0 && currentT < end\n            || dTheta >= 0 && currentT > end\n          ) {\n            break\n          }\n\n          p = this.getPointOnEllipticalArc(\n            command.points[0],\n            command.points[1],\n            command.points[2],\n            command.points[3],\n            currentT,\n            command.points[6]\n          )\n          break\n        }\n\n        case PathParser.CURVE_TO:\n\n          currentT = delta / command.pathLength\n\n          if (currentT > 1) {\n            currentT = 1\n          }\n\n          p = this.getPointOnCubicBezier(\n            currentT,\n            command.start.x,\n            command.start.y,\n            command.points[0],\n            command.points[1],\n            command.points[2],\n            command.points[3],\n            command.points[4],\n            command.points[5]\n          )\n          break\n\n        case PathParser.QUAD_TO:\n\n          currentT = delta / command.pathLength\n\n          if (currentT > 1) {\n            currentT = 1\n          }\n\n          p = this.getPointOnQuadraticBezier(\n            currentT,\n            command.start.x,\n            command.start.y,\n            command.points[0],\n            command.points[1],\n            command.points[2],\n            command.points[3]\n          )\n          break\n\n        default:\n      }\n\n      if (p) {\n        return p\n      }\n\n      break\n    }\n\n    return null\n  }\n\n  protected getLineLength(\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number\n  ) {\n    return Math.sqrt(\n      (x2 - x1) * (x2 - x1)\n      + (y2 - y1) * (y2 - y1)\n    )\n  }\n\n  protected getPathLength() {\n    if (this.pathLength === -1) {\n      this.pathLength = this.dataArray.reduce<number>(\n        (length, command: IPathCommand) => (\n          command.pathLength > 0\n            ? length + command.pathLength\n            : length\n        ),\n        0\n      )\n    }\n\n    return this.pathLength\n  }\n\n  protected getPointOnCubicBezier(\n    pct: number,\n    p1x: number,\n    p1y: number,\n    p2x: number,\n    p2y: number,\n    p3x: number,\n    p3y: number,\n    p4x: number,\n    p4y: number\n  ): IPoint {\n    const x = p4x * CB1(pct) + p3x * CB2(pct) + p2x * CB3(pct) + p1x * CB4(pct)\n    const y = p4y * CB1(pct) + p3y * CB2(pct) + p2y * CB3(pct) + p1y * CB4(pct)\n\n    return {\n      x,\n      y\n    }\n  }\n\n  protected getPointOnQuadraticBezier(\n    pct: number,\n    p1x: number,\n    p1y: number,\n    p2x: number,\n    p2y: number,\n    p3x: number,\n    p3y: number\n  ): IPoint {\n    const x = p3x * QB1(pct) + p2x * QB2(pct) + p1x * QB3(pct)\n    const y = p3y * QB1(pct) + p2y * QB2(pct) + p1y * QB3(pct)\n\n    return {\n      x,\n      y\n    }\n  }\n\n  protected getPointOnEllipticalArc(\n    cx: number,\n    cy: number,\n    rx: number,\n    ry: number,\n    theta: number,\n    psi: number\n  ): IPoint {\n    const cosPsi = Math.cos(psi)\n    const sinPsi = Math.sin(psi)\n    const pt = {\n      x: rx * Math.cos(theta),\n      y: ry * Math.sin(theta)\n    }\n\n    return {\n      x: cx + (pt.x * cosPsi - pt.y * sinPsi),\n      y: cy + (pt.x * sinPsi + pt.y * cosPsi)\n    }\n  }\n\n  // TODO need some optimisations. possibly build cache only for curved segments?\n  protected buildEquidistantCache(\n    inputStep: number,\n    inputPrecision: number\n  ) {\n    const fullLen = this.getPathLength()\n    const precision = inputPrecision || 0.25 // accuracy vs performance\n    const step = inputStep || fullLen / 100\n\n    if (!this.equidistantCache\n      || this.equidistantCache.step !== step\n      || this.equidistantCache.precision !== precision\n    ) {\n      // Prepare cache\n      this.equidistantCache = {\n        step,\n        precision,\n        points: []\n      }\n\n      // Calculate points\n      let s = 0\n\n      for (let l = 0; l <= fullLen; l += precision) {\n        const p0 = this.getPointOnPath(l)\n        const p1 = this.getPointOnPath(l + precision)\n\n        if (!p0 || !p1) {\n          continue\n        }\n\n        s += this.getLineLength(p0.x, p0.y, p1.x, p1.y)\n\n        if (s >= step) {\n          this.equidistantCache.points.push({\n            x: p0.x,\n            y: p0.y,\n            distance: l\n          })\n          s -= step\n        }\n      }\n    }\n  }\n\n  protected getEquidistantPointOnPath(\n    targetDistance: number,\n    step?: number,\n    precision?: number\n  ) {\n    this.buildEquidistantCache(step, precision)\n\n    if (targetDistance < 0\n      || targetDistance - this.getPathLength() > 0.00005\n    ) {\n      return null\n    }\n\n    const idx = Math.round(\n      targetDistance\n      / this.getPathLength()\n      * (this.equidistantCache.points.length - 1)\n    )\n\n    return this.equidistantCache.points[idx] || null\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { BoundingBox } from '../BoundingBox'\nimport { Document } from './Document'\nimport { RenderedElement } from './RenderedElement'\n\n// groups: 1: mime-type (+ charset), 2: mime-type (w/o charset), 3: charset, 4: base64?, 5: body\nconst dataUriRegex = /^\\s*data:(([^/,;]+\\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i\n\nexport class ImageElement extends RenderedElement {\n  override type = 'image'\n  loaded = false\n  protected image: CanvasImageSource | string | undefined\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    const href = this.getHrefAttribute().getString()\n\n    if (!href) {\n      return\n    }\n\n    const isSvg = href.endsWith('.svg') || /^\\s*data:image\\/svg\\+xml/i.test(href)\n\n    document.images.push(this)\n\n    if (!isSvg) {\n      void this.loadImage(href)\n    } else {\n      void this.loadSvg(href)\n    }\n  }\n\n  protected async loadImage(href: string) {\n    try {\n      const image = await this.document.createImage(href)\n\n      this.image = image\n    } catch (err) {\n      console.error(`Error while loading image \"${href}\":`, err)\n    }\n\n    this.loaded = true\n  }\n\n  protected async loadSvg(href: string) {\n    const match = dataUriRegex.exec(href)\n\n    if (match) {\n      const data = match[5]\n\n      if (data) {\n        if (match[4] === 'base64') {\n          this.image = atob(data)\n        } else {\n          this.image = decodeURIComponent(data)\n        }\n      }\n    } else {\n      try {\n        const response = await this.document.fetch(href)\n        const svg = await response.text()\n\n        this.image = svg\n      } catch (err) {\n        console.error(`Error while loading image \"${href}\":`, err)\n      }\n    }\n\n    this.loaded = true\n  }\n\n  override renderChildren(ctx: RenderingContext2D) {\n    const {\n      document,\n      image,\n      loaded\n    } = this\n    const x = this.getAttribute('x').getPixels('x')\n    const y = this.getAttribute('y').getPixels('y')\n    const width = this.getStyle('width').getPixels('x')\n    const height = this.getStyle('height').getPixels('y')\n\n    if (!loaded || !image\n      || !width || !height\n    ) {\n      return\n    }\n\n    ctx.save()\n    ctx.translate(x, y)\n\n    if (typeof image === 'string') {\n      const subDocument = document.canvg.forkString(\n        ctx,\n        image,\n        {\n          ignoreMouse: true,\n          ignoreAnimation: true,\n          ignoreDimensions: true,\n          ignoreClear: true,\n          offsetX: 0,\n          offsetY: 0,\n          scaleWidth: width,\n          scaleHeight: height\n        }\n      )\n      const { documentElement } = subDocument.document\n\n      if (documentElement) {\n        documentElement.parent = this\n      }\n\n      void subDocument.render()\n    } else {\n      document.setViewBox({\n        ctx,\n        aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n        width,\n        desiredWidth: image.width as number,\n        height,\n        desiredHeight: image.height as number\n      })\n\n      if (this.loaded) {\n        if (!('complete' in image) || image.complete) {\n          ctx.drawImage(image, 0, 0)\n        }\n      }\n    }\n\n    ctx.restore()\n  }\n\n  getBoundingBox() {\n    const x = this.getAttribute('x').getPixels('x')\n    const y = this.getAttribute('y').getPixels('y')\n    const width = this.getStyle('width').getPixels('x')\n    const height = this.getStyle('height').getPixels('y')\n\n    return new BoundingBox(x, y, x + width, y + height)\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { RenderedElement } from './RenderedElement'\n\nexport class SymbolElement extends RenderedElement {\n  override type = 'symbol'\n\n  override render(_: RenderingContext2D) {\n    // NO RENDER\n  }\n}\n", "import { Document } from './Document'\n\nexport class SVGFontLoader {\n  loaded = false\n\n  constructor(\n    private readonly document: Document\n  ) {\n    document.fonts.push(this)\n  }\n\n  async load(fontFamily: string, url: string) {\n    try {\n      const { document } = this\n      const svgDocument = await document.canvg.parser.load(url)\n      const fonts = svgDocument.getElementsByTagName('font')\n\n      Array.from(fonts).forEach((fontNode) => {\n        const font = document.createElement(fontNode)\n\n        document.definitions[fontFamily] = font\n      })\n    } catch (err) {\n      console.error(`Error while loading font \"${url}\":`, err)\n    }\n\n    this.loaded = true\n  }\n}\n", "import {\n  compressSpaces,\n  getSelectorSpecificity,\n  parseExternalUrl\n} from '../util'\nimport { Property } from '../Property'\nimport { SVGFontLoader } from '../SVGFontLoader'\nimport { Document } from './Document'\nimport { Element } from './Element'\n\nexport class StyleElement extends Element {\n  static readonly parseExternalUrl = parseExternalUrl\n\n  override type = 'style'\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    const css = compressSpaces(\n      Array.from(node.childNodes)\n      // NEED TEST\n        .map(_ => _.textContent)\n        .join('')\n        .replace(/(\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+\\/)|(^[\\s]*\\/\\/.*)/gm, '') // remove comments\n        .replace(/@import.*;/g, '') // remove imports\n    )\n    const cssDefs = css.split('}')\n\n    cssDefs.forEach((_) => {\n      const def = _.trim()\n\n      if (!def) {\n        return\n      }\n\n      const cssParts = def.split('{')\n      const cssClasses = cssParts[0].split(',')\n      const cssProps = cssParts[1].split(';')\n\n      cssClasses.forEach((_) => {\n        const cssClass = _.trim()\n\n        if (!cssClass) {\n          return\n        }\n\n        const props = document.styles[cssClass] || {}\n\n        cssProps.forEach((cssProp) => {\n          const prop = cssProp.indexOf(':')\n          const name = cssProp.substr(0, prop).trim()\n          const value = cssProp.substr(prop + 1, cssProp.length - prop).trim()\n\n          if (name && value) {\n            props[name] = new Property(document, name, value)\n          }\n        })\n\n        document.styles[cssClass] = props\n        document.stylesSpecificity[cssClass] = getSelectorSpecificity(cssClass)\n\n        if (cssClass === '@font-face') { //  && !nodeEnv\n          const fontFamily = props['font-family'].getString().replace(/\"|'/g, '')\n          const srcs = props.src.getString().split(',')\n\n          srcs.forEach((src) => {\n            if (src.indexOf('format(\"svg\")') > 0) {\n              const url = parseExternalUrl(src)\n\n              if (url) {\n                void new SVGFontLoader(document).load(fontFamily, url)\n              }\n            }\n          })\n        }\n      })\n    })\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Property } from '../Property'\nimport { Transform } from '../Transform'\nimport { RenderedElement } from './RenderedElement'\nimport { PathElement } from './PathElement'\nimport { SVGElement } from './SVGElement'\n\nexport class UseElement extends RenderedElement {\n  override type = 'use'\n  private cachedElement: PathElement | undefined\n\n  override setContext(ctx: RenderingContext2D) {\n    super.setContext(ctx)\n\n    const xAttr = this.getAttribute('x')\n    const yAttr = this.getAttribute('y')\n\n    if (xAttr.hasValue()) {\n      ctx.translate(xAttr.getPixels('x'), 0)\n    }\n\n    if (yAttr.hasValue()) {\n      ctx.translate(0, yAttr.getPixels('y'))\n    }\n  }\n\n  path(ctx: RenderingContext2D) {\n    const { element } = this\n\n    if (element) {\n      element.path(ctx)\n    }\n  }\n\n  override renderChildren(ctx: RenderingContext2D) {\n    const {\n      document,\n      element\n    } = this\n\n    if (element) {\n      let tempSvg: RenderedElement = element\n\n      if (element.type === 'symbol') {\n        // render me using a temporary svg element in symbol cases (http://www.w3.org/TR/SVG/struct.html#UseElement)\n        tempSvg = new SVGElement(document)\n        tempSvg.attributes.viewBox = new Property(\n          document,\n          'viewBox',\n          element.getAttribute('viewBox').getString()\n        )\n        tempSvg.attributes.preserveAspectRatio = new Property(\n          document,\n          'preserveAspectRatio',\n          element.getAttribute('preserveAspectRatio').getString()\n        )\n        tempSvg.attributes.overflow = new Property(\n          document,\n          'overflow',\n          element.getAttribute('overflow').getString()\n        )\n        tempSvg.children = element.children\n\n        // element is still the parent of the children\n        element.styles.opacity = new Property(\n          document,\n          'opacity',\n          this.calculateOpacity()\n        )\n      }\n\n      if (tempSvg.type === 'svg') {\n        const widthStyle = this.getStyle('width', false, true)\n        const heightStyle = this.getStyle('height', false, true)\n\n        // if symbol or svg, inherit width/height from me\n        if (widthStyle.hasValue()) {\n          tempSvg.attributes.width = new Property(\n            document,\n            'width',\n            widthStyle.getString()\n          )\n        }\n\n        if (heightStyle.hasValue()) {\n          tempSvg.attributes.height = new Property(\n            document,\n            'height',\n            heightStyle.getString()\n          )\n        }\n      }\n\n      const oldParent = tempSvg.parent\n\n      tempSvg.parent = this\n      tempSvg.render(ctx)\n      tempSvg.parent = oldParent\n    }\n  }\n\n  getBoundingBox(ctx: CanvasRenderingContext2D) {\n    const { element } = this\n\n    if (element) {\n      return element.getBoundingBox(ctx)\n    }\n\n    return null\n  }\n\n  elementTransform() {\n    const {\n      document,\n      element\n    } = this\n\n    if (!element) {\n      return null\n    }\n\n    return Transform.fromElement(document, element)\n  }\n\n  protected get element() {\n    if (!this.cachedElement) {\n      this.cachedElement = this.getHrefAttribute().getDefinition()\n    }\n\n    return this.cachedElement\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { toNumbers } from '../util'\nimport { Document } from './Document'\nimport { Element } from './Element'\n\nfunction imGet(\n  img: Uint8ClampedArray,\n  x: number,\n  y: number,\n  width: number,\n  _height: number,\n  rgba: number\n) {\n  return img[y * width * 4 + x * 4 + rgba]\n}\n\nfunction imSet(\n  img: Uint8ClampedArray,\n  x: number,\n  y: number,\n  width: number,\n  _height: number,\n  rgba: number,\n  val: number\n) {\n  img[y * width * 4 + x * 4 + rgba] = val\n}\n\nfunction m(\n  matrix: number[],\n  i: number,\n  v: number\n) {\n  const mi = matrix[i]\n\n  return mi * v\n}\n\nfunction c(\n  a: number,\n  m1: number,\n  m2: number,\n  m3: number\n) {\n  return m1 + Math.cos(a) * m2 + Math.sin(a) * m3\n}\n\nexport class FeColorMatrixElement extends Element {\n  override type = 'feColorMatrix'\n  protected readonly matrix: number[]\n  protected readonly includeOpacity: boolean\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    let matrix = toNumbers(this.getAttribute('values').getString())\n\n    switch (this.getAttribute('type').getString('matrix')) { // http://www.w3.org/TR/SVG/filters.html#feColorMatrixElement\n      case 'saturate': {\n        const s = matrix[0]\n\n        /* eslint-disable array-element-newline */\n        matrix = [\n          0.213 + 0.787 * s, 0.715 - 0.715 * s, 0.072 - 0.072 * s, 0, 0,\n          0.213 - 0.213 * s, 0.715 + 0.285 * s, 0.072 - 0.072 * s, 0, 0,\n          0.213 - 0.213 * s, 0.715 - 0.715 * s, 0.072 + 0.928 * s, 0, 0,\n          0, 0, 0, 1, 0,\n          0, 0, 0, 0, 1\n        ]\n        /* eslint-enable array-element-newline */\n        break\n      }\n\n      case 'hueRotate': {\n        const a = matrix[0] * Math.PI / 180.0\n\n        /* eslint-disable array-element-newline */\n        matrix = [\n          c(a, 0.213, 0.787, -0.213), c(a, 0.715, -0.715, -0.715), c(a, 0.072, -0.072, 0.928), 0, 0,\n          c(a, 0.213, -0.213, 0.143), c(a, 0.715, 0.285, 0.140), c(a, 0.072, -0.072, -0.283), 0, 0,\n          c(a, 0.213, -0.213, -0.787), c(a, 0.715, -0.715, 0.715), c(a, 0.072, 0.928, 0.072), 0, 0,\n          0, 0, 0, 1, 0,\n          0, 0, 0, 0, 1\n        ]\n        /* eslint-enable array-element-newline */\n        break\n      }\n\n      case 'luminanceToAlpha':\n        /* eslint-disable array-element-newline */\n        matrix = [\n          0, 0, 0, 0, 0,\n          0, 0, 0, 0, 0,\n          0, 0, 0, 0, 0,\n          0.2125, 0.7154, 0.0721, 0, 0,\n          0, 0, 0, 0, 1\n        ]\n        /* eslint-enable array-element-newline */\n        break\n\n      default:\n    }\n\n    this.matrix = matrix\n    this.includeOpacity = this.getAttribute('includeOpacity').hasValue()\n  }\n\n  apply(\n    ctx: RenderingContext2D,\n    _x: number,\n    _y: number,\n    width: number,\n    height: number\n  ) {\n    // assuming x==0 && y==0 for now\n    const {\n      includeOpacity,\n      matrix\n    } = this\n    const srcData = ctx.getImageData(0, 0, width, height)\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const r = imGet(srcData.data, x, y, width, height, 0)\n        const g = imGet(srcData.data, x, y, width, height, 1)\n        const b = imGet(srcData.data, x, y, width, height, 2)\n        const a = imGet(srcData.data, x, y, width, height, 3)\n        let nr = m(matrix, 0, r) + m(matrix, 1, g) + m(matrix, 2, b) + m(matrix, 3, a) + m(matrix, 4, 1)\n        let ng = m(matrix, 5, r) + m(matrix, 6, g) + m(matrix, 7, b) + m(matrix, 8, a) + m(matrix, 9, 1)\n        let nb = m(matrix, 10, r) + m(matrix, 11, g) + m(matrix, 12, b) + m(matrix, 13, a) + m(matrix, 14, 1)\n        let na = m(matrix, 15, r) + m(matrix, 16, g) + m(matrix, 17, b) + m(matrix, 18, a) + m(matrix, 19, 1)\n\n        if (includeOpacity) {\n          nr = 0\n          ng = 0\n          nb = 0\n          na *= a / 255\n        }\n\n        imSet(srcData.data, x, y, width, height, 0, nr)\n        imSet(srcData.data, x, y, width, height, 1, ng)\n        imSet(srcData.data, x, y, width, height, 2, nb)\n        imSet(srcData.data, x, y, width, height, 3, na)\n      }\n    }\n\n    ctx.clearRect(0, 0, width, height)\n    ctx.putImageData(srcData, 0, 0)\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { BoundingBox } from '../BoundingBox'\nimport { Element } from './Element'\nimport { PathElement } from './PathElement'\nimport { FeColorMatrixElement } from './FeColorMatrixElement'\n\nexport class MaskElement extends Element {\n  static ignoreStyles = [\n    'mask',\n    'transform',\n    'clip-path'\n  ]\n\n  override type = 'mask'\n\n  apply(ctx: RenderingContext2D, element: Element) {\n    const { document } = this\n    // render as temp svg\n    let x = this.getAttribute('x').getPixels('x')\n    let y = this.getAttribute('y').getPixels('y')\n    let width = this.getStyle('width').getPixels('x')\n    let height = this.getStyle('height').getPixels('y')\n\n    if (!width && !height) {\n      const boundingBox = new BoundingBox()\n\n      this.children.forEach((child: PathElement) => {\n        boundingBox.addBoundingBox(child.getBoundingBox(ctx))\n      })\n\n      x = Math.floor(boundingBox.x1)\n      y = Math.floor(boundingBox.y1)\n      width = Math.floor(boundingBox.width)\n      height = Math.floor(boundingBox.height)\n    }\n\n    const ignoredStyles = this.removeStyles(element, MaskElement.ignoreStyles)\n    const maskCanvas = document.createCanvas(x + width, y + height)\n    const maskCtx = maskCanvas.getContext('2d')\n\n    document.screen.setDefaults(maskCtx)\n    this.renderChildren(maskCtx)\n\n    // convert mask to alpha with a fake node\n    // TODO: refactor out apply from feColorMatrix\n    new FeColorMatrixElement(\n      document,\n      ({\n        nodeType: 1,\n        childNodes: [],\n        attributes: [\n          {\n            nodeName: 'type',\n            value: 'luminanceToAlpha'\n          },\n          {\n            nodeName: 'includeOpacity',\n            value: 'true'\n          }\n        ]\n      }) as unknown as HTMLElement\n    ).apply(maskCtx, 0, 0, x + width, y + height)\n\n    const tmpCanvas = document.createCanvas(x + width, y + height)\n    const tmpCtx = tmpCanvas.getContext('2d')\n\n    document.screen.setDefaults(tmpCtx)\n    element.render(tmpCtx)\n\n    tmpCtx.globalCompositeOperation = 'destination-in'\n    tmpCtx.fillStyle = maskCtx.createPattern(maskCanvas as CanvasImageSource, 'no-repeat')\n    tmpCtx.fillRect(0, 0, x + width, y + height)\n\n    ctx.fillStyle = tmpCtx.createPattern(tmpCanvas as CanvasImageSource, 'no-repeat')\n    ctx.fillRect(0, 0, x + width, y + height)\n\n    // reassign mask\n    this.restoreStyles(element, ignoredStyles)\n  }\n\n  override render(_: RenderingContext2D) {\n    // NO RENDER\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Transform } from '../Transform'\nimport { Element } from './Element'\nimport { UseElement } from './UseElement'\n\nconst noop = () => {\n  // NOOP\n}\n\nexport class ClipPathElement extends Element {\n  override type = 'clipPath'\n\n  apply(ctx: RenderingContext2D) {\n    const { document } = this\n    const contextProto = Reflect.getPrototypeOf(ctx) as RenderingContext2D | null\n    const {\n      beginPath,\n      closePath\n    } = ctx\n\n    if (contextProto) {\n      contextProto.beginPath = noop\n      contextProto.closePath = noop\n    }\n\n    Reflect.apply(beginPath, ctx, [])\n\n    this.children.forEach((child: Element | UseElement) => {\n      if (!('path' in child)) {\n        return\n      }\n\n      let transform = 'elementTransform' in child\n        ? child.elementTransform()\n        : null // handle <use />\n\n      if (!transform) {\n        transform = Transform.fromElement(document, child)\n      }\n\n      if (transform) {\n        transform.apply(ctx)\n      }\n\n      child.path(ctx)\n\n      if (contextProto) {\n        contextProto.closePath = closePath\n      }\n\n      if (transform) {\n        transform.unapply(ctx)\n      }\n    })\n\n    Reflect.apply(closePath, ctx, [])\n    ctx.clip()\n\n    if (contextProto) {\n      contextProto.beginPath = beginPath\n      contextProto.closePath = closePath\n    }\n  }\n\n  override render(_: RenderingContext2D) {\n    // NO RENDER\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Element } from './Element'\nimport { PathElement } from './PathElement'\nimport { FeGaussianBlurElement } from './FeGaussianBlurElement'\n\nexport class FilterElement extends Element {\n  static ignoreStyles = [\n    'filter',\n    'transform',\n    'clip-path'\n  ]\n\n  override type = 'filter'\n\n  apply(ctx: RenderingContext2D, element: Element | PathElement) {\n    // render as temp svg\n    const {\n      document,\n      children\n    } = this\n    const boundingBox = 'getBoundingBox' in element\n      ? element.getBoundingBox(ctx)\n      : null\n\n    if (!boundingBox) {\n      return\n    }\n\n    let px = 0\n    let py = 0\n\n    children.forEach((child: FeGaussianBlurElement) => {\n      const efd = child.extraFilterDistance || 0\n\n      px = Math.max(px, efd)\n      py = Math.max(py, efd)\n    })\n\n    const width = Math.floor(boundingBox.width)\n    const height = Math.floor(boundingBox.height)\n    const tmpCanvasWidth = width + 2 * px\n    const tmpCanvasHeight = height + 2 * py\n\n    if (tmpCanvasWidth < 1 || tmpCanvasHeight < 1) {\n      return\n    }\n\n    const x = Math.floor(boundingBox.x)\n    const y = Math.floor(boundingBox.y)\n    const ignoredStyles = this.removeStyles(element, FilterElement.ignoreStyles)\n    const tmpCanvas = document.createCanvas(tmpCanvasWidth, tmpCanvasHeight)\n    const tmpCtx = tmpCanvas.getContext('2d')\n\n    document.screen.setDefaults(tmpCtx)\n    tmpCtx.translate(-x + px, -y + py)\n    element.render(tmpCtx)\n\n    // apply filters\n    children.forEach((child: FeGaussianBlurElement) => {\n      if (typeof child.apply === 'function') {\n        child.apply(\n          tmpCtx,\n          0,\n          0,\n          tmpCanvasWidth,\n          tmpCanvasHeight\n        )\n      }\n    })\n\n    // render on me\n    ctx.drawImage(\n      tmpCanvas,\n      0,\n      0,\n      tmpCanvasWidth,\n      tmpCanvasHeight,\n      x - px,\n      y - py,\n      tmpCanvasWidth,\n      tmpCanvasHeight\n    )\n\n    this.restoreStyles(element, ignoredStyles)\n  }\n\n  override render(_: RenderingContext2D) {\n    // NO RENDER\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Document } from './Document'\nimport { Element } from './Element'\n\nexport class FeDropShadowElement extends Element {\n  override type = 'feDropShadow'\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.addStylesFromStyleDefinition()\n  }\n\n  apply(\n    _: RenderingContext2D,\n    _x: number,\n    _y: number,\n    _width: number,\n    _height: number\n  ) {\n    // TODO: implement\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Element } from './Element'\n\nexport class FeMorphologyElement extends Element {\n  override type = 'feMorphology'\n\n  apply(\n    _: RenderingContext2D,\n    _x: number,\n    _y: number,\n    _width: number,\n    _height: number\n  ) {\n    // TODO: implement\n  }\n}\n", "import { RenderingContext2D } from '../types'\nimport { Element } from './Element'\n\nexport class FeCompositeElement extends Element {\n  override type = 'feComposite'\n\n  apply(\n    _: RenderingContext2D,\n    _x: number,\n    _y: number,\n    _width: number,\n    _height: number\n  ) {\n    // TODO: implement\n  }\n}\n", "import { canvasRGBA } from 'stackblur-canvas'\nimport { RenderingContext2D } from '../types'\nimport { Document } from './Document'\nimport { Element } from './Element'\n\nexport class FeGaussianBlurElement extends Element {\n  override type = 'feGaussianBlur'\n  readonly extraFilterDistance: number\n  protected readonly blurRadius: number\n\n  constructor(\n    document: Document,\n    node: HTMLElement,\n    captureTextNodes?: boolean\n  ) {\n    super(document, node, captureTextNodes)\n\n    this.blurRadius = Math.floor(this.getAttribute('stdDeviation').getNumber())\n    this.extraFilterDistance = this.blurRadius\n  }\n\n  apply(\n    ctx: RenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number\n  ) {\n    const {\n      document,\n      blurRadius\n    } = this\n    const body = document.window\n      ? document.window.document.body\n      : null\n    const canvas = ctx.canvas as HTMLCanvasElement\n\n    // StackBlur requires canvas be on document\n    canvas.id = document.getUniqueId()\n\n    if (body) {\n      canvas.style.display = 'none'\n      body.appendChild(canvas)\n    }\n\n    canvasRGBA(canvas, x, y, width, height, blurRadius)\n\n    if (body) {\n      body.removeChild(canvas)\n    }\n  }\n}\n", "import { Element } from './Element'\n\nexport class TitleElement extends Element {\n  override type = 'title'\n}\n", "import { Element } from './Element'\n\nexport class DescElement extends Element {\n  override type = 'desc'\n}\n", "import { Element } from './Element'\nimport { UnknownElement } from './UnknownElement'\nimport { RenderedElement } from './RenderedElement'\nimport { PathElement } from './PathElement'\nimport { SVGElement } from './SVGElement'\nimport { RectElement } from './RectElement'\nimport { CircleElement } from './CircleElement'\nimport { EllipseElement } from './EllipseElement'\nimport { LineElement } from './LineElement'\nimport { PolylineElement } from './PolylineElement'\nimport { PolygonElement } from './PolygonElement'\nimport { PatternElement } from './PatternElement'\nimport { MarkerElement } from './MarkerElement'\nimport { DefsElement } from './DefsElement'\nimport { GradientElement } from './GradientElement'\nimport { LinearGradientElement } from './LinearGradientElement'\nimport { RadialGradientElement } from './RadialGradientElement'\nimport { StopElement } from './StopElement'\nimport { AnimateElement } from './AnimateElement'\nimport { AnimateColorElement } from './AnimateColorElement'\nimport { AnimateTransformElement } from './AnimateTransformElement'\nimport { FontElement } from './FontElement'\nimport { FontFaceElement } from './FontFaceElement'\nimport { MissingGlyphElement } from './MissingGlyphElement'\nimport { GlyphElement } from './GlyphElement'\nimport { TextElement } from './TextElement'\nimport { TSpanElement } from './TSpanElement'\nimport { TRefElement } from './TRefElement'\nimport { AElement } from './AElement'\nimport { TextPathElement } from './TextPathElement'\nimport { ImageElement } from './ImageElement'\nimport { GElement } from './GElement'\nimport { SymbolElement } from './SymbolElement'\nimport { StyleElement } from './StyleElement'\nimport { UseElement } from './UseElement'\nimport { MaskElement } from './MaskElement'\nimport { ClipPathElement } from './ClipPathElement'\nimport { FilterElement } from './FilterElement'\nimport { FeDropShadowElement } from './FeDropShadowElement'\nimport { FeMorphologyElement } from './FeMorphologyElement'\nimport { FeCompositeElement } from './FeCompositeElement'\nimport { FeColorMatrixElement } from './FeColorMatrixElement'\nimport { FeGaussianBlurElement } from './FeGaussianBlurElement'\nimport { TitleElement } from './TitleElement'\nimport { DescElement } from './DescElement'\n\nexport const elements = {\n  'svg': SVGElement,\n  'rect': RectElement,\n  'circle': CircleElement,\n  'ellipse': EllipseElement,\n  'line': LineElement,\n  'polyline': PolylineElement,\n  'polygon': PolygonElement,\n  'path': PathElement,\n  'pattern': PatternElement,\n  'marker': MarkerElement,\n  'defs': DefsElement,\n  'linearGradient': LinearGradientElement,\n  'radialGradient': RadialGradientElement,\n  'stop': StopElement,\n  'animate': AnimateElement,\n  'animateColor': AnimateColorElement,\n  'animateTransform': AnimateTransformElement,\n  'font': FontElement,\n  'font-face': FontFaceElement,\n  'missing-glyph': MissingGlyphElement,\n  'glyph': GlyphElement,\n  'text': TextElement,\n  'tspan': TSpanElement,\n  'tref': TRefElement,\n  'a': AElement,\n  'textPath': TextPathElement,\n  'image': ImageElement,\n  'g': GElement,\n  'symbol': SymbolElement,\n  'style': StyleElement,\n  'use': UseElement,\n  'mask': MaskElement,\n  'clipPath': ClipPathElement,\n  'filter': FilterElement,\n  'feDropShadow': FeDropShadowElement,\n  'feMorphology': FeMorphologyElement,\n  'feComposite': FeCompositeElement,\n  'feColorMatrix': FeColorMatrixElement,\n  'feGaussianBlur': FeGaussianBlurElement,\n  'title': TitleElement,\n  'desc': DescElement\n}\n\ntype Elements = typeof elements\n\nexport type AnyElement = Elements[keyof Elements]\n\nexport {\n  Element,\n  UnknownElement,\n  RenderedElement,\n  PathElement,\n  SVGElement,\n  RectElement,\n  CircleElement,\n  EllipseElement,\n  LineElement,\n  PolylineElement,\n  PolygonElement,\n  PatternElement,\n  MarkerElement,\n  DefsElement,\n  GradientElement,\n  LinearGradientElement,\n  RadialGradientElement,\n  StopElement,\n  AnimateElement,\n  AnimateColorElement,\n  AnimateTransformElement,\n  FontElement,\n  FontFaceElement,\n  MissingGlyphElement,\n  GlyphElement,\n  TextElement,\n  TSpanElement,\n  TRefElement,\n  AElement,\n  TextPathElement,\n  ImageElement,\n  GElement,\n  SymbolElement,\n  StyleElement,\n  UseElement,\n  MaskElement,\n  ClipPathElement,\n  FilterElement,\n  FeDropShadowElement,\n  FeMorphologyElement,\n  FeCompositeElement,\n  FeColorMatrixElement,\n  FeGaussianBlurElement,\n  TitleElement,\n  DescElement\n}\n", "/* eslint-disable @typescript-eslint/no-use-before-define */\nimport { Canvg } from '../Canvg'\nimport { IScreenViewBoxConfig, Screen } from '../Screen'\nimport { Property } from '../Property'\nimport { SVGFontLoader } from '../SVGFontLoader'\nimport { Element } from './Element'\nimport { UnknownElement } from './UnknownElement'\nimport { TextNode } from './TextNode'\nimport { ImageElement } from './ImageElement'\nimport { SVGElement } from './SVGElement'\nimport {\n  AnyElement,\n  elements as elementTypes\n} from './elements'\n\n/**\n * Function to create new canvas.\n */\nexport type CreateCanvas = (width: number, height: number) => HTMLCanvasElement | OffscreenCanvas\n\n/**\n * Function to create new image.\n */\nexport type CreateImage = (src: string, anonymousCrossOrigin?: boolean) => Promise<CanvasImageSource>\n\nexport interface IDocumentOptions {\n  /**\n   * Default `rem` size.\n   */\n  rootEmSize?: number\n  /**\n   * Default `em` size.\n   */\n  emSize?: number\n  /**\n   * Function to create new canvas.\n   */\n  createCanvas?: CreateCanvas\n  /**\n   * Function to create new image.\n   */\n  createImage?: CreateImage\n  /**\n   * Load images anonymously.\n   */\n  anonymousCrossOrigin?: boolean\n}\n\nexport type IViewBoxConfig = Omit<IScreenViewBoxConfig, 'document'>\n\ntype DOMDocument = typeof window.document\n\nfunction createCanvas(width: number, height: number) {\n  const canvas = document.createElement('canvas')\n\n  canvas.width = width\n  canvas.height = height\n\n  return canvas\n}\n\nasync function createImage(src: string, anonymousCrossOrigin = false) {\n  const image = document.createElement('img')\n\n  if (anonymousCrossOrigin) {\n    image.crossOrigin = 'Anonymous'\n  }\n\n  return new Promise<HTMLImageElement>((resolve, reject) => {\n    image.onload = () => {\n      resolve(image)\n    }\n\n    image.onerror = (_event, _source, _lineno, _colno, error) => {\n      reject(error)\n    }\n\n    image.src = src\n  })\n}\n\nconst DEFAULT_EM_SIZE = 12\n\nexport class Document {\n  static readonly createCanvas = createCanvas\n  static readonly createImage = createImage\n  static readonly elementTypes: Record<string, AnyElement> = elementTypes\n\n  rootEmSize: number\n  documentElement?: SVGElement\n  readonly screen: Screen\n  readonly createCanvas: CreateCanvas\n  readonly createImage: CreateImage\n  readonly definitions: Record<string, Element> = {}\n  readonly styles: Record<string, Record<string, Property>> = {}\n  readonly stylesSpecificity: Record<string, string> = {}\n  readonly images: ImageElement[] = []\n  readonly fonts: SVGFontLoader[] = []\n  private readonly emSizeStack: number[] = []\n  private uniqueId = 0\n\n  constructor(\n    readonly canvg: Canvg,\n    {\n      rootEmSize = DEFAULT_EM_SIZE,\n      emSize = DEFAULT_EM_SIZE,\n      createCanvas = Document.createCanvas,\n      createImage = Document.createImage,\n      anonymousCrossOrigin\n    }: IDocumentOptions = {}\n  ) {\n    this.screen = canvg.screen\n    this.rootEmSize = rootEmSize\n    this.emSize = emSize\n    this.createCanvas = createCanvas\n    this.createImage = this.bindCreateImage(createImage, anonymousCrossOrigin)\n\n    this.screen.wait(() => this.isImagesLoaded())\n    this.screen.wait(() => this.isFontsLoaded())\n  }\n\n  private bindCreateImage(createImage: CreateImage, anonymousCrossOrigin?: boolean) {\n    if (typeof anonymousCrossOrigin === 'boolean') {\n      return (source: string, forceAnonymousCrossOrigin?: boolean) => createImage(\n        source,\n        typeof forceAnonymousCrossOrigin === 'boolean'\n          ? forceAnonymousCrossOrigin\n          : anonymousCrossOrigin\n      )\n    }\n\n    return createImage\n  }\n\n  get window() {\n    return this.screen.window\n  }\n\n  get fetch() {\n    return this.screen.fetch\n  }\n\n  get ctx() {\n    return this.screen.ctx\n  }\n\n  get emSize() {\n    const { emSizeStack } = this\n\n    return emSizeStack[emSizeStack.length - 1] || DEFAULT_EM_SIZE\n  }\n\n  set emSize(value: number) {\n    const { emSizeStack } = this\n\n    emSizeStack.push(value)\n  }\n\n  popEmSize() {\n    const { emSizeStack } = this\n\n    emSizeStack.pop()\n  }\n\n  getUniqueId() {\n    return `canvg${++this.uniqueId}`\n  }\n\n  isImagesLoaded() {\n    return this.images.every(_ => _.loaded)\n  }\n\n  isFontsLoaded() {\n    return this.fonts.every(_ => _.loaded)\n  }\n\n  createDocumentElement(document: DOMDocument) {\n    const documentElement = this.createElement<SVGElement>(document.documentElement)\n\n    documentElement.root = true\n    documentElement.addStylesFromStyleDefinition()\n\n    this.documentElement = documentElement\n\n    return documentElement\n  }\n\n  createElement<T extends Element>(node: HTMLElement) {\n    const elementType = node.nodeName.replace(/^[^:]+:/, '')\n    const ElementType = Document.elementTypes[elementType]\n\n    if (ElementType) {\n      return new ElementType(this, node) as T\n    }\n\n    return new UnknownElement(this, node) as T\n  }\n\n  createTextNode(node: HTMLElement) {\n    return new TextNode(this, node)\n  }\n\n  setViewBox(config: IViewBoxConfig) {\n    this.screen.setViewBox({\n      document: this,\n      ...config\n    })\n  }\n}\n", "import { RenderingContext2D } from './types'\nimport { IParserOptions, Parser } from './Parser'\nimport {\n  IScreenOptions,\n  IScreenStartOptions,\n  Screen\n} from './Screen'\nimport {\n  IDocumentOptions,\n  Document,\n  SVGElement\n} from './Document'\n\ntype DOMDocument = typeof window.document\n\nexport interface IOptions extends IParserOptions,\n  IScreenOptions,\n  IScreenStartOptions,\n  IDocumentOptions {}\n\n/**\n * SVG renderer on canvas.\n */\nexport class Canvg {\n  /**\n   * Create Canvg instance from SVG source string or URL.\n   * @param ctx - Rendering context.\n   * @param svg - SVG source string or URL.\n   * @param options - Rendering options.\n   * @returns Canvg instance.\n   */\n  static async from(\n    ctx: RenderingContext2D,\n    svg: string,\n    options: IOptions = {}\n  ) {\n    const parser = new Parser(options)\n    const svgDocument = await parser.parse(svg)\n\n    return new Canvg(ctx, svgDocument, options)\n  }\n\n  /**\n   * Create Canvg instance from SVG source string.\n   * @param ctx - Rendering context.\n   * @param svg - SVG source string.\n   * @param options - Rendering options.\n   * @returns Canvg instance.\n   */\n  static fromString(\n    ctx: RenderingContext2D,\n    svg: string,\n    options: IOptions = {}\n  ) {\n    const parser = new Parser(options)\n    const svgDocument = parser.parseFromString(svg)\n\n    return new Canvg(ctx, svgDocument, options)\n  }\n\n  /**\n   * XML/HTML parser instance.\n   */\n  readonly parser: Parser\n  /**\n   * Screen instance.\n   */\n  readonly screen: Screen\n  /**\n   * Canvg Document.\n   */\n  readonly document: Document\n  private readonly documentElement: SVGElement\n  private readonly options: IOptions\n\n  /**\n   * Main constructor.\n   * @param ctx - Rendering context.\n   * @param svg - SVG Document.\n   * @param options - Rendering options.\n   */\n  constructor(\n    ctx: RenderingContext2D,\n    svg: DOMDocument,\n    options: IOptions = {}\n  ) {\n    this.parser = new Parser(options)\n    this.screen = new Screen(ctx, options)\n    this.options = options\n\n    const document = new Document(this, options)\n    const documentElement = document.createDocumentElement(svg)\n\n    this.document = document\n    this.documentElement = documentElement\n  }\n\n  /**\n   * Create new Canvg instance with inherited options.\n   * @param ctx - Rendering context.\n   * @param svg - SVG source string or URL.\n   * @param options - Rendering options.\n   * @returns Canvg instance.\n   */\n  fork(\n    ctx: RenderingContext2D,\n    svg: string,\n    options: IOptions = {}\n  ) {\n    return Canvg.from(ctx, svg, {\n      ...this.options,\n      ...options\n    })\n  }\n\n  /**\n   * Create new Canvg instance with inherited options.\n   * @param ctx - Rendering context.\n   * @param svg - SVG source string.\n   * @param options - Rendering options.\n   * @returns Canvg instance.\n   */\n  forkString(\n    ctx: RenderingContext2D,\n    svg: string,\n    options: IOptions = {}\n  ) {\n    return Canvg.fromString(ctx, svg, {\n      ...this.options,\n      ...options\n    })\n  }\n\n  /**\n   * Document is ready promise.\n   * @returns Ready promise.\n   */\n  ready() {\n    return this.screen.ready()\n  }\n\n  /**\n   * Document is ready value.\n   * @returns Is ready or not.\n   */\n  isReady() {\n    return this.screen.isReady()\n  }\n\n  /**\n   * Render only first frame, ignoring animations and mouse.\n   * @param options - Rendering options.\n   */\n  async render(options: IScreenStartOptions = {}) {\n    this.start({\n      enableRedraw: true,\n      ignoreAnimation: true,\n      ignoreMouse: true,\n      ...options\n    })\n\n    await this.ready()\n\n    this.stop()\n  }\n\n  /**\n   * Start rendering.\n   * @param options - Render options.\n   */\n  start(options: IScreenStartOptions = {}) {\n    const {\n      documentElement,\n      screen,\n      options: baseOptions\n    } = this\n\n    screen.start(documentElement, {\n      enableRedraw: true,\n      ...baseOptions,\n      ...options\n    })\n  }\n\n  /**\n   * Stop rendering.\n   */\n  stop() {\n    this.screen.stop()\n  }\n\n  /**\n   * Resize SVG to fit in given size.\n   * @param width\n   * @param height\n   * @param preserveAspectRatio\n   */\n  resize(\n    width: number,\n    height = width,\n    preserveAspectRatio: boolean | string = false\n  ) {\n    this.documentElement.resize(width, height, preserveAspectRatio)\n  }\n}\n"],
  "mappings": "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AK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAAG;AACzwC,MAAI,WAAW,CAAC,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,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",
  "names": ["createCanvas", "c2", "y", "i", "w", "h", "a", "b", "r", "g", "d", "j", "c", "self", "v", "compareImages", "i", "e", "bits", "i", "r", "g", "b", "j", "e", "slice", "options", "vnodeId", "isValidElement", "rerenderQueue", "prevDebounce", "i", "EMPTY_OBJ", "EMPTY_ARR", "IS_NON_DIMENSIONAL", "assign", "obj", "props", "removeNode", "node", "parentNode", "removeChild", "createElement", "type", "children", "key", "ref", "normalizedProps", "arguments", "length", "call", "defaultProps", "createVNode", "original", "vnode", "__k", "__", "__b", "__e", "__d", "__c", "__h", "constructor", "__v", "Fragment", "props", "children", "Component", "context", "this", "getDomSibling", "vnode", "childIndex", "__", "__k", "indexOf", "sibling", "length", "__e", "type", "updateParentDomPointers", "i", "child", "__c", "base", "enqueueRender", "c", "__d", "rerenderQueue", "push", "process", "prevDebounce", "options", "debounceRendering", "setTimeout", "queue", "__r", "sort", "a", "b", "__v", "__b", "some", "component", "commitQueue", "oldVNode", "oldDom", "parentDom", "__P", "assign", "diff", "ownerSVGElement", "__h", "commitRoot", "diffChildren", "renderResult", "newParentVNode", "oldParentVNode", "globalContext", "isSvg", "excessDomChildren", "isHydrating", "j", "childVNode", "newDom", "firstChildDom", "refs", "oldChildren", "EMPTY_ARR", "oldChildrenLength", "createVNode", "Array", "isArray", "key", "ref", "EMPTY_OBJ", "reorderChildren", "placeChild", "parentNode", "unmount", "applyRef", "tmp", "placeChild", "parentDom", "childVNode", "oldVNode", "oldChildren", "newDom", "oldDom", "nextDom", "sibDom", "j", "__d", "parentNode", "outer", "appendChild", "nextSibling", "length", "insertBefore", "diffProps", "dom", "newProps", "oldProps", "isSvg", "hydrate", "i", "setProperty", "setStyle", "style", "key", "value", "IS_NON_DIMENSIONAL", "test", "name", "oldValue", "useCapture", "o", "cssText", "replace", "toLowerCase", "slice", "l", "addEventListener", "eventProxyCapture", "eventProxy", "removeEventListener", "e", "indexOf", "removeAttribute", "setAttribute", "this", "type", "options", "event", "diff", "newVNode", "globalContext", "excessDomChildren", "commitQueue", "isHydrating", "tmp", "c", "isNew", "oldState", "snapshot", "clearProcessingException", "provider", "componentContext", "renderHook", "count", "renderResult", "newType", "constructor", "__h", "__e", "props", "contextType", "__c", "__", "__E", "prototype", "render", "Component", "doRender", "sub", "state", "context", "_sb", "__s", "getDerivedStateFromProps", "assign", "componentWillMount", "componentDidMount", "push", "componentWillReceiveProps", "shouldComponentUpdate", "__v", "__k", "forEach", "vnode", "componentWillUpdate", "componentDidUpdate", "__P", "__r", "getChildContext", "getSnapshotBeforeUpdate", "Fragment", "children", "diffChildren", "Array", "isArray", "base", "diffElementNodes", "diffed", "commitRoot", "root", "some", "cb", "call", "child", "oldHtml", "newHtml", "nodeType", "localName", "document", "createTextNode", "createElementNS", "createElement", "is", "data", "childNodes", "EMPTY_OBJ", "dangerouslySetInnerHTML", "attributes", "__html", "innerHTML", "getDomSibling", "removeNode", "checked", "applyRef", "ref", "current", "unmount", "parentVNode", "skipRemove", "r", "componentWillUnmount", "replaceNode", "ownerSVGElement", "firstChild", "slice", "EMPTY_ARR", "options", "__e", "error", "vnode", "oldVNode", "errorInfo", "component", "ctor", "handled", "__", "__c", "constructor", "getDerivedStateFromError", "setState", "__d", "componentDidCatch", "__E", "e", "vnodeId", "isValidElement", "Component", "prototype", "update", "callback", "s", "this", "__s", "state", "assign", "props", "__v", "_sb", "push", "enqueueRender", "forceUpdate", "render", "Fragment", "rerenderQueue", "process", "__r", "i", "extendStatics", "d", "b", "Object", "setPrototypeOf", "__proto__", "Array", "p", "prototype", "hasOwnProperty", "call", "__extends", "TypeError", "String", "__", "this", "constructor", "create", "encodeSVGPath", "commands", "str", "isArray", "i", "length", "command", "type", "SVGPathData", "CLOSE_PATH", "HORIZ_LINE_TO", "relative", "x", "VERT_LINE_TO", "y", "MOVE_TO", "LINE_TO", "CURVE_TO", "x1", "y1", "x2", "y2", "SMOOTH_CURVE_TO", "QUAD_TO", "SMOOTH_QUAD_TO", "ARC", "Error", "rX", "rY", "xRot", "lArcFlag", "sweepFlag", "rotate", "_a", "rad", "Math", "cos", "sin", "assertNumbers", "t", "r", "_i", "numbers", "PI", "annotateArcCommand", "c", "abs", "x1_", "y1_", "testValue", "pow", "sqrt", "c_ScaleTemp", "c_Scale", "max", "cx_", "cy_", "cRot", "cX", "cY", "phi1", "atan2", "phi2", "intersectionUnitCircleLine", "a", "termSqr", "term", "SVGPathDataTransformer", "DEG", "lerp", "arcAt", "phiDeg", "bezierRoot", "x0", "x3", "EPS", "x01", "x12", "q", "PRECISION", "discriminantX4", "root", "bezierAt", "s", "TO_ABS", "INFO", "prevX", "prevY", "NORMALIZE_ST", "prevCurveC2X", "NaN", "prevCurveC2Y", "prevQuadCX", "prevQuadCY", "isNaN", "QT_TO_C", "prevQuadX1", "prevQuadY1", "f", "prevXAbs", "prevYAbs", "pathStartXAbs", "pathStartYAbs", "result", "MATRIX", "e", "pathStartX", "origX1", "origX2", "comRel", "sqr", "det", "sinRot", "cosRot", "xCurve", "yCurve", "A", "B", "C", "A1", "B1", "C1", "newXRot", "newSinRot", "newCosRot", "CLONE", "key", "roundVal", "rf", "val", "round", "normalizeZ", "normalizeH", "normalizeV", "pathStartY", "skip", "x1Rel", "y1Rel", "LINE_COMMANDS", "xRel", "yRel", "x2Rel", "y2Rel", "dX", "dY", "atan", "xOffset", "yOffset", "arc", "y0", "phiMin", "min", "deltaPhi", "partCount", "ceil", "phiStart", "phiEnd", "deltaPhi_1", "tan", "_e", "_f", "_g", "transform", "xTemp", "yTemp", "_b", "_c", "_d", "clone", "toAbs", "qtToC", "normST", "fixX", "absX", "maxX", "minX", "fixY", "absY", "maxY", "minY", "DRAWING_COMMANDS", "T", "xDerivRoots_1", "derivRoot", "yDerivRoots_1", "xRotRad", "x90", "y90", "phiMin_1", "phiMax", "normalizeXiEta", "xi", "eta", "phi", "xDerivRoots_2", "map", "H", "yDerivRoots_2", "Infinity", "O", "l", "TransformableSVG", "ROUND", "TO_REL", "NORMALIZE_HVZ", "A_TO_C", "eps", "SANITIZE", "TRANSLATE", "SCALE", "ROTATE", "SKEW_X", "SKEW_Y", "X_AXIS_SYMMETRY", "Y_AXIS_SYMMETRY", "ANNOTATE_ARCS", "isWhiteSpace", "isDigit", "charCodeAt", "_super", "_this", "SVGPathDataParser", "parse", "curArgs", "canParseCommandOrComma", "SyntaxError", "finishCommand", "push", "isAArcFlag", "curCommandType", "curNumber", "isEndingDigit", "curNumberHasExp", "curNumberHasExpDigits", "curNumberHasDecimal", "Number", "COMMAND_ARG_COUNTS", "curCommandRelative", "value", "chunk", "parsedCommands_1", "getPrototypeOf", "cT", "content", "encode", "boundsTransform", "CALCULATE_BOUNDS", "transformFunction", "newCommands", "transformedCommand", "path", "parser", "finish", "obj", "e", "i", "y", "p", "r", "g", "b", "a", "BlurStack", "compressSpaces", "str", "replace", "trimLeft", "trimRight", "toNumbers", "matches", "match", "map", "parseFloat", "toMatrixValue", "numbers", "matrix", "allUppercase", "normalizeAttributeName", "name", "test", "toLowerCase", "parseExternalUrl", "url", "urlMatch", "exec", "normalizeColor", "color", "startsWith", "rgbParts", "normalizedColor", "num", "isFloat", "String", "Math", "round", "attributeRegex", "idRegex", "classRegex", "pseudoElementRegex", "pseudoClassWithBracketsRegex", "pseudoClassRegex", "elementRegex", "findSelectorMatch", "selector", "regex", "length", "getSelectorSpecificity", "specificity", "currentSelector", "delta", "join", "PSEUDO_ZERO", "vectorMagnitude", "v", "sqrt", "pow", "vectorsRatio", "u", "vectorsAngle", "acos", "CB1", "t", "CB2", "CB3", "CB4", "QB1", "QB2", "QB3", "Property", "empty", "document", "split", "separator", "getString", "trim", "value", "hasValue", "zeroIsValue", "isString", "regexp", "result", "isUrlDefinition", "isPixels", "asString", "endsWith", "setValue", "getValue", "def", "getNumber", "n", "getColor", "isNormalizedColor", "getDpi", "getRem", "rootEmSize", "getEm", "emSize", "getUnits", "getPixels", "axisOrIsFontSize", "processPercent", "axis", "isFontSize", "undefined", "viewPort", "screen", "min", "computeSize", "max", "getMilliseconds", "getRadians", "PI", "getDefinition", "definitions", "getFillStyleDefinition", "element", "opacity", "createGradient", "ctx", "createPattern", "getHrefAttribute", "patternTransform", "getAttribute", "getTextBaseline", "key", "textBaselineMapping", "addOpacity", "len", "commas", "i", "RGBColor", "ok", "alpha", "toRGBA", "ViewPort", "clear", "viewPorts", "setCurrent", "width", "height", "push", "removeCurrent", "pop", "getRoot", "root", "getDefault", "getCurrent", "current", "d", "DEFAULT_VIEWPORT_WIDTH", "DEFAULT_VIEWPORT_HEIGHT", "Point", "parse", "point", "defaultValue", "x", "y", "parseScale", "scale", "parsePath", "path", "points", "pathPoints", "angleTo", "atan2", "applyTransform", "transform", "xp", "yp", "Mouse", "isWorking", "working", "start", "onClick", "onMouseMove", "canvas", "onclick", "onmousemove", "stop", "hasEvents", "events", "runEvents", "eventElements", "style", "cursor", "forEach", "run", "parent", "checkPath", "isPointInPath", "checkBoundingBox", "boundingBox", "isPointInBox", "mapXY", "window", "offsetLeft", "offsetTop", "offsetParent", "scrollX", "scrollY", "event", "clientX", "clientY", "type", "eventTarget", "bind", "defaultWindow", "defaultFetch", "fetch", "Screen", "wait", "checker", "waits", "ready", "readyPromise", "Promise", "resolve", "isReady", "isReadyLock", "every", "_", "resolveReady", "setDefaults", "strokeStyle", "lineCap", "lineJoin", "miterLimit", "setViewBox", "aspectRatio", "desiredWidth", "desiredHeight", "minX", "minY", "refX", "refY", "clip", "clipX", "clipY", "cleanAspectRatio", "aspectRatioAlign", "aspectRatioMeetOrSlice", "align", "meetOrSlice", "scaleX", "scaleY", "scaleMin", "scaleMax", "finalDesiredWidth", "finalDesiredHeight", "refXProp", "refYProp", "hasRefs", "translate", "scaledClipX", "scaledClipY", "beginPath", "moveTo", "lineTo", "closePath", "isMeetMinY", "isSliceMaxY", "isMeetMinX", "isSliceMaxX", "enableRedraw", "ignoreMouse", "ignoreAnimation", "ignoreDimensions", "ignoreClear", "forceRedraw", "scaleWidth", "scaleHeight", "offsetX", "offsetY", "mouse", "frameDuration", "FRAMERATE", "render", "now", "Date", "then", "tick", "shouldUpdate", "intervalId", "requestAnimationFrame", "cancel", "animations", "reduce", "animation", "update", "isFirstRender", "widthStyle", "getStyle", "heightStyle", "cWidth", "clientWidth", "cHeight", "clientHeight", "viewBox", "xRatio", "yRatio", "isNaN", "transformStyle", "clearRect", "Error", "MAX_VIRTUAL_PIXELS", "DefaultDOMParser", "DOMParser", "Parser", "resource", "parseFromString", "load", "xml", "parser", "checkDocument", "err", "parserError", "getElementsByTagName", "textContent", "response", "text", "Translate", "apply", "unapply", "applyToPoint", "Rotate", "cx", "cy", "originX", "originY", "angle", "tx", "ty", "rotate", "rad", "cos", "sin", "transformOrigin", "Scale", "scaleSize", "Matrix", "a", "b", "c", "e", "f", "g", "h", "det", "Skew", "skew", "SkewX", "tan", "SkewY", "parseTransforms", "parseTransform", "Transform", "fromElement", "transformOriginXProperty", "transformOriginYProperty", "transforms", "data", "TransformType", "transformTypes", "skewX", "skewY", "Element", "createIfNotExists", "attr", "attributes", "href", "skipAncestors", "styles", "parentStyle", "save", "mask", "applyEffects", "filter", "setContext", "renderChildren", "clearContext", "restore", "clipPathStyleProp", "children", "child", "addChild", "childNode", "createElement", "ignoreChildTypes", "includes", "matchesSelector", "node", "styleClasses", "some", "styleClass", "addStylesFromStyleDefinition", "stylesSpecificity", "styleProp", "existingSpecificity", "removeStyles", "ignoreStyles", "toRestore", "restoreStyles", "isFirstChild", "indexOf", "captureTextNodes", "animationFrozen", "animationFrozenValue", "nodeType", "Array", "from", "attribute", "nodeName", "id", "childNodes", "textNode", "createTextNode", "getText", "UnknownElement", "wrapFontFamily", "fontFamily", "trimmed", "prepareFontFamily", "process", "prepareFontStyle", "fontStyle", "targetFontStyle", "prepareFontWeight", "fontWeight", "targetFontWeight", "Font", "font", "inherit", "fontVariant", "fontSize", "parts", "set", "part", "variants", "weights", "toString", "inheritFont", "BoundingBox", "x1", "y1", "x2", "y2", "addPoint", "addX", "addY", "addBoundingBox", "sumCubic", "p0", "p1", "p2", "p3", "bezierCurveAdd", "forX", "b2ac", "t1", "t2", "addBezierCurve", "p0x", "p0y", "p1x", "p1y", "p2x", "p2y", "p3x", "p3y", "addQuadraticCurve", "cp1x", "cp1y", "cp2x", "cp2y", "Number", "NaN", "RenderedElement", "calculateOpacity", "opacityStyle", "fromMeasure", "fillStyleProp", "fillOpacityStyleProp", "strokeStyleProp", "strokeOpacityProp", "fillStyle", "strokeWidthStyleProp", "newLineWidth", "lineWidth", "strokeLinecapStyleProp", "strokeLinejoinStyleProp", "strokeMiterlimitProp", "strokeDasharrayStyleProp", "strokeDashoffsetProp", "gaps", "setLineDash", "webkitLineDash", "mozDash", "offset", "lineDashOffset", "webkitLineDashOffset", "mozDashOffset", "modifiedEmSizeStack", "fontStyleProp", "fontStyleStyleProp", "fontVariantStyleProp", "fontWeightStyleProp", "fontSizeStyleProp", "fontFamilyStyleProp", "globalAlpha", "popEmSize", "TextElement", "textBaseline", "initializeCoordinates", "leafTexts", "textChunkStart", "POSITIVE_INFINITY", "maxX", "NEGATIVE_INFINITY", "getBoundingBox", "getTElementBoundingBox", "adjustChildCoordinatesRecursive", "childBoundingBox", "getChildBoundingBox", "getFontSize", "inheritFontSize", "measureText", "getGlyph", "char", "glyph", "isArabic", "prevChar", "nextChar", "arabicForm", "arabicGlyphs", "glyphs", "missingGlyph", "getTextFromNode", "parentNode", "index", "lastIndex", "renderTElementChildren", "renderChild", "renderText", "customFont", "unitsPerEm", "fontFace", "ctxFont", "isRTL", "reverse", "dx", "lw", "horizAdvX", "fillText", "strokeText", "applyAnchoring", "firstElement", "textAnchor", "shift", "adjustChildCoordinatesRecursiveCore", "textParent", "adjustChildCoordinates", "xAttr", "yAttr", "dxAttr", "dyAttr", "Boolean", "getInheritedAttribute", "measureCache", "measure", "measureTargetText", "targetText", "parentAttr", "TSpanElement", "TextNode", "PathParser", "SVGPathData", "reset", "command", "previousCommand", "control", "angles", "isEnd", "commands", "next", "getPoint", "xProp", "yProp", "makeAbsolute", "getAsControlPoint", "getAsCurrentPoint", "getReflectedControlPoint", "CURVE_TO", "SMOOTH_CURVE_TO", "QUAD_TO", "SMOOTH_QUAD_TO", "ox", "oy", "relative", "addMarker", "priorTo", "addMarkerAngle", "getMarkerPoints", "getMarkerAngles", "j", "PathElement", "pathParser", "MOVE_TO", "pathM", "LINE_TO", "pathL", "HORIZ_LINE_TO", "pathH", "VERT_LINE_TO", "pathV", "pathC", "pathS", "pathQ", "pathT", "ARC", "pathA", "CLOSE_PATH", "pathZ", "_ctx", "getMarkers", "markers", "fillRuleStyleProp", "fill", "setTransform", "stroke", "markersLastIndex", "markerStartStyleProp", "markerMidStyleProp", "markerEndStyleProp", "marker", "controlPoint", "currentPoint", "bezierCurveTo", "quadraticCurveTo", "rX", "rY", "xRot", "lArcFlag", "sweepFlag", "xAxisRotation", "currp", "l", "s", "cpp", "centp", "a1", "ad", "dir", "ah", "halfWay", "r", "sx", "sy", "arc", "SVGElement", "getComputedStyle", "getPropertyValue", "fontSizeProp", "refXAttr", "refYAttr", "viewBoxAttr", "resize", "preserveAspectRatio", "widthAttr", "heightAttr", "styleAttr", "originWidth", "originHeight", "preserveAspectRatioAttr", "RectElement", "rxAttr", "ryAttr", "rx", "ry", "KAPPA", "CircleElement", "EllipseElement", "LineElement", "getPoints", "x0", "y0", "PolylineElement", "PolygonElement", "PatternElement", "parentOpacityProp", "patternSvg", "patternCanvas", "createCanvas", "patternCtx", "getContext", "Reflect", "deleteProperty", "pattern", "MarkerElement", "orient", "markerUnits", "markerSvg", "overflow", "DefsElement", "GElement", "GradientElement", "getGradientUnits", "stopsContainer", "inheritStopContainer", "stops", "gradient", "getGradient", "addParentOpacity", "addColorStop", "rootView", "rect", "group", "attributesToInherit", "attributeToInherit", "colorProp", "LinearGradientElement", "isBoundingBoxUnits", "createLinearGradient", "RadialGradientElement", "fx", "fy", "fr", "createRadialGradient", "StopElement", "stopOpacity", "stopColor", "AnimateElement", "getProperty", "attributeType", "attributeName", "calcValue", "initialUnits", "progress", "to", "getProgress", "newValue", "prop", "initialValue", "duration", "maxDuration", "frozen", "removed", "updated", "begin", "typeAttr", "values", "p", "lb", "floor", "ub", "ceil", "valuesAttr", "AnimateColorElement", "colorFrom", "colorTo", "AnimateTransformElement", "transformFrom", "transformTo", "FontFaceElement", "ascent", "descent", "GlyphElement", "unicode", "MissingGlyphElement", "FontElement", "fontFamilyStyle", "arabicGlyph", "TRefElement", "firstChild", "AElement", "hasText", "open", "TextPathElement", "dataArray", "theta", "dTheta", "psi", "fs", "setTextData", "textDecoration", "glyphInfo", "rotation", "partialText", "getLetterSpacingAt", "idx", "letterSpacingCache", "findSegmentToFitChar", "anchor", "textFullWidth", "fullPathWidth", "spacesNumber", "inputOffset", "dy", "charI", "glyphWidth", "splineStep", "textHeight", "getEquidistantPointOnPath", "segment", "dyX", "dyY", "measuresCache", "has", "get", "chars", "thisSpacing", "parentSpacing", "letterSpacing", "textLen", "dxSum", "acc", "cur", "textWidth", "getPathLength", "startOffset", "nextOffset", "parsePathData", "pathLength", "pathCommands", "startX", "startY", "nextCommandType", "calcLength", "commandType", "getLineLength", "getPointOnCubicBezier", "getPointOnQuadraticBezier", "end", "inc", "abs", "getPointOnEllipticalArc", "getPointOnLine", "dist", "fromX", "fromY", "m", "rise", "pt", "ix", "iy", "pRise", "pRun", "getPointOnPath", "distance", "fullLen", "cumulativePathLength", "currentT", "pct", "p4x", "p4y", "cosPsi", "sinPsi", "buildEquidistantCache", "inputStep", "inputPrecision", "precision", "step", "equidistantCache", "targetDistance", "Map", "pathElement", "dataUriRegex", "ImageElement", "loadImage", "image", "createImage", "console", "error", "loaded", "loadSvg", "atob", "decodeURIComponent", "svg", "subDocument", "canvg", "forkString", "documentElement", "complete", "drawImage", "isSvg", "images", "SymbolElement", "SVGFontLoader", "svgDocument", "fonts", "fontNode", "StyleElement", "css", "cssDefs", "cssParts", "cssClasses", "cssProps", "cssClass", "props", "cssProp", "substr", "srcs", "src", "UseElement", "tempSvg", "oldParent", "elementTransform", "cachedElement", "imGet", "img", "_height", "rgba", "imSet", "val", "mi", "m1", "m2", "m3", "FeColorMatrixElement", "_x", "_y", "includeOpacity", "srcData", "getImageData", "nr", "ng", "nb", "na", "putImageData", "MaskElement", "ignoredStyles", "maskCanvas", "maskCtx", "tmpCanvas", "tmpCtx", "globalCompositeOperation", "fillRect", "noop", "ClipPathElement", "contextProto", "getPrototypeOf", "FilterElement", "px", "py", "efd", "extraFilterDistance", "tmpCanvasWidth", "tmpCanvasHeight", "FeDropShadowElement", "_width", "FeMorphologyElement", "FeCompositeElement", "FeGaussianBlurElement", "blurRadius", "body", "getUniqueId", "display", "appendChild", "canvasRGBA", "removeChild", "TitleElement", "DescElement", "elements", "anonymousCrossOrigin", "crossOrigin", "reject", "onload", "onerror", "_event", "_source", "_lineno", "_colno", "DEFAULT_EM_SIZE", "Document", "bindCreateImage", "source", "forceAnonymousCrossOrigin", "emSizeStack", "uniqueId", "isImagesLoaded", "isFontsLoaded", "createDocumentElement", "elementType", "ElementType", "elementTypes", "config", "Canvg", "options", "fromString", "fork", "baseOptions", "options", "e", "y", "compareImages", "i", "a", "b", "r"]
}
